---
title: Central Tendency
author: Brendan Knapp
date: '2018-11-12'
slug: index
categories:
  - data-science-from-scratch
  - statistics
  - tutorial
  - programming
tags:
  - data-science-from-scratch
  - statistics
  - programming
  - r
  - python
  - cpp
  - rcpp
image:
  caption: ''
  focal_point: 'Smart'
summary: 'Calculating measures of central tendency.'
output:
  blogdown::html_page:
    toc: true
    toc_depth: 3
citation_url: https://knapply.com/post/central-tendency/
editor_options: 
  chunk_output_type: console
---


<div id="TOC">
<ul>
<li><a href="#mean">Mean</a></li>
</ul>
</div>

<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
<p><link rel="stylesheet" href="https://cdn.rawgit.com/konpa/devicon/df6431e323547add1b4cf45992913f15286456d3/devicon.min.css"></p>
<div id="mean" class="section level1">
<h1>Mean</h1>
<p><div class="code-container">
<ul class="nav nav-pills"><li class='active'>
  <a data-toggle="pill" href="#r-mean">
    <font class="R-label">
      <p title="R">
        <i class="fab fa-r-project"> </i>
        <div class="text-center">
          <!-- <span class="icon-label" style="vertical-align:top; display:inline-block; text-align:center; font-size:20px;"> -->
          <font style="vertical-align:top; display:inline-block; text-align:center; font-size:20px;">
            R
          </font>
          <!-- </span> -->
        </div>
      </p>
    </font>
  </a>
</li><li>
  <a data-toggle="pill" href="#rcpp-mean">
    <font class="Rcpp-label">
      <p title="Rcpp">
        <i class="devicon-cplusplus-plain"> </i>
        <div class="text-center">
          <!-- <span class="icon-label" style="vertical-align:top; display:inline-block; text-align:center; font-size:20px;"> -->
          <font style="vertical-align:top; display:inline-block; text-align:center; font-size:20px;">
            Rcpp
          </font>
          <!-- </span> -->
        </div>
      </p>
    </font>
  </a>
</li><li>
  <a data-toggle="pill" href="#cpp-mean">
    <font class="Cpp-label">
      <p title="C++">
        <i class="devicon-cplusplus-plain"> </i>
        <div class="text-center">
          <!-- <span class="icon-label" style="vertical-align:top; display:inline-block; text-align:center; font-size:20px;"> -->
          <font style="vertical-align:top; display:inline-block; text-align:center; font-size:20px;">
            C++
          </font>
          <!-- </span> -->
        </div>
      </p>
    </font>
  </a>
</li><li>
  <a data-toggle="pill" href="#py-mean">
    <font class="Python-label">
      <p title="Python">
        <i class="fab fa-python"> </i>
        <div class="text-center">
          <!-- <span class="icon-label" style="vertical-align:top; display:inline-block; text-align:center; font-size:20px;"> -->
          <font style="vertical-align:top; display:inline-block; text-align:center; font-size:20px;">
            Python
          </font>
          <!-- </span> -->
        </div>
      </p>
    </font>
  </a>
</li><li>
  <a data-toggle="pill" href="#numpy-mean">
    <font class="NumPy-label">
      <p title="NumPy">
        <i class="fab fa-python"> </i>
        <div class="text-center">
          <!-- <span class="icon-label" style="vertical-align:top; display:inline-block; text-align:center; font-size:20px;"> -->
          <font style="vertical-align:top; display:inline-block; text-align:center; font-size:20px;">
            NumPy
          </font>
          <!-- </span> -->
        </div>
      </p>
    </font>
  </a>
</li></ul></p>
<p><div class="tab-content"><div id="r-mean" class="tab-pane fade in active"><p class="R-github-link" title="See code on GitHub">
  <a href="https://github.com/knapply/tutorial-gists/blob/master/sections/central-tendency/r-mean.R" class="fab fa-github"></a>
</p></p>
<pre class="r"><code>r_vector &lt;- c(126, 793, 999, 525, 851, 798, 120, 714, 852, 151,
              190, 41, 612, 826, 507, 105, 14, 237, 669, 7)

mean(r_vector)</code></pre>
<pre><code>#&gt; [1] 456.85</code></pre>
<center>
<strong> Missing Values? </strong>
</center>
<pre class="r"><code>r_vector_na &lt;- c(126, 793, 999, NA, 851, 798, 120, 714, 852, 151,
                 NA, 41, 612, 826, 507, NA, 14, 237, 669, 7)

mean(r_vector_na)</code></pre>
<pre><code>#&gt; [1] NA</code></pre>
<pre class="r"><code>mean(r_vector_na, na.rm = TRUE)</code></pre>
<pre><code>#&gt; [1] 489.2353</code></pre>
<p></div><div id="rcpp-mean" class="tab-pane fade"><p class="Rcpp-github-link" title="See code on GitHub">
  <a href="https://github.com/knapply/tutorial-gists/blob/master/sections/central-tendency/rcpp-mean.cpp" class="fab fa-github"></a>
</p></p>
<pre class="cpp cpp-cpp"><code>#include &lt;Rcpp.h&gt;
using namespace Rcpp;

// [[Rcpp::export]]
double cpp_mean(NumericVector x, bool na_rm = false) {
  if (na_rm) {
    return mean(na_omit(x));
  }
  return mean(x);
}</code></pre>
<pre class="r"><code>r_vector &lt;- c(126, 793, 999, 525, 851, 798, 120, 714, 852, 151,
              190, 41, 612, 826, 507, 105, 14, 237, 669, 7)

cpp_mean(r_vector)</code></pre>
<pre><code>#&gt; [1] 456.85</code></pre>
<center>
<strong> Missing Values? </strong>
</center>
<pre class="r"><code>r_vector_na &lt;- c(126, 793, 999, NA, 851, 798, 120, 714, 852, 151,
                 NA, 41, 612, 826, 507, NA, 14, 237, 669, 7)
cpp_mean(r_vector_na)</code></pre>
<pre><code>#&gt; [1] NA</code></pre>
<pre class="r"><code>cpp_mean(r_vector_na, na_rm = TRUE)</code></pre>
<pre><code>#&gt; [1] 489.2353</code></pre>
<p></div><div id="cpp-mean" class="tab-pane fade"><p class="Cpp-github-link" title="See code on GitHub">
  <a href="https://github.com/knapply/tutorial-gists/blob/master/sections/central-tendency/cpp-mean.cpp" class="fab fa-github"></a>
</p></p>
<pre class="cpp cpp-header"><code>#include &lt;algorithm&gt;  // std::find_if, std::remove_if
#include &lt;cmath&gt;      // std::isnan
#include &lt;numeric&gt;    // std::accumulate
#include &lt;vector&gt;     // std::vector

namespace knapply {
  auto mean(std::vector&lt;double&gt; x, bool ignore_nan = false) {
    auto has_nan = std::find_if(std::begin(x), std::end(x), 
                                [] (auto i) { return std::isnan(i); });
  
    if (!ignore_nan &amp;&amp; *has_nan) {
      return std::nan(&quot;&quot;);
    }
  
    if (ignore_nan &amp;&amp; *has_nan) {
      x.erase(std::remove_if(std::begin(x), std::end(x),
                             [] (double i) { return std::isnan(i); }),
              std::end(x));
    }
  
    return std::accumulate(std::begin(x), std::end(x), 0.0) / std::size(x);
  }
}  // namespace knapply</code></pre>
<p class="Cpp-github-link" title="See code on GitHub">
  <a href="https://github.com/knapply/tutorial-gists/blob/master/sections/central-tendency/cpp-mean-header.h" class="fab fa-github"></a>
</p>
<pre class="cpp cpp-cpp"><code>#include &quot;cpp-mean-header.h&quot;

#include &lt;iostream&gt;   // std::cout, std::endl

int main() {
  std::vector&lt;double&gt; cpp_vector {126, 793, 999, 525, 851, 798, 120, 714, 852, 151,
                                  190, 41, 612, 826, 507, 105, 14, 237, 669, 7};
  
  std::vector&lt;double&gt; cpp_vector_nan {126, 793, 999, std::nan(&quot;&quot;), 851, 798, 120, 714, 
                                      852, 151, std::nan(&quot;&quot;), 41, 612, 826, 507,
                                      std::nan(&quot;&quot;), 14, 237, 669, 7};
  
  auto res1 = knapply::mean(cpp_vector, false);
  std::cout &lt;&lt; &quot;mean without nan: &quot; &lt;&lt; res1 &lt;&lt; std::endl;

  auto res2 = knapply::mean(cpp_vector_nan, false);
  std::cout &lt;&lt; &quot;mean with nan and `nan_rm = false`: &quot; &lt;&lt; res2 &lt;&lt; std::endl;

  auto res3 = knapply::mean(cpp_vector_nan, true);
  std::cout &lt;&lt; &quot;mean with nan and `nan_rm = true`: &quot; &lt;&lt; res3 &lt;&lt; std::endl;
  
  return 0;
}</code></pre>
<pre class="bash"><code>cd tutorial-gists/sections/central-tendency/ &amp;&amp;
  g++ -std=c++17 cpp-mean.cpp -o cpp-mean &amp;&amp;
  ./cpp-mean</code></pre>
<pre><code>#&gt; mean without nan: 456.85
#&gt; mean with nan and `nan_rm = false`: nan
#&gt; mean with nan and `nan_rm = true`: 489.235</code></pre>
<p></div><div id="py-mean" class="tab-pane fade"><p class="Python-github-link" title="See code on GitHub">
  <a href="https://github.com/knapply/tutorial-gists/blob/master/sections/central-tendency/py-mean.py" class="fab fa-github"></a>
</p></p>
<pre class="python"><code>import statistics as stat

py_list = [126, 793, 999, 525, 851, 798, 120, 714, 852, 151,
           190, 41, 612, 826, 507, 105, 14, 237, 669, 7]
print(py_list)</code></pre>
<pre><code>#&gt; [126, 793, 999, 525, 851, 798, 120, 714, 852, 151, 190, 41, 612, 826, 507, 105, 14, 237, 669, 7]</code></pre>
<pre class="python"><code>res1 = stat.mean(py_list)
print(res1)</code></pre>
<pre><code>#&gt; 456.85</code></pre>
<center>
<strong> Missing Values? </strong>
</center>
<pre class="python"><code>py_list_none = [126, 793, 999, None, 851, 798, 120, 714, 852, 151,
                None, 41, 612, 826, 507, None, 14, 237, 669, 7]
print(py_list_none)</code></pre>
<pre><code>#&gt; [126, 793, 999, None, 851, 798, 120, 714, 852, 151, None, 41, 612, 826, 507, None, 14, 237, 669, 7]</code></pre>
<pre class="python"><code>res2 = stat.mean([x for x in py_list_none if x is not None])
print(res2)</code></pre>
<pre><code>#&gt; 489.2352941176471</code></pre>
<p></div><div id="numpy-mean" class="tab-pane fade"><p class="NumPy-github-link" title="See code on GitHub">
  <a href="https://github.com/knapply/tutorial-gists/blob/master/sections/central-tendency/numpy-mean.py" class="fab fa-github"></a>
</p></p>
<pre class="python"><code>import numpy as np

numpy_array = np.array([126, 793, 999, 525, 851, 798, 120, 714, 852, 151,
                        190, 41, 612, 826, 507, 105, 14, 237, 669, 7])

res1 = np.mean(numpy_array)
print(res1)</code></pre>
<pre><code>#&gt; 456.85</code></pre>
<center>
<strong> Missing Values? </strong>
</center>
<pre class="python"><code>numpy_array_nan = np.array([126, 793, 999, np.nan, 851, 798, 120, 714, 852, 151,
                            np.nan, 41, 612, 826, 507, np.nan, 14, 237, 669, 7])

res2 = np.nanmean(numpy_array_nan)
print(res2)</code></pre>
<pre><code>#&gt; 489.2352941176471</code></pre>
<p></div></div></p>
</div>
