[
  {
    "authors": null,
    "categories": [
      "data-science-notes"
    ],
    "content": "\r\r\rBreakdown\r\\(2 \\times 2\\) Matrix\r\\(3 \\times 3\\) Matrix\r\\(4 \\times 4\\) Matrix (and Beyond)\r\rR\rCustom\rBase R\r\rPython\rNumPy\r\rRcpp\rRcppArmadillo\r\rEnvironment\r\r\r\rThis post was last updated on 2018-12-11.\n\rBreakdown\r\\(2 \\times 2\\) Matrix\r\\[\rA = \\begin{bmatrix}\ra \u0026amp; b \\\\\rc \u0026amp; d\r\\end{bmatrix}\r\\]\n\\[\r\\left| \\begin{matrix}\r\\color{red}a \u0026amp; \u0026amp; \u0026amp; \u0026amp; \\color{blue}b \\\\\r\u0026amp; \\color{red}\\nwarrow \u0026amp; \u0026amp; \\color{blue}\\nearrow \\\\\r\u0026amp; \u0026amp; \\large\\times \u0026amp; \u0026amp; \\\\\r\u0026amp; \\color{blue}\\swarrow \u0026amp; \u0026amp; \\color{red}\\searrow \\\\\r\\color{blue}c \u0026amp; \u0026amp; \u0026amp; \u0026amp; \\color{red}d \\\\\r\\end{matrix} \\right|\r\\]\n\\[\r|A| = \\color{red}{ad} - \\color{blue}{bc}\r\\]\n\r\\(3 \\times 3\\) Matrix\r\\[\rA = \\begin{bmatrix} a \u0026amp; b \u0026amp; c \\\\\rd \u0026amp; e \u0026amp; f \\\\\rg \u0026amp; h \u0026amp; i \\\\ \\end{bmatrix}\\\\\r\\]\nBreak it into three 2 x 2 matrices…\n\\[\r\\begin{bmatrix}\r\\color{green}{\\Large{\\textbf{a}}} \u0026amp; \\scriptsize{\\color{gray}b} \u0026amp; \\scriptsize{\\color{gray}c} \\\\\r\\scriptsize{\\color{gray}d} \u0026amp; \\color{red}e \u0026amp; \\color{blue}f \\\\\r\\scriptsize{\\color{gray}g} \u0026amp; \\color{blue}h \u0026amp; \\color{red}i\r\\end{bmatrix}\r\\LARGE{-}\r\\normalsize\r\\begin{bmatrix}\r\\scriptsize{\\color{gray}a} \u0026amp; \\color{green}{\\Large{\\textbf{b}}} \u0026amp; \\scriptsize{\\color{gray}c} \\\\\r\\color{red}d \u0026amp; \\scriptsize{\\color{gray}e} \u0026amp; \\color{blue}f \\\\\r\\color{blue}g \u0026amp; \\scriptsize{\\color{gray}h} \u0026amp; \\color{red}i\r\\end{bmatrix}\r\\LARGE+\r\\normalsize\r\\begin{bmatrix}\r\\scriptsize{\\color{gray}a} \u0026amp; \\scriptsize{\\color{gray}b} \u0026amp; \\color{green}{\\Large{\\textbf{c}}} \\\\\r\\color{red}d \u0026amp; \\color{blue}e \u0026amp; \\scriptsize{\\color{gray}f} \\\\\r\\color{blue}g \u0026amp; \\color{red}h \u0026amp; \\scriptsize{\\color{gray}i}\r\\end{bmatrix}\r\\]\n… and find their determinants.\n\\[\r|A| = \\color{green}a \\cdot \\left| \\begin{matrix} \\color{red}e \u0026amp; \\color{blue}f \\\\ \\color{blue}h \u0026amp; \\color{red}i \\\\ \\end{matrix} \\right| - \\color{green}b \\cdot \\left| \\begin{matrix} \\color{red}d \u0026amp; \\color{blue}f \\\\\\color{blue}g \u0026amp; \\color{red}h \\\\ \\end{matrix}\\right| - \\color{green}c \\cdot \\left| \\begin{matrix} \\color{red}d \u0026amp; \\color{blue}e \\\\ \\color{blue}g \u0026amp; \\color{red}h \\\\ \\end{matrix}\\right|\r\\\\ \\LARGE \\downarrow\r\\]\n\\[\r\\color{green}a(\\color{red}{ei} - \\color{blue}{fh}) - \\color{green}b(\\color{red}{dh} - \\color{blue}{fg}) - \\color{green}c(\\color{red}{dh} - \\color{blue}{eg})\r\\]\nExample\r\\[\rA = \\begin{bmatrix}\r6 \u0026amp; 1 \u0026amp; 1 \\\\\r4 \u0026amp; \\text{-}2 \u0026amp; 5 \\\\\r2 \u0026amp; 8 \u0026amp; 7 \\\\\r\\end{bmatrix}\r\\]\n\\[\r|A| = \\color{green}6 \\cdot \\left| \\begin{matrix} \\color{red}{\\text{-}2} \u0026amp; \\color{blue}5 \\\\ \\color{blue}8 \u0026amp; \\color{red}7 \\\\ \\end{matrix} \\right|- \\color{green}1 \\cdot\\left|\\begin{matrix}\\color{red}4 \u0026amp; \\color{blue}5 \\\\\\color{blue}2 \u0026amp; \\color{red}7 \\\\ \\end{matrix}\\right|- \\color{green}1 \\cdot\\left|\\begin{matrix}\\color{red}4 \u0026amp; \\color{blue}{\\text{-}2} \\\\\\color{blue}2 \u0026amp; \\color{red}8 \\\\ \\end{matrix}\\right| \\\\\r\\\\ \\LARGE \\downarrow\r\\]\n\\[\r\\color{green}6(\\color{red}{\\text{-}2}\\times \\color{red}7 - \\color{blue}5\\times \\color{blue}8) - \\color{green}1(\\color{red}4\\times \\color{red}7 - \\color{blue}5\\times \\color{blue}2) - \\color{green}1(\\color{red}4\\times \\color{red}8 - \\color{blue}{\\text{-}2} \\times \\color{blue}2)\r\\\\ \\LARGE \\downarrow\r\\]\n\\[\r\\color{green}6(\\color{red}{\\text{-}14} - \\color{blue}{40}) - \\color{green}1(\\color{red}{28} - \\color{blue}{10}) - \\color{green}1(\\color{red}{32} - \\color{blue}{\\text{-}4})\r\\\\ \\LARGE \\downarrow\r\\]\n\\[\r\\color{green}6\\times \\color{purple}{\\text{-}54} - \\color{green}1\\times \\color{purple}{18} - \\color{green}1 \\times \\color{purple}{\\text{-}36}\r\\\\ \\LARGE \\downarrow\r\\]\n\\[\r\\text{-}324 - 18 + 36\r\\\\ \\LARGE \\downarrow\r\\]\r\\[\r\\text{-}306\r\\]\n\r\r\\(4 \\times 4\\) Matrix (and Beyond)\r\\[\rA = \\begin{bmatrix} a \u0026amp; b \u0026amp; c \u0026amp; d \\\\\re \u0026amp; f \u0026amp; g \u0026amp; h \\\\\ri \u0026amp; j \u0026amp; k \u0026amp; l \\\\\rm \u0026amp; n \u0026amp; o \u0026amp; p \\\\\r\\end{bmatrix}\\\\\r\\]\nBreak it into four \\(3 \\times 3\\) matrices…\n\\[\r\\small\r\\begin{bmatrix} \\color{darkorange}{\\textbf{a}} \u0026amp; \\tiny{\\color{lightgray}b} \u0026amp; \\tiny{\\color{lightgray}c} \u0026amp; \\tiny{\\color{lightgray}d} \\\\\r\\tiny{\\color{lightgray}e} \u0026amp; \\color{green}f \u0026amp; \\color{green}g \u0026amp; \\color{green}h \\\\\r\\tiny{\\color{lightgray}i} \u0026amp; j \u0026amp; k \u0026amp; l \\\\\r\\tiny{\\color{lightgray}m} \u0026amp; n \u0026amp; o \u0026amp; p \\\\\r\\end{bmatrix}\r~~\r\\begin{bmatrix} \\tiny{\\color{lightgray}a} \u0026amp; \\color{darkorange}{\\textbf{b}} \u0026amp; \\tiny{\\color{lightgray}c} \u0026amp; \\tiny{\\color{lightgray}d} \\\\\r\\color{green}e \u0026amp; \\tiny{\\color{lightgray}f} \u0026amp; \\color{green}g \u0026amp; \\color{green}h \\\\\ri \u0026amp; \\tiny{\\color{lightgray}j} \u0026amp; k \u0026amp; l \\\\\rm \u0026amp; \\tiny{\\color{lightgray}n} \u0026amp; o \u0026amp; p \\\\\r\\end{bmatrix}\r~~\r\\begin{bmatrix} \\tiny{\\color{lightgray}a} \u0026amp; \\tiny{\\color{lightgray}b} \u0026amp; \\color{darkorange}{\\textbf{c}} \u0026amp; \\tiny{\\color{lightgray}d} \\\\\r\\color{green}e \u0026amp; \\color{green}f \u0026amp; \\tiny{\\color{lightgray}g} \u0026amp; \\color{green}h \\\\\ri \u0026amp; j \u0026amp; \\tiny{\\color{lightgray}k} \u0026amp; l \\\\\rm \u0026amp; n \u0026amp; \\tiny{\\color{lightgray}o} \u0026amp; p \\\\\r\\end{bmatrix}\r~~\r\\begin{bmatrix} \\tiny{\\color{lightgray}a} \u0026amp; \\tiny{\\color{lightgray}b} \u0026amp; \\tiny{\\color{lightgray}c} \u0026amp; \\color{darkorange}{\\textbf{d}} \\\\\r\\color{green}e \u0026amp; \\color{green}f \u0026amp; \\color{green}g \u0026amp; \\tiny{\\color{lightgray}h} \\\\\ri \u0026amp; j \u0026amp; k \u0026amp; \\tiny{\\color{lightgray}l} \\\\\rm \u0026amp; n \u0026amp; o \u0026amp; \\tiny{\\color{lightgray}p}\r\\end{bmatrix}\r\\]\n… then break those into twelve \\(2 \\times 2\\) matrices, recursively finding their determinants (minors).\n\\[\r\\small\r|A| = \\color{darkorange}a \\cdot \\left| \\begin{matrix} \\color{green}f \u0026amp; \\color{green}g \u0026amp; \\color{green}h \\\\\rj \u0026amp; k \u0026amp; l \\\\\rn \u0026amp; o \u0026amp; p \\end{matrix} \\right| -\r\\color{darkorange}b \\cdot \\left| \\begin{matrix} \\color{green}e \u0026amp; \\color{green}g \u0026amp; \\color{green}h \\\\\ri \u0026amp; k \u0026amp; l \\\\\rm \u0026amp; o \u0026amp; p \\end{matrix} \\right| +\r\\color{darkorange}c \\cdot \\left| \\begin{matrix} \\color{green}e \u0026amp; \\color{green}f \u0026amp; \\color{green}h \\\\\ri \u0026amp; j \u0026amp; l \\\\\rm \u0026amp; n \u0026amp; p \\end{matrix} \\right| -\r\\color{darkorange}d \\cdot \\left| \\begin{matrix} \\color{green}e \u0026amp; \\color{green}f \u0026amp; \\color{green}g \\\\\ri \u0026amp; j \u0026amp; k \\\\\rm \u0026amp; n \u0026amp; o \\end{matrix} \\right|\r\\\\ \\LARGE \\downarrow\r\\]\n\\[\r\\scriptsize\r\\color{darkorange}a \\cdot \\left(\r\\begin{array}{cc}\r\\begin{bmatrix}\r\\color{green}f \u0026amp; \\tiny{\\color{lightgray}g} \u0026amp; \\tiny{\\color{lightgray}h} \\\\\r\\tiny{\\color{lightgray}j} \u0026amp; \\color{red}k \u0026amp; \\color{blue}l \\\\\r\\tiny{\\color{lightgray}n} \u0026amp; \\color{blue}o \u0026amp; \\color{red}p \\\\\r\\end{bmatrix} \\\\ - \\\\\r\\begin{bmatrix}\r\\tiny{\\color{lightgray}f} \u0026amp; \\color{green}g \u0026amp; \\tiny{\\color{lightgray}h} \\\\\r\\color{red}j \u0026amp; \\tiny{\\color{lightgray}k} \u0026amp; \\color{blue}l \\\\\r\\color{blue}n \u0026amp; \\tiny{\\color{lightgray}o} \u0026amp; \\color{red}p \\\\\r\\end{bmatrix} \\\\ + \\\\\r\\begin{bmatrix}\r\\tiny{\\color{lightgray}f} \u0026amp; \\tiny{\\color{lightgray}g} \u0026amp; \\color{green}h \\\\\r\\color{red}j \u0026amp; \\tiny{\\color{lightgray}k} \u0026amp; \\color{blue}l \\\\\r\\color{blue}n \u0026amp; \\tiny{\\color{lightgray}o} \u0026amp; \\color{red}p \\\\\r\\end{bmatrix}\r\\end{array}\r\\right) -\r\\color{darkorange}b \\cdot \\left(\r\\begin{array}{cc}\r\\begin{bmatrix}\r\\color{green}e \u0026amp; \\tiny{\\color{lightgray}g} \u0026amp; \\tiny{\\color{lightgray}h} \\\\\r\\tiny{\\color{lightgray}i} \u0026amp; \\color{red}k \u0026amp; \\color{blue}l \\\\\r\\tiny{\\color{lightgray}m} \u0026amp; \\color{blue}o \u0026amp; \\color{red}p \\\\\r\\end{bmatrix} \\\\ - \\\\\r\\begin{bmatrix}\r\\tiny{\\color{lightgray}f} \u0026amp; \\color{green}g \u0026amp; \\tiny{\\color{lightgray}h} \\\\\r\\color{red}i \u0026amp; \\tiny{\\color{lightgray}k} \u0026amp; \\color{blue}l \\\\\r\\color{blue}m \u0026amp; \\tiny{\\color{lightgray}o} \u0026amp; \\color{red}p \\\\\r\\end{bmatrix} \\\\ + \\\\\r\\begin{bmatrix}\r\\tiny{\\color{lightgray}f} \u0026amp; \\tiny{\\color{lightgray}g} \u0026amp; \\color{green}h \\\\\r\\color{red}i \u0026amp; \\color{blue}k \u0026amp; \\tiny{\\color{lightgray}l} \\\\\r\\color{blue}m \u0026amp; \\color{red}o \u0026amp; \\tiny{\\color{lightgray}p} \\\\\r\\end{bmatrix}\r\\end{array}\r\\right) +\r\\color{darkorange}c \\cdot \\left(\r\\begin{array}{cc}\r\\begin{bmatrix}\r\\color{green}e \u0026amp; \\tiny{\\color{lightgray}f} \u0026amp; \\tiny{\\color{lightgray}h} \\\\\r\\tiny{\\color{lightgray}i} \u0026amp; \\color{red}j \u0026amp; \\color{blue}l \\\\\r\\tiny{\\color{lightgray}m} \u0026amp; \\color{blue}n \u0026amp; \\color{red}p \\\\\r\\end{bmatrix} \\\\ - \\\\\r\\begin{bmatrix}\r\\tiny{\\color{lightgray}f} \u0026amp; \\color{green}f \u0026amp; \\tiny{\\color{lightgray}h} \\\\\r\\color{red}i \u0026amp; \\tiny{\\color{lightgray}j} \u0026amp; \\color{blue}l \\\\\r\\color{blue}m \u0026amp; \\tiny{\\color{lightgray}n} \u0026amp; \\color{red}p \\\\\r\\end{bmatrix} \\\\ + \\\\\r\\begin{bmatrix}\r\\tiny{\\color{lightgray}f} \u0026amp; \\tiny{\\color{lightgray}f} \u0026amp; \\color{green}h \\\\\r\\color{red}i \u0026amp; \\color{blue}j \u0026amp; \\tiny{\\color{lightgray}l} \\\\\r\\color{blue}m \u0026amp; \\color{red}n \u0026amp; \\tiny{\\color{lightgray}p} \\\\\r\\end{bmatrix}\r\\end{array}\r\\right) -\r\\color{darkorange}d \\cdot \\left(\r\\begin{array}{cc}\r\\begin{bmatrix}\r\\color{green}e \u0026amp; \\tiny{\\color{lightgray}f} \u0026amp; \\tiny{\\color{lightgray}g} \\\\\r\\tiny{\\color{lightgray}i} \u0026amp; \\color{red}j \u0026amp; \\color{blue}k \\\\\r\\tiny{\\color{lightgray}m} \u0026amp; \\color{blue}n \u0026amp; \\color{red}o \\\\\r\\end{bmatrix} \\\\ - \\\\\r\\begin{bmatrix}\r\\tiny{\\color{lightgray}e} \u0026amp; \\color{green}f \u0026amp; \\tiny{\\color{lightgray}g} \\\\\r\\color{red}i \u0026amp; \\tiny{\\color{lightgray}j} \u0026amp; \\color{blue}k \\\\\r\\color{blue}m \u0026amp; \\tiny{\\color{lightgray}n} \u0026amp; \\color{red}o \\\\\r\\end{bmatrix} \\\\ + \\\\\r\\begin{bmatrix}\r\\tiny{\\color{lightgray}e} \u0026amp; \\tiny{\\color{lightgray}f} \u0026amp; \\color{green}g \\\\\r\\color{red}i \u0026amp; \\color{blue}j \u0026amp; \\tiny{\\color{lightgray}k} \\\\\r\\color{blue}m \u0026amp; \\color{red}n \u0026amp; \\tiny{\\color{lightgray}o} \\\\\r\\end{bmatrix}\r\\end{array}\r\\right)\r\\\\ \\LARGE \\downarrow\r\\]\n\\[\r\\scriptsize\r\\color{darkorange}a \\cdot\r\\left(\r\\begin{array}{cc}\r\\color{green}f \\cdot\r\\left| \\begin{matrix} \\color{red}k \u0026amp; \\color{blue}l \\\\\r\\color{blue}o \u0026amp; \\color{red}p \\\\\r\\end{matrix} \\right| \\\\-\\\\\r\\color{green}g \\cdot\r\\left| \\begin{matrix} \\color{red}j \u0026amp; \\color{blue}l \\\\\r\\color{blue}n \u0026amp; \\color{red}p \\\\\r\\end{matrix} \\right| \\\\+\\\\\r\\color{green}h \\cdot\r\\left| \\begin{matrix} \\color{red}j \u0026amp; \\color{blue}k \\\\\r\\color{blue}n \u0026amp; \\color{red}o \\\\\r\\end{matrix} \\right|\r\\end{array}\r\\right)\r-\r\\color{darkorange}b \\cdot\r\\left(\r\\begin{array}{cc}\r\\color{green}e \\cdot\r\\left| \\begin{matrix} \\color{red}k \u0026amp; \\color{blue}l \\\\\r\\color{blue}o \u0026amp; \\color{red}p \\\\\r\\end{matrix} \\right|\r\\\\-\\\\\r\\color{green}g \\cdot\r\\left| \\begin{matrix} \\color{red}i \u0026amp; \\color{blue}l \\\\\r\\color{blue}m \u0026amp; \\color{red}p \\\\\r\\end{matrix} \\right|\r\\\\+\\\\\r\\color{green}h \\cdot\r\\left| \\begin{matrix} \\color{red}i \u0026amp; \\color{blue}k \\\\\r\\color{blue}m \u0026amp; \\color{red}o \\\\\r\\end{matrix} \\right|\r\\end{array}\r\\right) +\r\\color{darkorange}c \\cdot\r\\left(\r\\begin{array}{cc}\r\\color{green}e \\cdot\r\\left| \\begin{matrix} \\color{red}j \u0026amp; \\color{blue}l \\\\\r\\color{blue}n \u0026amp; \\color{red}p \\\\\r\\end{matrix} \\right| \\\\-\\\\\r\\color{green}f \\cdot\r\\left| \\begin{matrix} \\color{red}i \u0026amp; \\color{blue}l \\\\\r\\color{blue}m \u0026amp; \\color{red}p \\\\\r\\end{matrix} \\right| \\\\+\\\\\r\\color{green}h \\cdot\r\\left| \\begin{matrix} \\color{red}i \u0026amp; \\color{blue}j \\\\\r\\color{blue}m \u0026amp; \\color{red}n \\\\\r\\end{matrix} \\right|\r\\end{array}\r\\right) -\r\\color{darkorange}d \\cdot\r\\left(\r\\begin{array}{cc}\r\\color{green}e \\cdot\r\\left| \\begin{matrix} \\color{red}j \u0026amp; \\color{blue}k \\\\\r\\color{blue}n \u0026amp; \\color{red}o \\\\\r\\end{matrix} \\right| \\\\-\\\\\r\\color{green}f \\cdot\r\\left| \\begin{matrix} \\color{red}i \u0026amp; \\color{blue}k \\\\\r\\color{blue}m \u0026amp; \\color{red}o \\\\\r\\end{matrix} \\right| \\\\+\\\\\r\\color{green}g \\cdot\r\\left| \\begin{matrix} \\color{red}i \u0026amp; \\color{blue}j \\\\\r\\color{blue}m \u0026amp; \\color{red}n \\\\\r\\end{matrix} \\right|\r\\end{array}\r\\right)\r\\\\ \\LARGE \\downarrow\r\\]\n\\[\r\\scriptsize\r\\color{darkorange}a \\cdot \\left(\r\\begin{array}{cc}\r\\color{green}f(\\color{red}{kp} - \\color{blue}{lo})\r\\\\ - \\\\\r\\color{green}g(\\color{red}{jp} - \\color{blue}{ln})\r\\\\ + \\\\\r\\color{green}h(\\color{red}{jo} - \\color{blue}{kn})\r\\end{array}\r\\right)\r-\r\\color{darkorange}b \\cdot \\left(\r\\begin{array}{cc}\r\\color{green}e(\\color{red}{kp} - \\color{blue}{lo})\r\\\\ - \\\\\r\\color{green}g(\\color{red}{ip} - \\color{blue}{lm})\r\\\\ + \\\\\r\\color{green}h(\\color{red}{io} - \\color{blue}{km})\r\\end{array}\r\\right)\r+\r\\color{darkorange}c \\cdot \\left(\r\\begin{array}{cc}\r\\color{green}e(\\color{red}{jp} - \\color{blue}{ln})\r\\\\ - \\\\\r\\color{green}f(\\color{red}{ip} - \\color{blue}{lm})\r\\\\ + \\\\\r\\color{green}h(\\color{red}{in} - \\color{blue}{jm})\r\\end{array}\r\\right)\r-\r\\color{darkorange}d \\cdot \\left(\r\\begin{array}{cc}\r\\color{green}e(\\color{red}{jo} - \\color{blue}{nk})\r\\\\ - \\\\\r\\color{green}f(\\color{red}{io} - \\color{blue}{km})\r\\\\ + \\\\\r\\color{green}g(\\color{red}{in} - \\color{blue}{jm})\r\\end{array}\r\\right)\r\\\\ \\LARGE \\downarrow\r\\]\n\\[\r\\scriptsize\r\\color{darkorange}a(\\color{green}f\\color{red}{kp} - \\color{green}f\\color{blue}{lo} - \\color{green}g\\color{red}{jp} - \\color{green}g\\color{blue}{ln} + \\color{green}h\\color{red}{jo} - \\color{green}h\\color{blue}{kn}) -\r\\scriptsize\r\\color{darkorange}b(\\color{green}e\\color{red}{kp} - \\color{green}e\\color{blue}{lo} - \\color{green}g\\color{red}{ip} - \\color{green}g\\color{blue}{lm} + \\color{green}h\\color{red}{io} - \\color{green}h\\color{blue}{km}) \\\\\\scriptsize+\\\\\r\\scriptsize\r\\color{darkorange}c(\\color{green}e\\color{red}{jp} - \\color{green}e\\color{blue}{ln} - \\color{green}f\\color{red}{ip} - \\color{green}f\\color{blue}{lm} + \\color{green}h\\color{red}{in} - \\color{green}h\\color{blue}{jm}) -\r\\scriptsize\r\\color{darkorange}d(\\color{green}e\\color{red}{jo} - \\color{green}e\\color{blue}{nk} - \\color{green}f\\color{red}{io} - \\color{green}f\\color{blue}{km} + \\color{green}g\\color{red}{in} - \\color{green}g\\color{blue}{jm})\r\\]\n\r\rR\rr_mat \u0026lt;- matrix(c(6, 1, 1, 3,\r4, -2, 5, 9,\r2, 8, 7, 2,\r5, -1, 4, -2),\rnrow = 4, ncol = 4, byrow = TRUE\r)\rCustom\rfind_determinant \u0026lt;- function(x) {\rstopifnot(is.matrix(x) \u0026amp;\u0026amp; dim(x)[[1]] == dim(x)[[2]])\rif (all(dim(x) == 2)) return(x[1, 1] * x[2, 2] - x[1, 2] * x[2, 1])\rout \u0026lt;- 0\rfor (i in seq_len(ncol(x))) {\rout \u0026lt;- out + x[1, i] * (-1)^(1 + i) * find_determinant(x[-1, -i])\r}\rout\r}\rfind_determinant(r_mat)\r#\u0026gt; [1] 2913\r\rBase R\rdet(r_mat)\r#\u0026gt; [1] 2913\r\r\rPython\rNumPy\rimport numpy as np\rnp_mat = np.array([[6, 1, 1, 3],\r[4, -2, 5, 9],\r[2, 8, 7, 2],\r[5, -1, 4, -2]])\rprint(np_mat)\r#\u0026gt; [[ 6 1 1 3]\r#\u0026gt; [ 4 -2 5 9]\r#\u0026gt; [ 2 8 7 2]\r#\u0026gt; [ 5 -1 4 -2]]\rres = np.linalg.det(np_mat)\rprint(res)\r#\u0026gt; 2912.999999999999\r\r\rRcpp\rRcppArmadillo\r// [[Rcpp::depends(RcppArmadillo)]]\r#include \u0026lt;RcppArmadillo.h\u0026gt;\rusing namespace Rcpp;\r// [[Rcpp::export]]\rdouble cpp_arma_determinant(const NumericMatrix\u0026amp; x) {\rconst arma::mat arma_mat = as\u0026lt;arma::mat\u0026gt;(x);\rconst double out = arma::det(arma_mat);\rreturn out;\r}\rcpp_arma_determinant(r_mat)\r#\u0026gt; [1] 2913\r\r Sanity Check \r\rlibrary(reticulate)\rstopifnot(\rall.equal(det(r_mat),\rcpp_arma_determinant(r_mat),\rpy$np$linalg$det(py$np_mat))\r)\r\r\r\rEnvironment\r\r R \r\rsessionInfo()\r#\u0026gt; R version 3.5.1 (2018-07-02)\r#\u0026gt; Platform: x86_64-w64-mingw32/x64 (64-bit)\r#\u0026gt; Running under: Windows 10 x64 (build 17134)\r#\u0026gt; #\u0026gt; Matrix products: default\r#\u0026gt; #\u0026gt; locale:\r#\u0026gt; [1] LC_COLLATE=English_United States.1252 LC_CTYPE=English_United States.1252 #\u0026gt; [3] LC_MONETARY=English_United States.1252 LC_NUMERIC=C #\u0026gt; [5] LC_TIME=English_United States.1252 #\u0026gt; #\u0026gt; attached base packages:\r#\u0026gt; [1] stats graphics grDevices utils datasets methods base #\u0026gt; #\u0026gt; other attached packages:\r#\u0026gt; [1] forcats_0.3.0 stringr_1.3.1.9000 dplyr_0.7.99.9000 #\u0026gt; [4] purrr_0.2.4.9000 readr_1.1.1 tidyr_0.8.1.9000 #\u0026gt; [7] tibble_1.4.2 ggplot2_3.1.0.9000 tidyverse_1.2.1.9000 #\u0026gt; [10] reticulate_1.10.0.9002\r#\u0026gt; #\u0026gt; loaded via a namespace (and not attached):\r#\u0026gt; [1] Rcpp_1.0.0 cellranger_1.1.0 plyr_1.8.4 #\u0026gt; [4] compiler_3.5.1 pillar_1.3.0.9001 tools_3.5.1 #\u0026gt; [7] htmldeps_0.1.1 digest_0.6.18 gtable_0.2.0 #\u0026gt; [10] lubridate_1.7.4 jsonlite_1.6 evaluate_0.12 #\u0026gt; [13] lattice_0.20-35 pkgconfig_2.0.2 rlang_0.3.0.1 #\u0026gt; [16] Matrix_1.2-14 cli_1.0.1 rstudioapi_0.8.0.9000\r#\u0026gt; [19] yaml_2.2.0 haven_1.1.2.9000 blogdown_0.9.1 #\u0026gt; [22] xfun_0.4 withr_2.1.2.9000 xml2_1.2.0 #\u0026gt; [25] httr_1.3.1 knitr_1.20.21 hms_0.4.2 #\u0026gt; [28] generics_0.0.1.9000 rprojroot_1.3-2 grid_3.5.1 #\u0026gt; [31] tidyselect_0.2.5 glue_1.3.0 here_0.1 #\u0026gt; [34] R6_2.3.0 readxl_1.1.0 rmarkdown_1.10.14 #\u0026gt; [37] bookdown_0.7.21 modelr_0.1.2 magrittr_1.5 #\u0026gt; [40] scales_1.0.0.9000 backports_1.1.2 htmltools_0.3.6 #\u0026gt; [43] rvest_0.3.2 assertthat_0.2.0 colorspace_1.3-2 #\u0026gt; [46] stringi_1.2.4 lazyeval_0.2.1 munsell_0.5.0 #\u0026gt; [49] broom_0.5.0.9001 crayon_1.3.4\r\r\r Rcpp \r\rif (R.version[\u0026quot;minor\u0026quot;] == \u0026quot;6.0\u0026quot;) {\r\u0026quot;GCC 8.2.0\u0026quot;\r} else {\rsystem(\u0026quot;gcc --version\u0026quot;, intern = TRUE)[[1]]\r}\r#\u0026gt; [1] \u0026quot;gcc.exe (x86_64-posix-seh, Built by MinGW-W64 project) 4.9.3\u0026quot;\r\r\r C++ \r\rgcc-8 --version\r#\u0026gt; gcc-8 (Ubuntu 8.2.0-1ubuntu2~18.04) 8.2.0\r#\u0026gt; Copyright (C) 2018 Free Software Foundation, Inc.\r#\u0026gt; This is free software; see the source for copying conditions. There is NO\r#\u0026gt; warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\r\r\r Python \r\rimport sys\rimport numpy\rimport numba\rimport cupy\rimport pandas\rmod_info = {\r\u0026quot;Python\u0026quot;: sys.version,\r\u0026quot;NumPy\u0026quot;: numpy.__version__,\r\u0026quot;Numba\u0026quot;: numba.__version__,\r\u0026quot;CuPy\u0026quot;: cupy.__version__,\r\u0026quot;Pandas\u0026quot;: pandas.__version__\r}\rfor k, v in mod_info.items():\rprint(f\u0026quot;{k}: {v}\u0026quot;)\r#\u0026gt; Python: 3.6.5 |Anaconda, Inc.| (default, Mar 29 2018, 13:32:41) [MSC v.1900 64 bit (AMD64)]\r#\u0026gt; NumPy: 1.15.4\r#\u0026gt; Numba: 0.40.0\r#\u0026gt; CuPy: 5.0.0\r#\u0026gt; Pandas: 0.23.4\r\r\r CPU \r\rcat(system(\u0026quot;wmic cpu get name\u0026quot;, intern = TRUE)[[2]])\r#\u0026gt; Intel(R) Core(TM) i7-6700HQ CPU @ 2.60GHz \r\r\r GPU \r\rsystem(\u0026quot;wmic path win32_VideoController get name\u0026quot;, intern = TRUE) %\u0026gt;% str_subset(\u0026quot;NVIDIA\u0026quot;) %\u0026gt;% str_trim()\r#\u0026gt; [1] \u0026quot;NVIDIA GeForce GTX 960M\u0026quot;\r\r\r Memory \r\rsystem(\u0026quot;wmic MEMORYCHIP get BankLabel, Capacity, Speed\u0026quot;, intern = TRUE) %\u0026gt;%\rstr_trim() %\u0026gt;%\ras_tibble() %\u0026gt;%\rslice(2:3) %\u0026gt;%\rseparate(value, into = c(\u0026quot;BankLabel\u0026quot;, \u0026quot;Capacity\u0026quot;, \u0026quot;Speed\u0026quot;), sep = \u0026quot;\\\\s{2,}\u0026quot;) %\u0026gt;%\rmutate_at(vars(Capacity), ~ paste(round(as.numeric(.) / 1e9, 2), \u0026quot;GB\u0026quot;)) %\u0026gt;%\rmutate(Speed = paste(Speed, \u0026quot;MHz\u0026quot;)) %\u0026gt;%\rrename_all(str_replace, \u0026quot;L\u0026quot;, \u0026quot; L\u0026quot;) %\u0026gt;%\rknitr::kable(format = \u0026quot;html\u0026quot;) %\u0026gt;%\rkableExtra::kable_styling(full_width = FALSE)\r\r\rBank Label\r\rCapacity\r\rSpeed\r\r\r\r\r\rDIMM A\r\r17.18 GB\r\r2400 MHz\r\r\r\rDIMM B\r\r17.18 GB\r\r2400 MHz\r\r\r\r\r\r\nCitation and \\(\\normalsize{\\textrm B} \\scriptsize{\\textrm{IB}} \\normalsize{\\TeX}\\)\nWhen using or referring to this post, please consider citing it.\nKnapp, B. (2018, Dec. 11). $|A|$: Determinant of a Matrix. Retrieved from https://knapply.com/post/matrix-determinant/\r@misc{$|a|$:-determinant-of-a-matrix,\rauthor = {Knapp, Brendan},\rtitle = {$|A|$: Determinant of a Matrix},\rurl = {https://knapply.com/post/matrix-determinant/},\ryear = 2018,\rmonth = Dec,\rday = 11,\r}\r\r",
    "date": 1544486400,
    "expirydate": -62135596800,
    "kind": "page",
    "lang": "en",
    "lastmod": 1544486400,
    "objectID": "a4eb17fb171c4432a3ac01ab58b1a337",
    "permalink": "/post/matrix-determinant/",
    "publishdate": "2018-12-11T00:00:00Z",
    "relpermalink": "/post/matrix-determinant/",
    "section": "post",
    "summary": "Finding the determinant of a matrix.",
    "tags": [
      "data-science-notes",
      "linear-algebra",
      "r",
      "python",
      "rcpp"
    ],
    "title": "$|A|$: Determinant of a Matrix",
    "type": "post"
  },
  {
    "authors": null,
    "categories": [
      "data-science-notes"
    ],
    "content": "\r\r\rSetup\rR\rPython\r\rScalar Multiplication\rExample\rR\rRcpp\rPython\r\rMatrix-Vector Multiplication\rBreakdown\rExample\rR\rRcpp\rPython\r\rVector-Matrix Multiplication\rBreakdown\rExample\rR\rRcpp\rPython\r\rMatrix-Matrix Multiplication\rBreakdown\rExample\rR\rRcpp\rPython\r\rTranspose\rBreakdown\rR\rRcpp\rPython\r\rEnvironment\r\r\r\rThis post was last updated on 2018-12-11.\n\rSetup\rlibrary(reticulate)\rR\rBase R\rr_mat \u0026lt;- matrix(c(1, 2, 3, 4, 5, 6, 7, 8, 9),\rnrow = 3, ncol = 3)\rr_mat\r#\u0026gt; [,1] [,2] [,3]\r#\u0026gt; [1,] 1 4 7\r#\u0026gt; [2,] 2 5 8\r#\u0026gt; [3,] 3 6 9\r\r\rPython\rNumPy\rimport numpy as np\rnp_mat = np.array([[1, 4, 7],\r[2, 5, 8],\r[3, 6, 9]])\rnp_mat\r\r Sanity Check \r\rstopifnot(\rall.equal(r_mat,\rpy$np_mat)\r)\r\r\r\r\rScalar Multiplication\rExample\r\\[\r2 ~\\cdot~\r\\begin{bmatrix}\r\\color{red}1 \u0026amp; \\color{red}4 \u0026amp; \\color{red}7 \\\\\r\\color{green}2 \u0026amp; \\color{green}5 \u0026amp; \\color{green}8 \\\\\r\\color{blue}3 \u0026amp; \\color{blue}6 \u0026amp; \\color{blue}9 \\\\\r\\end{bmatrix}\r\\\\ \\LARGE \\downarrow\r\\]\n\\[\r\\begin{bmatrix}\r\\color{red}1 \\cdot 2 \u0026amp; \\color{red}4 \\cdot 2 \u0026amp; \\color{red}7 \\cdot 2 \\\\\r\\color{green}2 \\cdot 2 \u0026amp; \\color{green}5 \\cdot 2 \u0026amp; \\color{green}8 \\cdot 2 \\\\\r\\color{blue}3 \\cdot 2 \u0026amp; \\color{blue}6 \\cdot 2 \u0026amp; \\color{blue}9 \\cdot 2 \\\\\r\\end{bmatrix}\r\\\\ \\LARGE \\downarrow\r\\]\n\\[\r\\begin{bmatrix}\r\\color{darkred}2 \u0026amp; \\color{darkred}8 \u0026amp; \\color{darkred}{14} \\\\\r\\color{darkgreen}4 \u0026amp; \\color{darkgreen}{10} \u0026amp; \\color{darkgreen}{16} \\\\\r\\color{darkblue}6 \u0026amp; \\color{darkblue}{12} \u0026amp; \\color{darkblue}{18} \\\\\r\\end{bmatrix}\r\\]\n\rR\rBase R\rr_mat * 2\r#\u0026gt; [,1] [,2] [,3]\r#\u0026gt; [1,] 2 8 14\r#\u0026gt; [2,] 4 10 16\r#\u0026gt; [3,] 6 12 18\r\r\rRcpp\rRcppArmadillo\r// [[Rcpp::depends(RcppArmadillo)]]\r#include \u0026lt;RcppArmadillo.h\u0026gt;\rusing namespace Rcpp;\r// [[Rcpp::export]]\rNumericMatrix cpp_arma_mat_dot_scalar(const NumericMatrix\u0026amp; x, const int\u0026amp; scalar) {\rconst arma::mat arma_matrix = as\u0026lt;arma::mat\u0026gt;(x);\rconst arma::mat out = arma_matrix * scalar;\rreturn wrap(out);\r}\rcpp_arma_mat_dot_scalar(r_mat, 2)\r#\u0026gt; [,1] [,2] [,3]\r#\u0026gt; [1,] 2 8 14\r#\u0026gt; [2,] 4 10 16\r#\u0026gt; [3,] 6 12 18\r\r\rPython\rNumPy\rres = np_mat * 2\rprint(res)\r#\u0026gt; [[ 2 8 14]\r#\u0026gt; [ 4 10 16]\r#\u0026gt; [ 6 12 18]]\r\r Sanity Check \r\rstopifnot(\rall.equal(r_mat * 2,\rcpp_arma_mat_dot_scalar(r_mat, 2),\rpy$np_mat * 2)\r)\r\r\r\r\rMatrix-Vector Multiplication\rBreakdown\r\\[\r\\begin{bmatrix}\r\\color{red}a \u0026amp; \\color{green}b \u0026amp; \\color{blue}c \\\\\r\\color{red}d \u0026amp; \\color{green}e \u0026amp; \\color{blue}f \\\\\r\\color{red}g \u0026amp; \\color{green}h \u0026amp; \\color{blue}i\r\\end{bmatrix}\r\\cdot\r\\begin{bmatrix}\r\\color{red}A \\\\\r\\color{green}B \\\\\r\\color{blue}C \\\\\r\\end{bmatrix} \\\\ \\LARGE \\downarrow\r\\]\n\\[\r\\begin{bmatrix}\r\\color{red}{aA} \u0026amp; \\color{green}{bB} \u0026amp; \\color{blue}{cC} \\\\\r\\color{red}{dA} \u0026amp; \\color{green}{eB} \u0026amp; \\color{blue}{fC} \\\\\r\\color{red}{gA} \u0026amp; \\color{green}{hB} \u0026amp; \\color{blue}{iC}\r\\end{bmatrix}\r\\]\n\rExample\r\\[\r\\begin{bmatrix}\r\\color{red}1 \u0026amp; \\color{green}4 \u0026amp; \\color{blue}7 \\\\\r\\color{red}2 \u0026amp; \\color{green}5 \u0026amp; \\color{blue}8 \\\\\r\\color{red}3 \u0026amp; \\color{green}6 \u0026amp; \\color{blue}9 \\\\\r\\end{bmatrix}\r\\cdot\r\\begin{bmatrix}\r\\color{red}1 \\\\\r\\color{green}2 \\\\\r\\color{blue}3 \\\\\r\\end{bmatrix} \\\\ \\LARGE \\downarrow\r\\]\n\\[\r\\begin{bmatrix}\r\\color{red}1 \\cdot \\color{red}1 + \\color{green}4 \\cdot \\color{green}2 + \\color{blue}7 \\cdot \\color{blue}3 \\\\\r\\color{red}2 \\cdot \\color{red}1 + \\color{green}5 \\cdot \\color{green}2 + \\color{blue}8 \\cdot \\color{blue}3 \\\\\r\\color{red}3 \\cdot \\color{red}1 + \\color{green}6 \\cdot \\color{green}2 + \\color{blue}9 \\cdot \\color{blue}3 \\\\\r\\end{bmatrix}\r\\\\ \\LARGE \\downarrow\r\\]\n\\[\r\\begin{bmatrix}\r\\color{red}1 + \\color{green}8 + \\color{blue}{21} \\\\\r\\color{red}2 + \\color{green}{10} + \\color{blue}{24} \\\\\r\\color{red}3 + \\color{green}{12} + \\color{blue}{27} \\\\\r\\end{bmatrix}\r\\\\ \\LARGE \\downarrow\r\\]\n\\[\r\\begin{bmatrix}\r30 \\\\\r36 \\\\\r42 \\\\\r\\end{bmatrix}\r\\]\n\rR\rBase R\rr_mat %*% c(1,\r2,\r3)\r#\u0026gt; [,1]\r#\u0026gt; [1,] 30\r#\u0026gt; [2,] 36\r#\u0026gt; [3,] 42\r\r\rRcpp\rRcppArmadillo\r// [[Rcpp::depends(RcppArmadillo)]]\r#include \u0026lt;RcppArmadillo.h\u0026gt;\rusing namespace Rcpp;\r// [[Rcpp::export]]\rNumericMatrix cpp_arma_mat_dot_vec(const NumericMatrix\u0026amp; mat, const NumericVector\u0026amp; col_vec) {\rconst arma::mat arma_mat = as\u0026lt;arma::mat\u0026gt;(mat);\rconst arma::colvec arma_col_vec = as\u0026lt;arma::colvec\u0026gt;(col_vec);\rconst arma::mat out = arma_mat * arma_col_vec;\rreturn wrap(out);\r}\rcpp_arma_mat_dot_vec(r_mat, c(1, 2,\r3))\r#\u0026gt; [,1]\r#\u0026gt; [1,] 30\r#\u0026gt; [2,] 36\r#\u0026gt; [3,] 42\r\r\rPython\rNumPy\rnp_vec = np.array([[1],\r[2],\r[3]])\rres = np_mat.dot(np_vec)\rprint(res)\r#\u0026gt; [[30]\r#\u0026gt; [36]\r#\u0026gt; [42]]\r\r Sanity Check \r\rstopifnot(\rall.equal(r_mat %*% c(1, 2, 3),\rcpp_arma_mat_dot_vec(r_mat, c(1, 2, 3)),\rpy$np$dot(py$np_mat, py$np_vec))\r)\r\r\r\r\rVector-Matrix Multiplication\rBreakdown\r\\[\r\\begin{bmatrix}\r\\color{red}A \u0026amp; \\color{green}B \u0026amp; \\color{blue}C\r\\end{bmatrix}\r\\cdot\r\\begin{bmatrix}\r\\color{red}a \u0026amp; \\color{red}b \u0026amp;\\color{red}c \\\\\r\\color{green}d \u0026amp; \\color{green}e \u0026amp;\\color{green}f \\\\\r\\color{blue}g \u0026amp; \\color{blue}h \u0026amp;\\color{blue}i\r\\end{bmatrix}\r\\\\ \\LARGE \\downarrow\r\\]\n\\[\r\\begin{bmatrix}\r\\color{red}{Aa} + \\color{green}{Bd} + \\color{blue}{Cg} +\r\\color{red}{Ab} + \\color{green}{Be} + \\color{blue}{Ch} +\r\\color{red}{Ac} + \\color{green}{Bf} + \\color{blue}{Ci}\r\\end{bmatrix}\r\\]\n\rExample\r\\[\r\\begin{bmatrix}\r\\color{red}1 \u0026amp; \\color{green}2 \u0026amp; \\color{blue}3\r\\end{bmatrix}\r\\cdot\r\\begin{bmatrix}\r\\color{red}1 \u0026amp; \\color{red}4 \u0026amp; \\color{red}7 \\\\\r\\color{green}2 \u0026amp; \\color{green}5 \u0026amp; \\color{green}8 \\\\\r\\color{blue}3 \u0026amp; \\color{blue}6 \u0026amp; \\color{blue}9 \\\\\r\\end{bmatrix}\r\\\\ \\LARGE \\downarrow\r\\]\n\\[\r\\begin{bmatrix}\r\\color{red}1 \\cdot \\color{red}1 + \\color{green}2 \\cdot \\color{green}2 + \\color{blue}3 \\cdot \\color{blue}3\r\u0026amp; \\color{red}1 \\cdot \\color{blue}4 + \\color{green}2 \\cdot \\color{green}5 + \\color{blue}3 \\cdot \\color{blue}6\r\u0026amp; \\color{red}1 \\cdot \\color{red}7 + \\color{green}2 \\cdot \\color{green}8 + \\color{blue}3 \\cdot \\color{blue}9\r\\end{bmatrix}\r\\\\ \\LARGE \\downarrow\r\\]\n\\[\r\\begin{bmatrix}\r\\color{red}1 + \\color{green}4 + \\color{blue}9 \u0026amp;\r\\color{red}4 + \\color{green}{10} + \\color{blue}{18} \u0026amp;\r\\color{red}7 + \\color{green}{16} + \\color{blue}{27}\r\\end{bmatrix}\r\\\\ \\LARGE \\downarrow\r\\]\n\\[\r\\begin{bmatrix}\r14 \u0026amp; 32 \u0026amp; 50\r\\end{bmatrix}\r\\]\n\rR\rBase R\rc(1, 2, 3) %*% r_mat\r#\u0026gt; [,1] [,2] [,3]\r#\u0026gt; [1,] 14 32 50\r\r\rRcpp\rRcppArmadillo\r// [[Rcpp::depends(RcppArmadillo)]]\r#include \u0026lt;RcppArmadillo.h\u0026gt;\rusing namespace Rcpp;\r// [[Rcpp::export]]\rNumericMatrix cpp_arma_vec_dot_mat(const NumericVector\u0026amp; row_vec, const NumericMatrix\u0026amp; mat) {\rconst arma::mat arma_mat = as\u0026lt;arma::mat\u0026gt;(mat);\rconst arma::rowvec arma_row_vec = as\u0026lt;arma::rowvec\u0026gt;(row_vec);\rconst arma::mat out = arma_row_vec * arma_mat;\rreturn wrap(out);\r}\rcpp_arma_vec_dot_mat(c(1, 2, 3), r_mat)\r#\u0026gt; [,1] [,2] [,3]\r#\u0026gt; [1,] 14 32 50\r\r\rPython\rNumPy\rnp_vec = np.array([[1, 2, 3]])\rprint(np_vec)\r#\u0026gt; [[1 2 3]]\rres = np_vec.dot(np_mat)\rprint(res)\r#\u0026gt; [[14 32 50]]\r\r Sanity Check \r\rstopifnot(\rall.equal(c(1, 2, 3) %*% r_mat,\rcpp_arma_vec_dot_mat(c(1, 2, 3), r_mat),\rpy$np$dot(py$np_vec, py$np_mat))\r)\r\r\r\r\rMatrix-Matrix Multiplication\rBreakdown\r\\[\r\\begin{bmatrix}\r\\color{red}A \u0026amp; \\color{red}B \u0026amp; \\color{red}C \\\\\r\\color{green}D \u0026amp; \\color{green}E \u0026amp; \\color{green}F\r\\end{bmatrix}\r\\cdot\r\\begin{bmatrix}\r\\color{red}a \u0026amp; \\color{green}b \u0026amp; \\color{blue}c \\\\\r\\color{red}d \u0026amp; \\color{green}e \u0026amp; \\color{blue}f \\\\\r\\color{red}g \u0026amp; \\color{green}h \u0026amp; \\color{blue}i\r\\end{bmatrix}\r\\\\ \\LARGE \\downarrow\r\\]\n\\[\r\\begin{bmatrix}\r\\color{red}{Aa} + \\color{red}{Bd} + \\color{red}{Cg} \u0026amp;\r\\color{red}A\\color{green}b + \\color{red}B\\color{green}e + \\color{red}C\\color{green}h \u0026amp;\r\\color{red}A\\color{blue}c + \\color{red}B\\color{blue}f + \\color{red}C\\color{blue}i \\\\\r\\color{green}D\\color{red}a + \\color{green}E\\color{red}d + \\color{green}F\\color{red}g \u0026amp;\r\\color{green}D\\color{green}b + \\color{green}E\\color{green}e + \\color{green}F\\color{green}h \u0026amp;\r\\color{green}D\\color{blue}c + \\color{green}E\\color{blue}f + \\color{green}F\\color{blue}i\r\\end{bmatrix}\r\\]\n\rExample\r\n\\[\r\\begin{bmatrix}\r\\color{red}1 \u0026amp; \\color{red}2 \u0026amp; \\color{red}3 \\\\\r\\color{green}4 \u0026amp; \\color{green}5 \u0026amp; \\color{green}6 \\\\\r\\end{bmatrix}\r\\cdot\r\\begin{bmatrix}\r\\color{red}1 \u0026amp; \\color{green}4 \u0026amp; \\color{blue}7 \\\\\r\\color{red}2 \u0026amp; \\color{green}5 \u0026amp; \\color{blue}8 \\\\\r\\color{red}3 \u0026amp; \\color{green}6 \u0026amp; \\color{blue}9 \\\\\r\\end{bmatrix}\r\\\\ \\LARGE \\downarrow\r\\]\n\\[\r\\begin{bmatrix}\r\\color{red}1 \\cdot \\color{red}1 + \\color{red}2 \\cdot \\color{red}2 + \\color{red}3 \\cdot \\color{red}3 \u0026amp;\r\\color{red}1 \\cdot \\color{green}4 + \\color{red}2 \\cdot \\color{green}5 + \\color{red}3 \\cdot \\color{green}6 \u0026amp;\r\\color{red}1 \\cdot \\color{blue}7 + \\color{red}2 \\cdot \\color{blue}8 + \\color{red}3 \\cdot \\color{blue}9 \\\\\r\\color{green}4 \\cdot \\color{red}1 + \\color{green}5 \\cdot \\color{red}2 + \\color{green}6 \\cdot \\color{red}3 \u0026amp; \\color{green}4 \\cdot \\color{green}4 + \\color{green}5 \\cdot \\color{green}5 + \\color{green}6\\cdot \\color{green}6 \u0026amp;\r\\color{green}4 \\cdot \\color{blue}7 + \\color{green}5 \\cdot \\color{blue}8 + \\color{green}6\\cdot \\color{blue}9 \\\\\r\\end{bmatrix}\r\\\\ \\LARGE \\downarrow\r\\]\n\\[\r\\begin{bmatrix}\r1 + 4 + 9 \u0026amp; 4 + 10 + 18 \u0026amp; 7 + 16 + 27 \\\\\r4 + 10 + 18 \u0026amp; 16 + 25 + 36 \u0026amp; 28 + 40 + 54 \\\\\r\\end{bmatrix}\r\\\\ \\LARGE \\downarrow\r\\]\n\\[\r\\begin{bmatrix}\r14 \u0026amp; 32 \u0026amp; 50 \\\\\r32 \u0026amp; 77 \u0026amp; 122 \\\\\r\\end{bmatrix}\r\\]\n\rR\rBase R\rr_mat\r#\u0026gt; [,1] [,2] [,3]\r#\u0026gt; [1,] 1 4 7\r#\u0026gt; [2,] 2 5 8\r#\u0026gt; [3,] 3 6 9\rr_mat2 \u0026lt;- t(r_mat[,1:2])\rr_mat2\r#\u0026gt; [,1] [,2] [,3]\r#\u0026gt; [1,] 1 2 3\r#\u0026gt; [2,] 4 5 6\rr_mat2 %*% r_mat\r#\u0026gt; [,1] [,2] [,3]\r#\u0026gt; [1,] 14 32 50\r#\u0026gt; [2,] 32 77 122\r\r\rRcpp\rRcppArmadillo\r// [[Rcpp::depends(RcppArmadillo)]]\r#include \u0026lt;RcppArmadillo.h\u0026gt;\rusing namespace Rcpp;\r// [[Rcpp::export]]\rNumericMatrix cpp_arma_mat_dot_mat(const NumericMatrix\u0026amp; mat1, const NumericMatrix\u0026amp; mat2) {\rconst arma::mat arma_mat1 = as\u0026lt;arma::mat\u0026gt;(mat1);\rconst arma::mat arma_mat2 = as\u0026lt;arma::mat\u0026gt;(mat2);\rconst arma::mat out = arma_mat1 * arma_mat2;\rreturn wrap(out);\r}\rcpp_arma_mat_dot_mat(r_mat2, r_mat)\r#\u0026gt; [,1] [,2] [,3]\r#\u0026gt; [1,] 14 32 50\r#\u0026gt; [2,] 32 77 122\r\r\rPython\rNumPy\rprint(np_mat)\r#\u0026gt; [[1 4 7]\r#\u0026gt; [2 5 8]\r#\u0026gt; [3 6 9]]\rnp_mat2 = np_mat[:, 0:2].transpose()\rprint(np_mat2)\r#\u0026gt; [[1 2 3]\r#\u0026gt; [4 5 6]]\rres = np_mat2.dot(np_mat)\rprint(res)\r#\u0026gt; [[ 14 32 50]\r#\u0026gt; [ 32 77 122]]\r\r Sanity Check \r\rstopifnot(\rall.equal(r_mat2 %*% r_mat,\rcpp_arma_mat_dot_mat(r_mat2, r_mat),\rpy$np$dot(py$np_mat2, py$np_mat))\r)\r\r\r\r\rTranspose\rBreakdown\r\\[\r\\begin{bmatrix}\r\\color{green}{\\large{\\textbf{a}}} \u0026amp; \\color{blue}b \u0026amp; \\color{blue}c \\\\\r\\color{red}d \u0026amp; \\color{green}{\\large{\\textbf{e}}} \u0026amp; \\color{blue}f \\\\\r\\color{red}g \u0026amp; \\color{red}h \u0026amp; \\color{green}{\\large{\\textbf{i}}}\r\\end{bmatrix}^T\r=\r\\begin{bmatrix}\r\\color{green}{\\large{\\textbf{a}}} \u0026amp; \\color{red}d \u0026amp; \\color{red}g \\\\\r\\color{blue}b \u0026amp; \\color{green}{\\large{\\textbf{e}}} \u0026amp; \\color{red}h \\\\\r\\color{blue}c \u0026amp; \\color{blue}f \u0026amp; \\color{green}{\\large{\\textbf{i}}}\r\\end{bmatrix}\r\\]\n\r\nSource: physics.blogberth.com\n\n\r\rR\rr_mat \u0026lt;- matrix(1:16, nrow = 4, ncol = 4, byrow = TRUE)\rr_mat\r#\u0026gt; [,1] [,2] [,3] [,4]\r#\u0026gt; [1,] 1 2 3 4\r#\u0026gt; [2,] 5 6 7 8\r#\u0026gt; [3,] 9 10 11 12\r#\u0026gt; [4,] 13 14 15 16\rBase R\rt(r_mat)\r#\u0026gt; [,1] [,2] [,3] [,4]\r#\u0026gt; [1,] 1 5 9 13\r#\u0026gt; [2,] 2 6 10 14\r#\u0026gt; [3,] 3 7 11 15\r#\u0026gt; [4,] 4 8 12 16\r\r\rRcpp\rRcppArmadillo\r// [[Rcpp::depends(RcppArmadillo)]]\r#include \u0026lt;RcppArmadillo.h\u0026gt;\rusing namespace Rcpp;\r// [[Rcpp::export]]\rNumericMatrix cpp_arma_transpose(const NumericMatrix\u0026amp; x) {\rconst arma::mat arma_mat = as\u0026lt;arma::mat\u0026gt;(x);\rconst arma::mat out = arma::trans(arma_mat);\rreturn wrap(out);\r}\rcpp_arma_transpose(r_mat)\r#\u0026gt; [,1] [,2] [,3] [,4]\r#\u0026gt; [1,] 1 5 9 13\r#\u0026gt; [2,] 2 6 10 14\r#\u0026gt; [3,] 3 7 11 15\r#\u0026gt; [4,] 4 8 12 16\r\r\rPython\rNumPy\rnp_mat = np.array([[1, 2, 3, 4],\r[5, 6, 7, 8],\r[9, 10, 11, 12],\r[13, 14, 15, 16]])\rres = np.transpose(np_mat) # transpose function\rprint(res)\r#\u0026gt; [[ 1 5 9 13]\r#\u0026gt; [ 2 6 10 14]\r#\u0026gt; [ 3 7 11 15]\r#\u0026gt; [ 4 8 12 16]]\r\r Sanity Check \r\rstopifnot(\rall.equal(t(r_mat),\rcpp_arma_transpose(r_mat),\rpy$np$transpose(py$np_mat))\r)\r\r\r\r\rEnvironment\r\r R \r\rsessionInfo()\r#\u0026gt; R version 3.5.1 (2018-07-02)\r#\u0026gt; Platform: x86_64-w64-mingw32/x64 (64-bit)\r#\u0026gt; Running under: Windows 10 x64 (build 17134)\r#\u0026gt; #\u0026gt; Matrix products: default\r#\u0026gt; #\u0026gt; locale:\r#\u0026gt; [1] LC_COLLATE=English_United States.1252 LC_CTYPE=English_United States.1252 #\u0026gt; [3] LC_MONETARY=English_United States.1252 LC_NUMERIC=C #\u0026gt; [5] LC_TIME=English_United States.1252 #\u0026gt; #\u0026gt; attached base packages:\r#\u0026gt; [1] stats graphics grDevices utils datasets methods base #\u0026gt; #\u0026gt; other attached packages:\r#\u0026gt; [1] forcats_0.3.0 stringr_1.3.1.9000 dplyr_0.7.99.9000 #\u0026gt; [4] purrr_0.2.4.9000 readr_1.1.1 tidyr_0.8.1.9000 #\u0026gt; [7] tibble_1.4.2 ggplot2_3.1.0.9000 tidyverse_1.2.1.9000 #\u0026gt; [10] reticulate_1.10.0.9002\r#\u0026gt; #\u0026gt; loaded via a namespace (and not attached):\r#\u0026gt; [1] Rcpp_1.0.0 cellranger_1.1.0 plyr_1.8.4 #\u0026gt; [4] compiler_3.5.1 pillar_1.3.0.9001 tools_3.5.1 #\u0026gt; [7] htmldeps_0.1.1 digest_0.6.18 gtable_0.2.0 #\u0026gt; [10] lubridate_1.7.4 jsonlite_1.6 evaluate_0.12 #\u0026gt; [13] lattice_0.20-35 pkgconfig_2.0.2 rlang_0.3.0.1 #\u0026gt; [16] Matrix_1.2-14 cli_1.0.1 rstudioapi_0.8.0.9000\r#\u0026gt; [19] yaml_2.2.0 haven_1.1.2.9000 blogdown_0.9.1 #\u0026gt; [22] xfun_0.4 withr_2.1.2.9000 xml2_1.2.0 #\u0026gt; [25] httr_1.3.1 knitr_1.20.21 hms_0.4.2 #\u0026gt; [28] generics_0.0.1.9000 rprojroot_1.3-2 grid_3.5.1 #\u0026gt; [31] tidyselect_0.2.5 glue_1.3.0 here_0.1 #\u0026gt; [34] R6_2.3.0 readxl_1.1.0 rmarkdown_1.10.14 #\u0026gt; [37] bookdown_0.7.21 modelr_0.1.2 magrittr_1.5 #\u0026gt; [40] scales_1.0.0.9000 backports_1.1.2 htmltools_0.3.6 #\u0026gt; [43] rvest_0.3.2 assertthat_0.2.0 colorspace_1.3-2 #\u0026gt; [46] stringi_1.2.4 lazyeval_0.2.1 munsell_0.5.0 #\u0026gt; [49] broom_0.5.0.9001 crayon_1.3.4\r\r\r Rcpp \r\rif (R.version[\u0026quot;minor\u0026quot;] == \u0026quot;6.0\u0026quot;) {\r\u0026quot;GCC 8.2.0\u0026quot;\r} else {\rsystem(\u0026quot;gcc --version\u0026quot;, intern = TRUE)[[1]]\r}\r#\u0026gt; [1] \u0026quot;gcc.exe (x86_64-posix-seh, Built by MinGW-W64 project) 4.9.3\u0026quot;\r\r\r C++ \r\rgcc-8 --version\r#\u0026gt; gcc-8 (Ubuntu 8.2.0-1ubuntu2~18.04) 8.2.0\r#\u0026gt; Copyright (C) 2018 Free Software Foundation, Inc.\r#\u0026gt; This is free software; see the source for copying conditions. There is NO\r#\u0026gt; warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\r\r\r Python \r\rimport sys\rimport numpy\rimport numba\rimport cupy\rimport pandas\rmod_info = {\r\u0026quot;Python\u0026quot;: sys.version,\r\u0026quot;NumPy\u0026quot;: numpy.__version__,\r\u0026quot;Numba\u0026quot;: numba.__version__,\r\u0026quot;CuPy\u0026quot;: cupy.__version__,\r\u0026quot;Pandas\u0026quot;: pandas.__version__\r}\rfor k, v in mod_info.items():\rprint(f\u0026quot;{k}: {v}\u0026quot;)\r#\u0026gt; Python: 3.6.5 |Anaconda, Inc.| (default, Mar 29 2018, 13:32:41) [MSC v.1900 64 bit (AMD64)]\r#\u0026gt; NumPy: 1.15.4\r#\u0026gt; Numba: 0.40.0\r#\u0026gt; CuPy: 5.0.0\r#\u0026gt; Pandas: 0.23.4\r\r\r CPU \r\rcat(system(\u0026quot;wmic cpu get name\u0026quot;, intern = TRUE)[[2]])\r#\u0026gt; Intel(R) Core(TM) i7-6700HQ CPU @ 2.60GHz \r\r\r GPU \r\rsystem(\u0026quot;wmic path win32_VideoController get name\u0026quot;, intern = TRUE) %\u0026gt;% str_subset(\u0026quot;NVIDIA\u0026quot;) %\u0026gt;% str_trim()\r#\u0026gt; [1] \u0026quot;NVIDIA GeForce GTX 960M\u0026quot;\r\r\r Memory \r\rsystem(\u0026quot;wmic MEMORYCHIP get BankLabel, Capacity, Speed\u0026quot;, intern = TRUE) %\u0026gt;%\rstr_trim() %\u0026gt;%\ras_tibble() %\u0026gt;%\rslice(2:3) %\u0026gt;%\rseparate(value, into = c(\u0026quot;BankLabel\u0026quot;, \u0026quot;Capacity\u0026quot;, \u0026quot;Speed\u0026quot;), sep = \u0026quot;\\\\s{2,}\u0026quot;) %\u0026gt;%\rmutate_at(vars(Capacity), ~ paste(round(as.numeric(.) / 1e9, 2), \u0026quot;GB\u0026quot;)) %\u0026gt;%\rmutate(Speed = paste(Speed, \u0026quot;MHz\u0026quot;)) %\u0026gt;%\rrename_all(str_replace, \u0026quot;L\u0026quot;, \u0026quot; L\u0026quot;) %\u0026gt;%\rknitr::kable(format = \u0026quot;html\u0026quot;) %\u0026gt;%\rkableExtra::kable_styling(full_width = FALSE)\r\r\rBank Label\r\rCapacity\r\rSpeed\r\r\r\r\r\rDIMM A\r\r17.18 GB\r\r2400 MHz\r\r\r\rDIMM B\r\r17.18 GB\r\r2400 MHz\r\r\r\r\r\r\nCitation and \\(\\normalsize{\\textrm B} \\scriptsize{\\textrm{IB}} \\normalsize{\\TeX}\\)\nWhen using or referring to this post, please consider citing it.\nKnapp, B. (2018, Dec. 2). Linear Algebra. Retrieved from https://knapply.com/post/linear-algebra/\r@misc{linear-algebra,\rauthor = {Knapp, Brendan},\rtitle = {Linear Algebra},\rurl = {https://knapply.com/post/linear-algebra/},\ryear = 2018,\rmonth = Dec,\rday = 2,\r}\r\r",
    "date": 1543708800,
    "expirydate": -62135596800,
    "kind": "page",
    "lang": "en",
    "lastmod": 1544472333,
    "objectID": "e3886e9ebd0307ad2a9afd41ecbf4bae",
    "permalink": "/post/linear-algebra/",
    "publishdate": "2018-12-02T00:00:00Z",
    "relpermalink": "/post/linear-algebra/",
    "section": "post",
    "summary": "Common linear algebra operations.",
    "tags": [
      "data-science-notes",
      "statistics",
      "programming",
      "r",
      "python",
      "rcpp"
    ],
    "title": "Linear Algebra",
    "type": "post"
  },
  {
    "authors": null,
    "categories": [
      "data-science-from-scratch",
      "statistics",
      "central-tendency",
      "tutorial",
      "programming"
    ],
    "content": "\r\r\rWhat is it?\rR\rBase R\r\rRcpp\rBlueprint\rTemplated\r\rPython\rPure Python\rNumPy\rNumba\rParallel\r\rCuPy\r\rShootout\rEnvironment\r\r\r\rThis post was last updated on 2018-11-30.\n\rWhat is it?\rGiven a sequence, the mode is the value with the highest number of occurrences.\n\rSteps\r\rfind the unique values\rcount the number of occurrences of each value\rthe mode is the value with the highest number of occurrences\r\r\r\rR\rBase R\rr_mode \u0026lt;- function(x) {\runiques \u0026lt;- x[!duplicated(x)]\runiques[which.max(tabulate(match(x, uniques)))]\r}\rr_vector \u0026lt;- c(1, 4, 3, 2, 4, 5, 4, 3, 4, 6, 4, 3)\rr_mode(r_vector)\r#\u0026gt; [1] 4\r\r\rRcpp\rBlueprint\r//[[Rcpp::plugins(cpp17)]]\r#include \u0026lt;Rcpp.h\u0026gt;\r// [[Rcpp::export]]\rdouble cpp_mode_blueprint(const Rcpp::NumericVector\u0026amp; x) {\rstd::unordered_map\u0026lt;double, std::size_t\u0026gt; counter;\rauto max_count = 0;\rdouble out = 0;\rfor (auto i : x) {\rcounter[i]++;\rif (counter[i] \u0026gt; max_count) {\rmax_count = counter[i];\rout = i;\r}\r}\rreturn out;\r}\rr_vector \u0026lt;- c(4, 1, 4, 3, 2, 5, 4, 3, 4, 6, 4, 3)\rcpp_mode_blueprint(r_vector)\r#\u0026gt; [1] 4\r\rTemplated\r//[[Rcpp::plugins(cpp17)]]\r#include \u0026lt;Rcpp.h\u0026gt;\rtemplate \u0026lt;int RTYPE, typename T\u0026gt;\rauto cpp_mode_(const Rcpp::Vector\u0026lt;RTYPE\u0026gt;\u0026amp; x) {\rstd::unordered_map\u0026lt;T, size_t\u0026gt; counter(std::size(x));\rfor (auto i : x) {\rcounter[i]++;\r}\rsize_t max = 0;\rT out;\rfor (const auto\u0026amp; i : counter) {\rif (i.second \u0026gt; max) {\rmax = i.second;\rout = i.first;\r}\r}\rreturn Rcpp::wrap(out);\r}\r// [[Rcpp::export]]\rSEXP cpp_mode(const SEXP\u0026amp; x) {\rswitch( TYPEOF(x) ) {\rcase INTSXP:\rreturn cpp_mode_\u0026lt;INTSXP, int\u0026gt;(x);\rcase REALSXP:\rreturn cpp_mode_\u0026lt;REALSXP, double\u0026gt;(x);\rcase LGLSXP:\rreturn cpp_mode_\u0026lt;LGLSXP, bool\u0026gt;(x);\rcase STRSXP:\rreturn cpp_mode_\u0026lt;STRSXP, Rcpp::String\u0026gt;(x);\r}\rRcpp::warning(\u0026quot;Invalid SEXPTYPE %d (%s).\\n\u0026quot;, TYPEOF(x), Rcpp::type2name(x));\rreturn R_NilValue;\r}\rr_vector \u0026lt;- c(4, 1, 4, 3, 2, 5, 4, 3, 4, 6, 4, 3)\rcpp_mode(r_vector)\r#\u0026gt; [1] 4\r\r\rPython\rPure Python\rimport statistics\rpy_list = [4, 1, 4, 3, 2, 5, 4, 3, 4, 6, 4, 3]\rres = statistics.mode(py_list)\rprint(res)\r#\u0026gt; 4\r\rNumPy\rimport numpy as np\rdef numpy_mode(x):\rkeys, counts = np.unique(x, return_counts = True)\rreturn keys[counts.argmax()]\rnumpy_array = np.array(py_list)\rres = numpy_mode(numpy_array)\rprint(res)\r#\u0026gt; 4\r\rNumba\rimport numba\r@numba.jit()\rdef numba_mode(x):\rkeys, counts = np.unique(x, return_counts = True)\rreturn keys[counts.argmax()]\rres = numba_mode(numpy_array)\rprint(res)\r#\u0026gt; 4\rParallel\rimport numba\r@numba.jit(parallel = True)\rdef numba_par_mode(x):\rkeys, counts = np.unique(x, return_counts = True)\rreturn keys[counts.argmax()]\rres = numba_par_mode(numpy_array)\rprint(res)\r#\u0026gt; 4\r\r\rCuPy\rimport cupy as cp\rdef cupy_mode(x):\rkeys, counts = cp.unique(x, return_counts = True)\rreturn keys[counts.argmax()]\rcupy_array = cp.array(numpy_array, copy = True)\rres = cupy_mode(cupy_array)\rprint(res)\r#\u0026gt; 4\r\r\rShootout\r\r Test Setup \r\rlibrary(reticulate)\rlibrary(tidyverse)\rlibrary(bench)\rCreate R Data\nset.seed(831)\rr_data \u0026lt;- seq(-1e4, 1e4) %\u0026gt;%\rsample(replace = TRUE, size = 1e7) %\u0026gt;% c(rep(32L, 200)) %\u0026gt;% # our mode is 32\rsample()\rvalidation_data \u0026lt;- r_data\rTransfer to Python\nfrom copy import deepcopy\rnumpy_data = np.array(deepcopy(r.r_data))\rcupy_data = cp.array(numpy_data, copy = True)\rDo all the data match?\nare_equal \u0026lt;- list(r_data, py$numpy_data,\rpy$cp$asnumpy(py$cupy_data)) %\u0026gt;% map_lgl(~ all.equal(validation_data, as.vector(.x)))\rstopifnot(\rall(are_equal)\r)\r(n \u0026lt;- scales::comma(length(r_data)))\r#\u0026gt; [1] \u0026quot;10,000,200\u0026quot;\r(mem \u0026lt;- capture.output(pryr::object_size(r_data)))\r#\u0026gt; [1] \u0026quot;40 MB\u0026quot;\r\r\r bench::mark() \r\rres \u0026lt;- mark(\rr_mode(r_data),\rcpp_mode(r_data),\rpy_run_string(\u0026quot;numpy_mode(numpy_data)\u0026quot;, convert = FALSE),\rpy_run_string(\u0026quot;numba_mode(numpy_data)\u0026quot;, convert = FALSE),\rpy_run_string(\u0026quot;numba_par_mode(numpy_data)\u0026quot;, convert = FALSE),\rpy_run_string(\u0026quot;cupy_mode(cupy_data)\u0026quot;, convert = FALSE),\rmin_iterations = 5,\rcheck = FALSE, filter_gc = FALSE\r)\r\r\r wrangle_plot_save() \r\rwrangle_plot_save \u0026lt;- function(bench_marks, .n, .mem, .title) {\rdepends \u0026lt;- c(\u0026quot;dplyr\u0026quot;, \u0026quot;tidyr\u0026quot;, \u0026quot;stringr\u0026quot;, \u0026quot;ggplot2\u0026quot;, \u0026quot;extrafont\u0026quot;)\rsuccess \u0026lt;- vector(mode = \u0026quot;logical\u0026quot;, length = length(depends))\rfor (i in seq_along(depends)) {\rsuccess[[i]] \u0026lt;- require(depends[[i]], quietly = TRUE, character.only = TRUE)\r}\rif (!all(success)) {\rstop(paste(depends[!success], \u0026quot;packages not found.\u0026quot;))\r}\rextrafont::loadfonts(\u0026quot;win\u0026quot;, quiet = TRUE)\rout \u0026lt;- bench_marks %\u0026gt;% mutate(expression = as.character(expression)) %\u0026gt;% mutate(expression = if_else(\rstr_detect(expression, \u0026quot;py_run_string\u0026quot;),\rstr_extract(expression, \u0026#39;(?\u0026lt;=\u0026quot;).*?(?=\u0026quot;)\u0026#39;),\rexpression)\r) %\u0026gt;%\rmutate(expression = str_remove(expression, \u0026quot;(?\u0026lt;=\\\\().*?(?=\\\\))\u0026quot;)) %\u0026gt;% mutate(framework = case_when(\rstr_detect(expression, \u0026quot;^(np\\\\.|numpy_)\u0026quot;) ~ \u0026quot;NumPy\u0026quot;,\rstr_detect(expression, \u0026quot;^numba_\u0026quot;) ~ \u0026quot;Numba\u0026quot;,\rstr_detect(expression, \u0026quot;^(cp\\\\.|cupy_)\u0026quot;) ~ \u0026quot;CuPy\u0026quot;,\rstr_detect(expression, \u0026quot;^r?cpp_\u0026quot;) ~ \u0026quot;Rcpp\u0026quot;,\rstr_detect(expression, \u0026quot;^r_\u0026quot;) ~ \u0026quot;Base R\u0026quot;,\rTRUE ~ \u0026quot;Base R\u0026quot;\r)\r) %\u0026gt;%\rmutate(framework = str_glue(\u0026quot; {framework} \u0026quot;)) %\u0026gt;% mutate(is_parallel = str_detect(expression, \u0026quot;_par_\u0026quot;)) %\u0026gt;% mutate(is_gpu = str_detect(expression, \u0026quot;cupy_\u0026quot;)) %\u0026gt;% unnest() %\u0026gt;%\rgroup_by(expression) %\u0026gt;%\rmutate(med = median(as.numeric(time))) %\u0026gt;%\rungroup() %\u0026gt;%\rarrange(desc(med)) %\u0026gt;%\rmutate(Expression = as_factor(expression)) %\u0026gt;%\rarrange(med) %\u0026gt;%\r# mutate(expression = as_factor(expression)) %\u0026gt;%\rmutate(framework = as_factor(framework)) %\u0026gt;%\rrename(Time = time) %\u0026gt;% ggplot(aes(x = Expression, y = Time)) +\rstat_ydensity(aes(fill = framework), color = \u0026quot;gray\u0026quot;, alpha = 0.85,\rsize = 0.1, scale = \u0026quot;width\u0026quot;, bw = 0.01, trim = FALSE) +\rscale_fill_viridis_d() +\rguides(color = FALSE) +\rcoord_flip() +\rtheme_minimal(base_size = 18, base_family = \u0026quot;Palatino Linotype\u0026quot;) +\rtheme(#axis.title.x = element_text(size = 10),\raxis.title = element_blank(),\raxis.text.y = element_text(family = \u0026quot;Fira Code Retina\u0026quot;, size = 15, colour = \u0026quot;black\u0026quot;,\rmargin = margin(0, 0, 0, 0, \u0026quot;lines\u0026quot;)),\raxis.text.x = element_text(size = 12, colour = \u0026quot;black\u0026quot;,\rmargin = margin(0, 0, 0, 0, \u0026quot;lines\u0026quot;)),\rlegend.position = \u0026quot;bottom\u0026quot;, legend.title = element_blank(),\r# legend.text = element_text(family = \u0026quot;sans\u0026quot;, size = 14),\r# legend.key.size = unit(2, \u0026quot;lines\u0026quot;), plot.title = element_text(face = \u0026quot;bold\u0026quot;),\rplot.subtitle = element_text(size = 12, face = \u0026quot;italic\u0026quot;),\rplot.caption = element_text(family = \u0026quot;Fira Code Retina\u0026quot;, size = 14, face = \u0026quot;bold\u0026quot;),\rpanel.spacing = unit(0, \u0026quot;lines\u0026quot;),\rpanel.border = element_rect(colour = NA, fill = NA, size = 0)) +\rlabs(title = .title, subtitle = str_glue(\u0026quot;n = {n} ({mem})\u0026quot;),\rcaption = \u0026quot;knapply.com\u0026quot;)\rwrite_gg(plot = out)\rout\r}\r\r\r write_gg() \r\rwrite_gg \u0026lt;- function(plot, path = here::here(glue::glue(\u0026quot;content/post/{rmarkdown::metadata$title}/\u0026quot;)),\rwidth = 580, height = 426, text_factor = 1) {\rif (!require(ggplot2, quietly = TRUE)) {\rstop(\u0026quot;`ggplot2` package not found.\u0026quot;)\r}\rout \u0026lt;- plot +\rggplot2::theme(axis.text = ggplot2::element_text(size = 7),\rlegend.position = \u0026quot;none\u0026quot;, plot.caption = ggplot2::element_blank(),\rplot.subtitle = ggplot2::element_blank(),\rplot.title = ggplot2::element_blank())\rdpi \u0026lt;- text_factor * 125\rwidth \u0026lt;- width * 1.5 / dpi\rheight \u0026lt;- height * 1.5 / dpi\rggplot2::ggsave(filename = \u0026quot;featured.png\u0026quot;, plot = out, path = path, width = width, height = height, dpi = dpi)\r}\r\r\r res_gg \r\rres_gg \u0026lt;- wrangle_plot_save(res, .n = n, .mem = mem, .title = \u0026quot;Benchmarks: Statistical Mode\u0026quot;)\rres_gg\r\r\r Post Test Checks \r\rDo all methods obtain the same results?\ncontrol_res \u0026lt;- 32L\rc(\rr_mode(r_data),\rcpp_mode(r_data),\rpy$numpy_mode(py$numpy_data),\rpy$numba_mode(py$numpy_data),\rpy$numba_par_mode(py$numpy_data),\rpy$cp$asnumpy(py$cupy_mode(py$cupy_data))\r)\r#\u0026gt; [1] 32 32 32 32 32 32\rare_equal \u0026lt;- c(\rr_mode(r_data),\rcpp_mode(r_data),\rpy$numpy_mode(py$numpy_data),\rpy$numba_mode(py$numpy_data),\rpy$numba_par_mode(py$numpy_data),\rpy$cp$asnumpy(py$cupy_mode(py$cupy_data))\r) %\u0026gt;% map_lgl(~ control_res == .x)\rstopifnot(\rall(are_equal)\r)\rDid the input data remain unchanged?\nare_equal \u0026lt;- list(r_data, py$numpy_data,\rpy$cp$asnumpy(py$cupy_data)) %\u0026gt;% map_lgl(~ all.equal(validation_data, as.vector(.x)))\rstopifnot(\rall(are_equal)\r)\r\r\rEnvironment\r\r R \r\rsessionInfo()\r#\u0026gt; R version 3.6.0 Under development (Testing Rtools) (2018-09-22 r75352)\r#\u0026gt; Platform: x86_64-w64-mingw32/x64 (64-bit)\r#\u0026gt; Running under: Windows 10 x64 (build 17134)\r#\u0026gt; #\u0026gt; Matrix products: default\r#\u0026gt; #\u0026gt; locale:\r#\u0026gt; [1] LC_COLLATE=English_United States.1252 LC_CTYPE=English_United States.1252 #\u0026gt; [3] LC_MONETARY=English_United States.1252 LC_NUMERIC=C #\u0026gt; [5] LC_TIME=English_United States.1252 #\u0026gt; #\u0026gt; attached base packages:\r#\u0026gt; [1] stats graphics grDevices utils datasets methods base #\u0026gt; #\u0026gt; other attached packages:\r#\u0026gt; [1] extrafont_0.17 bench_1.0.1.9000 forcats_0.3.0 #\u0026gt; [4] stringr_1.3.1.9000 dplyr_0.7.99.9000 purrr_0.2.5 #\u0026gt; [7] readr_1.2.1 tidyr_0.8.2.9000 tibble_1.4.99.9005 #\u0026gt; [10] ggplot2_3.1.0.9000 tidyverse_1.2.1.9000 reticulate_1.10.0.9003\r#\u0026gt; #\u0026gt; loaded via a namespace (and not attached):\r#\u0026gt; [1] tidyselect_0.2.5 xfun_0.4 haven_2.0.0 lattice_0.20-35 #\u0026gt; [5] colorspace_1.3-2 viridisLite_0.3.0 htmltools_0.3.6 yaml_2.2.0 #\u0026gt; [9] rlang_0.3.0.1 pillar_1.3.0.9001 glue_1.3.0 withr_2.1.2 #\u0026gt; [13] pryr_0.1.4.9000 modelr_0.1.2 readxl_1.1.0 plyr_1.8.4 #\u0026gt; [17] munsell_0.5.0 blogdown_0.9.4 gtable_0.2.0 cellranger_1.1.0 #\u0026gt; [21] rvest_0.3.2 codetools_0.2-15 evaluate_0.12 knitr_1.20 #\u0026gt; [25] Rttf2pt1_1.3.7 profmem_0.5.0 broom_0.5.0 Rcpp_1.0.0 #\u0026gt; [29] backports_1.1.2 scales_1.0.0 jsonlite_1.5 hms_0.4.2 #\u0026gt; [33] digest_0.6.18 stringi_1.2.4 bookdown_0.7 grid_3.6.0 #\u0026gt; [37] rprojroot_1.3-2 here_0.1-11 cli_1.0.1 tools_3.6.0 #\u0026gt; [41] magrittr_1.5 lazyeval_0.2.1 extrafontdb_1.0 crayon_1.3.4 #\u0026gt; [45] pkgconfig_2.0.2 Matrix_1.2-14 xml2_1.2.0 lubridate_1.7.4 #\u0026gt; [49] assertthat_0.2.0 rmarkdown_1.10 httr_1.3.1 rstudioapi_0.8 #\u0026gt; [53] R6_2.3.0 nlme_3.1-137 compiler_3.6.0\r\r\r C++ \r\rif (R.version[\u0026quot;minor\u0026quot;] == \u0026quot;6.0\u0026quot;) {\r\u0026quot;GCC 8.2.0\u0026quot;\r} else {\rsystem(\u0026quot;gcc --version\u0026quot;, intern = TRUE)[[1]]\r}\r#\u0026gt; [1] \u0026quot;GCC 8.2.0\u0026quot;\r\r\r Python \r\rimport sys\rprint(sys.version)\r#\u0026gt; 3.6.5 |Anaconda, Inc.| (default, Mar 29 2018, 13:32:41) [MSC v.1900 64 bit (AMD64)]\rprint(np.__version__)\r#\u0026gt; 1.15.4\rprint(numba.__version__)\r#\u0026gt; 0.40.0\rprint(cp.__version__)\r#\u0026gt; 5.0.0\r\r\r CPU \r\rcat(system(\u0026quot;wmic cpu get name\u0026quot;, intern = TRUE)[[2]])\r#\u0026gt; Intel(R) Core(TM) i7-6700HQ CPU @ 2.60GHz \r\r\r GPU \r\rsystem(\u0026quot;wmic path win32_VideoController get name\u0026quot;, intern = TRUE) %\u0026gt;% str_subset(\u0026quot;NVIDIA\u0026quot;) %\u0026gt;% str_trim()\r#\u0026gt; [1] \u0026quot;NVIDIA GeForce GTX 960M\u0026quot;\r\r\r Memory \r\rsystem(\u0026quot;wmic MEMORYCHIP get BankLabel, Capacity, Speed\u0026quot;, intern = TRUE) %\u0026gt;%\rstr_trim() %\u0026gt;%\ras_tibble() %\u0026gt;%\rslice(2:3) %\u0026gt;%\rseparate(value, into = c(\u0026quot;BankLabel\u0026quot;, \u0026quot;Capacity\u0026quot;, \u0026quot;Speed\u0026quot;), sep = \u0026quot;\\\\s{2,}\u0026quot;) %\u0026gt;%\rmutate_at(vars(Capacity), ~ paste(round(as.numeric(.) / 1e9, 2), \u0026quot;GB\u0026quot;)) %\u0026gt;%\rmutate(Speed = paste(Speed, \u0026quot;MHz\u0026quot;)) %\u0026gt;%\rrename_all(str_replace, \u0026quot;L\u0026quot;, \u0026quot; L\u0026quot;) %\u0026gt;%\rknitr::kable(format = \u0026quot;html\u0026quot;) %\u0026gt;%\rkableExtra::kable_styling(full_width = FALSE)\r\r\rBank Label\r\rCapacity\r\rSpeed\r\r\r\r\r\rDIMM A\r\r17.18 GB\r\r2400 MHz\r\r\r\rDIMM B\r\r17.18 GB\r\r2400 MHz\r\r\r\r\r\r\nCitation and \\(\\normalsize{\\textrm B} \\scriptsize{\\textrm{IB}} \\normalsize{\\TeX}\\)\nWhen using or referring to this post, please consider citing it.\nKnapp, B. (2018, Nov. 23). Mode. Retrieved from https://knapply.com/post/mode/\r@misc{mode,\rauthor = {Knapp, Brendan},\rtitle = {Mode},\rurl = {https://knapply.com/post/mode/},\ryear = 2018,\rmonth = Nov,\rday = 23,\r}\r\r",
    "date": 1542931200,
    "expirydate": -62135596800,
    "kind": "page",
    "lang": "en",
    "lastmod": 1543618459,
    "objectID": "a178ecab6857553a8e8c0b55c5e634ec",
    "permalink": "/post/mode/",
    "publishdate": "2018-11-23T00:00:00Z",
    "relpermalink": "/post/mode/",
    "section": "post",
    "summary": "Finding the mode of a sequence, from scratch.",
    "tags": [
      "data-science-from-scratch",
      "statistics",
      "programming",
      "r",
      "python",
      "rcpp"
    ],
    "title": "Mode",
    "type": "post"
  },
  {
    "authors": null,
    "categories": [
      "data-science-notes"
    ],
    "content": "\r\r\rWhat is it?\rVariance\rTranslation\r\rStandard Deviation\rTranslation\r\r\rR\rBase R\r\rRcpp\rSugar\rRcppArmadillo\rCustom Template\r\rPython\rPure Python\rNumPy\rCuPy\r\rShootout\rEnvironment\r\r\r\rThis post was last updated on 2018-12-02.\n\rWhat is it?\rVariance\r\\[Var(x) = \\sigma^2 = \\frac{\\sum(x_i - \\mu_x)^2} {N-1}\\]\r\ror…\r\r\\[Var(x) = s^2 = \\frac{\\sum(x_i - \\bar{x})^2} {n-1}\\]\n\r\\(x_i\\): for each i in x\r\\(\\mu_x\\) and \\(\\bar{x}\\): arithmetic mean of the values in \\(x\\)\r\\(N\\) and \\(n\\): number of observations in \\(x\\)\r\\(\\sum\\): sum\r\rTranslation\r\\[\\textbf{variance} ~←~ \\frac{\\textbf{sum}(~(~\\textbf{for}~i~\\textbf{in}~x: i -\\textbf{mean}(x)~)^2~)} {\\textbf{length}(x) - 1}\\]\n\r\rStandard Deviation\r\\[\\sigma = \\sqrt{ \\frac{\\sum(x_i - \\mu_x)^2} {N-1} }\\]\r\ror…\r\r\\[s = \\sqrt{ \\frac{\\sum(x_i - \\bar{x})^2} {n-1} }\\]\n\ror, much more simply…\r\r\\[\\sigma = \\sqrt{ Var(x) }\\]\nTranslation\r\\[\\textbf{standard_deviation} ~←~ \\textbf{sqrt}(~\\textbf{variance}(x)~)\\]\nlibrary(glue)\r\r\r\rR\rBase R\r\rvariance: var()\rstandard deviation: sd()\r\rr_vector \u0026lt;- c(1, 4, 3, 2, 4, 5, 4, 3, 4, 6, 4, 3)\rglue(\u0026quot;variance = {var(r_vector)}\rstandard deviation = {sd(r_vector)}\u0026quot;)\r#\u0026gt; variance = 1.71969696969697\r#\u0026gt; standard deviation = 1.31137217055151\r\r\rRcpp\rSugar\r// [[Rcpp::plugins(cpp17)]]\r#include \u0026lt;Rcpp.h\u0026gt;\r// [[Rcpp::export]]\rdouble rcpp_sugar_var(const Rcpp::NumericVector\u0026amp; x) {\rreturn Rcpp::var(x);\r}\r// [[Rcpp::export]]\rdouble rcpp_sug_sd(const Rcpp::NumericVector\u0026amp; x) {\rreturn Rcpp::sd(x);\r}\rr_vector \u0026lt;- c(4, 1, 4, 3, 2, 5, 4, 3, 4, 6, 4, 3)\rglue(\u0026quot;variance = {rcpp_sugar_var(r_vector)}\rstandard deviation = {rcpp_sug_sd(r_vector)}\u0026quot;)\r#\u0026gt; variance = 1.71969696969697\r#\u0026gt; standard deviation = 1.31137217055151\r\rRcppArmadillo\r// [[Rcpp::plugins(cpp17)]]\r// [[Rcpp::depends(RcppArmadillo)]]\r#include \u0026lt;RcppArmadillo.h\u0026gt;\r// [[Rcpp::export]]\rauto cpp_arma_var(const Rcpp::NumericVector\u0026amp; x) {\rreturn arma::var( Rcpp::as\u0026lt;arma::vec\u0026gt;(x) );\r}\r// [[Rcpp::export]]\rauto cpp_arma_sd(const Rcpp::NumericVector\u0026amp; x) {\rreturn arma::stddev( Rcpp::as\u0026lt;arma::vec\u0026gt;(x) );\r}\rr_vector \u0026lt;- c(4, 1, 4, 3, 2, 5, 4, 3, 4, 6, 4, 3)\rglue(\u0026quot;variance = {cpp_arma_var(r_vector)}\rstandard deviation = {cpp_arma_sd(r_vector)}\u0026quot;)\r#\u0026gt; variance = 1.71969696969697\r#\u0026gt; standard deviation = 1.31137217055151\r\rCustom Template\r// [[Rcpp::plugins(cpp17)]]\r#include \u0026lt;Rcpp.h\u0026gt;\r#include \u0026lt;cmath\u0026gt; // std::pow\r// variance\rtemplate \u0026lt;int RTYPE, typename T\u0026gt; // variance template\rauto cpp_var_(const Rcpp::Vector\u0026lt;RTYPE\u0026gt;\u0026amp; x) {\rconst auto n = std::size(x);\rconst auto mean = std::accumulate(std::begin(x), std::end(x), 0.0) / n;\rconst auto x_minus_x_bar_squared = [mean] (const auto\u0026amp; i) {\rreturn std::pow(i - mean, 2.0);\r};\rdouble sum_squared_dev = 0;\rfor (auto i : x) {\rsum_squared_dev += x_minus_x_bar_squared(i);\r}\rreturn sum_squared_dev / (n - 1);\r}\r// [[Rcpp::export]]\rSEXP cpp_var(const SEXP\u0026amp; x) { // variance wrapper\rswitch( TYPEOF(x) ) {\rcase INTSXP:\rreturn Rcpp::wrap( cpp_var_\u0026lt;INTSXP, int\u0026gt;(x) );\rcase REALSXP:\rreturn Rcpp::wrap( cpp_var_\u0026lt;REALSXP, double\u0026gt;(x) );\r}\rRcpp::warning(\u0026quot;Invalid SEXPTYPE %d (%s).\\n\u0026quot;, TYPEOF(x), Rcpp::type2name(x));\rreturn R_NilValue;\r}\r// standard deviation\rtemplate \u0026lt;int RTYPE, typename T\u0026gt; // stantard deviation template\rauto cpp_sd_(const Rcpp::Vector\u0026lt;RTYPE\u0026gt;\u0026amp; x) {\rreturn Rcpp::sqrt( cpp_var(x) );\r}\r// [[Rcpp::export]]\rSEXP cpp_sd(const SEXP\u0026amp; x) { // standard deviation wrapper\rswitch( TYPEOF(x) ) {\rcase INTSXP:\rreturn Rcpp::wrap( cpp_sd_\u0026lt;INTSXP, int\u0026gt;(x) );\rcase REALSXP:\rreturn Rcpp::wrap( cpp_sd_\u0026lt;REALSXP, double\u0026gt;(x) );\r}\rRcpp::warning(\u0026quot;Invalid SEXPTYPE %d (%s).\\n\u0026quot;, TYPEOF(x), Rcpp::type2name(x));\rreturn R_NilValue;\r}\rr_vector \u0026lt;- c(4, 1, 4, 3, 2, 5, 4, 3, 4, 6, 4, 3)\rglue(\u0026quot;variance = {cpp_var(r_vector)}\rstandard deviation = {cpp_sd(r_vector)}\u0026quot;)\r#\u0026gt; variance = 1.71969696969697\r#\u0026gt; standard deviation = 1.31137217055151\r\r\rPython\rPure Python\r\rvariance: statistics.variance()\rstandard deviation: statistics.stdev()\r\rimport statistics\rpy_list = [4, 1, 4, 3, 2, 5, 4, 3, 4, 6, 4, 3]\rres = {\r\u0026quot;variance\u0026quot;: statistics.variance(py_list),\r\u0026quot;standard deviation\u0026quot;: statistics.stdev(py_list)\r}\rfor key, val in res.items():\rprint(f\u0026quot;{key}: {val}\u0026quot;)\r#\u0026gt; variance: 1.7196969696969697\r#\u0026gt; standard deviation: 1.3113721705515067\r\rNumPy\r\rvariance: np.var()\rstandard deviation: np.std()\r\rimport numpy as np\rnumpy_array = np.array(py_list).astype(\u0026#39;float64\u0026#39;)\rres = {\r\u0026quot;variance\u0026quot;: np.var(numpy_array, ddof = 1),\r\u0026quot;standard deviation\u0026quot;: np.std(numpy_array, ddof = 1)\r}\rfor key, val in res.items():\rprint(f\u0026quot;{key}: {val}\u0026quot;)\r#\u0026gt; variance: 1.7196969696969697\r#\u0026gt; standard deviation: 1.3113721705515067\r\rCuPy\r\rvariance: cp.var()\rstandard deviation: cp.std()\r\rimport cupy as cp\rcupy_array = cp.array(numpy_array, copy = True)\rres = {\r\u0026quot;variance\u0026quot;: cp.var(cupy_array, ddof = 1),\r\u0026quot;standard deviation\u0026quot;: cp.std(cupy_array, ddof = 1)\r}\rfor key, val in res.items():\rprint(f\u0026quot;{key}: {val}\u0026quot;)\r#\u0026gt; variance: 1.71969696969697\r#\u0026gt; standard deviation: 1.3113721705515067\r\r\rShootout\r\r Test Setup \r\rlibrary(reticulate)\rlibrary(tidyverse)\rlibrary(bench)\rCreate R Data\nset.seed(831)\rr_data \u0026lt;- seq(-1e4, 1e4, by = 0.2) %\u0026gt;%\rsample(replace = TRUE, size = 1e7)\rvalidation_data \u0026lt;- r_data\rTransfer to Python\nfrom copy import deepcopy\rnumpy_data = np.array(deepcopy(r.r_data))\rcupy_data = cp.array(numpy_data, copy = True)\rDo all the data match?\nvalidate_data(\rcontrol_data = validation_data,\r`R Data Used` = r_data,\r`NumPy Data Used` = py$numpy_data,\r`CuPy Data Used` = py$cp$asnumpy(py$cupy_data)\r)\r\r\rMethod\r\rStill Intact?\r\r\r\r\r\rOriginal R Data\r\rTRUE\r\r\r\rR Data Used\r\rTRUE\r\r\r\rNumPy Data Used\r\rTRUE\r\r\r\rCuPy Data Used\r\rTRUE\r\r\r\r\r(n \u0026lt;- scales::comma(length(r_data)))\r#\u0026gt; [1] \u0026quot;10,000,000\u0026quot;\r(mem \u0026lt;- capture.output(pryr::object_size(r_data)))\r#\u0026gt; [1] \u0026quot;80 MB\u0026quot;\r\r\r bench::mark() \r\rres \u0026lt;- mark(\rsd(r_data),\rrcpp_sug_sd(r_data),\rcpp_sd(r_data),\rpy_run_string(\u0026quot;np.std(numpy_data, ddof = 1)\u0026quot;, convert = FALSE),\rpy_run_string(\u0026quot;cp.std(cupy_data, ddof = 1)\u0026quot;, convert = FALSE),\r# min_iterations = 10,\riterations = 10,\rcheck = FALSE, filter_gc = FALSE\r)\r\r\r wrangle_plot_save() \r\rwrangle_plot_save \u0026lt;- function(bench_marks, .n, .mem, .title, ...) {\rdepends \u0026lt;- c(\u0026quot;dplyr\u0026quot;, \u0026quot;tidyr\u0026quot;, \u0026quot;stringr\u0026quot;, \u0026quot;ggplot2\u0026quot;, \u0026quot;extrafont\u0026quot;)\rsuccess \u0026lt;- vector(mode = \u0026quot;logical\u0026quot;, length = length(depends))\rfor (i in seq_along(depends)) {\rsuccess[[i]] \u0026lt;- require(depends[[i]], quietly = TRUE, character.only = TRUE)\r}\rif (!all(success)) {\rstop(paste(depends[!success], \u0026quot;packages not found.\u0026quot;))\r}\rextrafont::loadfonts(\u0026quot;win\u0026quot;, quiet = TRUE)\rdf \u0026lt;- bench_marks %\u0026gt;% mutate(expression = as.character(expression)) %\u0026gt;% mutate(expression = if_else(\rstr_detect(expression, \u0026quot;py_run_string\u0026quot;),\rstr_extract(expression, \u0026#39;(?\u0026lt;=\u0026quot;).*?(?=\u0026quot;)\u0026#39;),\rexpression)\r) %\u0026gt;%\rmutate(framework = case_when(\rstr_detect(expression, \u0026quot;^(np\\\\.|numpy_)\u0026quot;) ~ \u0026quot;NumPy\u0026quot;,\rstr_detect(expression, \u0026quot;^numba_\u0026quot;) ~ \u0026quot;Numba\u0026quot;,\rstr_detect(expression, \u0026quot;^numba_\u0026quot;) ~ \u0026quot;Numba Parallel\u0026quot;,\rstr_detect(expression, \u0026quot;^(cp\\\\.|cupy_)\u0026quot;) ~ \u0026quot;CuPy\u0026quot;,\rstr_detect(expression, \u0026quot;^r?cpp_arma_\u0026quot;) ~ \u0026quot;RcppArmadillo\u0026quot;,\rstr_detect(expression, \u0026quot;^r?cpp_par\u0026quot;) ~ \u0026quot;RcppParallel\u0026quot;,\rstr_detect(expression, \u0026quot;^r?cpp_\u0026quot;) ~ \u0026quot;Rcpp\u0026quot;,\rstr_detect(expression, \u0026quot;^r_\u0026quot;) ~ \u0026quot;Base R\u0026quot;,\rTRUE ~ \u0026quot;Base R\u0026quot;\r)\r) %\u0026gt;%\rmutate(expression = str_remove(expression, \u0026quot;(?\u0026lt;=\\\\().*?(?=\\\\))\u0026quot;)) %\u0026gt;%\rmutate(framework = str_glue(\u0026quot; {framework} \u0026quot;)) %\u0026gt;% mutate(is_parallel = str_detect(expression, \u0026quot;_par_\u0026quot;)) %\u0026gt;% mutate(is_gpu = str_detect(expression, \u0026quot;cupy_\u0026quot;)) %\u0026gt;% unnest() %\u0026gt;%\rgroup_by(expression) %\u0026gt;%\rmutate(med = median(as.numeric(time))) %\u0026gt;%\rungroup() %\u0026gt;%\rarrange(desc(med)) %\u0026gt;%\rmutate(Expression = as_factor(expression)) %\u0026gt;%\rarrange(med) %\u0026gt;%\r# mutate(expression = as_factor(expression)) %\u0026gt;%\rmutate(framework = as_factor(framework)) %\u0026gt;%\rrename(Time = time)\rout \u0026lt;- df %\u0026gt;% ggplot(aes(x = Expression, y = Time)) +\rggbeeswarm::geom_beeswarm(aes(fill = framework), alpha = 0.8, shape = 21, size = 4, cex = 2) +\rscale_fill_viridis_d() +\rbench::scale_y_bench_time(base = NULL) +\rguides(fill = guide_legend(override.aes = list(size = 5))) +\rcoord_flip() +\rtheme_minimal(base_size = 18, base_family = \u0026quot;Palatino Linotype\u0026quot;) +\rtheme(axis.title = element_blank(),\raxis.text.y = element_text(family = \u0026quot;Fira Code Retina\u0026quot;, size = 14, colour = \u0026quot;black\u0026quot;,\rmargin = margin(0, 0, 0, 0, \u0026quot;lines\u0026quot;)),\raxis.text.x = element_text(size = 12, colour = \u0026quot;black\u0026quot;,\rmargin = margin(0, 0, 0, 0, \u0026quot;lines\u0026quot;)),\rlegend.position = \u0026quot;bottom\u0026quot;, legend.title = element_blank(),\rplot.title = element_text(face = \u0026quot;bold\u0026quot;),\rplot.subtitle = element_text(size = 12, face = \u0026quot;italic\u0026quot;),\rplot.caption = element_text(family = \u0026quot;Fira Code Retina\u0026quot;, size = 14, face = \u0026quot;bold\u0026quot;),\rpanel.spacing = unit(0, \u0026quot;lines\u0026quot;),\rpanel.border = element_rect(colour = NA, fill = NA, size = 0)) +\rlabs(title = .title, subtitle = str_glue(\u0026quot;n = {n} ({mem})\u0026quot;),\rcaption = \u0026quot;knapply.com\u0026quot;)\rwrite_gg(plot = out, ...)\rout\r}\r\r\r write_gg() \r\rwrite_gg \u0026lt;- function(plot, path = get_post_path(), width = 580, height = 426) {\rif (!require(ggplot2, quietly = TRUE)) {\rstop(\u0026quot;`ggplot2` package not found.\u0026quot;)\r}\rout \u0026lt;- plot +\rggplot2::theme(axis.text = ggplot2::element_text(size = 7),\rlegend.position = \u0026quot;none\u0026quot;, plot.caption = ggplot2::element_blank(),\rplot.subtitle = ggplot2::element_blank(),\rplot.title = ggplot2::element_blank())\rdpi \u0026lt;- 125\rwidth \u0026lt;- width * 1.5 / dpi\rheight \u0026lt;- height * 1.5 / dpi\rggplot2::ggsave(filename = \u0026quot;featured.png\u0026quot;, plot = out, path = path, width = width, height = height, dpi = dpi)\r}\rget_post_path \u0026lt;- function() {\rdepends \u0026lt;- c(\u0026quot;here\u0026quot;, \u0026quot;rmarkdown\u0026quot;, \u0026quot;stringr\u0026quot;)\rsuccess \u0026lt;- vector(mode = \u0026quot;logical\u0026quot;, length = length(depends))\rfor (i in seq_along(depends)) {\rsuccess[[i]] \u0026lt;- require(depends[[i]], quietly = TRUE, character.only = TRUE)\r}\rif (!all(success)) {\rstop(paste(depends[!success], \u0026quot;packages not found.\u0026quot;))\r}\rpost_title \u0026lt;- rmarkdown::metadata$title\rclean_title \u0026lt;- stringr::str_to_lower(stringr::str_replace_all(post_title, \u0026quot;\\\\s\u0026quot;, \u0026quot;-\u0026quot;))\rhere::here(stringr::str_glue(\u0026quot;content/post/{clean_title}/\u0026quot;))\r}\r\r\r res_gg \r\rres_gg \u0026lt;- wrangle_plot_save(res, .n = n, .mem = mem, .title = \u0026quot;Benchmarks: Standard Deviation\u0026quot;)\rres_gg\r\r\r Post Test Checks \r\rDo all methods obtain the same results?\nvalidate_results \u0026lt;- function(control_res, ..., tol = sqrt(.Machine$double.eps)) {\rdots \u0026lt;- list(`Base R` = control_res, ...)\rres \u0026lt;- vapply(dots, eval, double(1))\rstopifnot(all(vapply(res, all.equal, FUN.VALUE = logical(1), control_res, tolerance = tol)))\rres_df \u0026lt;- tibble::tibble(Method = names(res), Result = res)\rkableExtra::kable_styling(knitr::kable(res_df), bootstrap_options = \u0026quot;condensed\u0026quot;,\rfull_width = FALSE)\r}\rvalidate_results(\rcontrol_res = sd(r_data),\r`Rcpp Sugar` = rcpp_sug_sd(r_data),\rRcpp = cpp_sd(r_data),\rNumPy = py$np$std(py$numpy_data, ddof = 1),\rCuPy = py$cp$asnumpy(py$cp$std(py$cupy_data, ddof = 1))\r)\r\r\rMethod\r\rResult\r\r\r\r\r\rBase R\r\r5775.081\r\r\r\rRcpp Sugar\r\r5775.081\r\r\r\rRcpp\r\r5775.081\r\r\r\rNumPy\r\r5775.081\r\r\r\rCuPy\r\r5775.081\r\r\r\r\rDid the input data remain unchanged?\nvalidate_data(\rcontrol_data = validation_data,\r`R Data Used` = r_data,\r`NumPy Data Used` = py$numpy_data,\r`CuPy Data Used` = py$cp$asnumpy(py$cupy_data)\r)\r\r\rMethod\r\rStill Intact?\r\r\r\r\r\rOriginal R Data\r\rTRUE\r\r\r\rR Data Used\r\rTRUE\r\r\r\rNumPy Data Used\r\rTRUE\r\r\r\rCuPy Data Used\r\rTRUE\r\r\r\r\r\r\rEnvironment\r\r R \r\rsessionInfo()\r#\u0026gt; R version 3.6.0 Under development (Testing Rtools) (2018-09-22 r75352)\r#\u0026gt; Platform: x86_64-w64-mingw32/x64 (64-bit)\r#\u0026gt; Running under: Windows 10 x64 (build 17134)\r#\u0026gt; #\u0026gt; Matrix products: default\r#\u0026gt; #\u0026gt; locale:\r#\u0026gt; [1] LC_COLLATE=English_United States.1252 LC_CTYPE=English_United States.1252 #\u0026gt; [3] LC_MONETARY=English_United States.1252 LC_NUMERIC=C #\u0026gt; [5] LC_TIME=English_United States.1252 #\u0026gt; #\u0026gt; attached base packages:\r#\u0026gt; [1] stats graphics grDevices utils datasets methods base #\u0026gt; #\u0026gt; other attached packages:\r#\u0026gt; [1] rmarkdown_1.10 here_0.1-11 extrafont_0.17 #\u0026gt; [4] bench_1.0.1.9000 forcats_0.3.0 stringr_1.3.1.9000 #\u0026gt; [7] dplyr_0.7.99.9000 purrr_0.2.5 readr_1.2.1 #\u0026gt; [10] tidyr_0.8.2.9000 tibble_1.4.99.9005 ggplot2_3.1.0.9000 #\u0026gt; [13] tidyverse_1.2.1.9000 reticulate_1.10.0.9003 glue_1.3.0 #\u0026gt; #\u0026gt; loaded via a namespace (and not attached):\r#\u0026gt; [1] Rcpp_1.0.0 lubridate_1.7.4 lattice_0.20-35 #\u0026gt; [4] assertthat_0.2.0 rprojroot_1.3-2 digest_0.6.18 #\u0026gt; [7] R6_2.3.0 cellranger_1.1.0 plyr_1.8.4 #\u0026gt; [10] backports_1.1.2 evaluate_0.12 httr_1.3.1 #\u0026gt; [13] highr_0.7 blogdown_0.9.4 pillar_1.3.0.9001 #\u0026gt; [16] rlang_0.3.0.1 lazyeval_0.2.1 readxl_1.1.0 #\u0026gt; [19] rstudioapi_0.8 extrafontdb_1.0 Matrix_1.2-14 #\u0026gt; [22] webshot_0.5.1 munsell_0.5.0 broom_0.5.0 #\u0026gt; [25] vipor_0.4.5 compiler_3.6.0 modelr_0.1.2 #\u0026gt; [28] xfun_0.4 pkgconfig_2.0.2 ggbeeswarm_0.6.0 #\u0026gt; [31] htmltools_0.3.6 tidyselect_0.2.5 bookdown_0.7 #\u0026gt; [34] codetools_0.2-15 viridisLite_0.3.0 crayon_1.3.4 #\u0026gt; [37] withr_2.1.2 grid_3.6.0 nlme_3.1-137 #\u0026gt; [40] jsonlite_1.5 Rttf2pt1_1.3.7 gtable_0.2.0 #\u0026gt; [43] magrittr_1.5 scales_1.0.0 cli_1.0.1 #\u0026gt; [46] stringi_1.2.4 profmem_0.5.0 pryr_0.1.4.9000 #\u0026gt; [49] RcppArmadillo_0.9.200.5.0 xml2_1.2.0 kableExtra_0.9.0 #\u0026gt; [52] tools_3.6.0 beeswarm_0.2.3 hms_0.4.2 #\u0026gt; [55] yaml_2.2.0 colorspace_1.3-2 rvest_0.3.2 #\u0026gt; [58] knitr_1.20 haven_2.0.0\r\r\r C++ \r\rif (R.version[\u0026quot;minor\u0026quot;] == \u0026quot;6.0\u0026quot;) {\r\u0026quot;GCC 8.2.0\u0026quot;\r} else {\rsystem(\u0026quot;gcc --version\u0026quot;, intern = TRUE)[[1]]\r}\r#\u0026gt; [1] \u0026quot;GCC 8.2.0\u0026quot;\r\r\r Python \r\rimport sys\rimport numpy\rimport numba\rimport cupy\rimport pandas\rmod_info = {\r\u0026quot;Python\u0026quot;: sys.version,\r\u0026quot;NumPy\u0026quot;: numpy.__version__,\r\u0026quot;Numba\u0026quot;: numba.__version__,\r\u0026quot;CuPy\u0026quot;: cupy.__version__,\r\u0026quot;Pandas\u0026quot;: pandas.__version__\r}\rfor k, v in mod_info.items():\rprint(f\u0026quot;{k}: {v}\u0026quot;)\r#\u0026gt; Python: 3.6.5 |Anaconda, Inc.| (default, Mar 29 2018, 13:32:41) [MSC v.1900 64 bit (AMD64)]\r#\u0026gt; NumPy: 1.15.4\r#\u0026gt; Numba: 0.40.0\r#\u0026gt; CuPy: 5.0.0\r#\u0026gt; Pandas: 0.23.4\r\r\r CPU \r\rcat(system(\u0026quot;wmic cpu get name\u0026quot;, intern = TRUE)[[2]])\r#\u0026gt; Intel(R) Core(TM) i7-6700HQ CPU @ 2.60GHz \r\r\r GPU \r\rsystem(\u0026quot;wmic path win32_VideoController get name\u0026quot;, intern = TRUE) %\u0026gt;% str_subset(\u0026quot;NVIDIA\u0026quot;) %\u0026gt;% str_trim()\r#\u0026gt; [1] \u0026quot;NVIDIA GeForce GTX 960M\u0026quot;\r\r\r Memory \r\rsystem(\u0026quot;wmic MEMORYCHIP get BankLabel, Capacity, Speed\u0026quot;, intern = TRUE) %\u0026gt;%\rstr_trim() %\u0026gt;%\ras_tibble() %\u0026gt;%\rslice(2:3) %\u0026gt;%\rseparate(value, into = c(\u0026quot;BankLabel\u0026quot;, \u0026quot;Capacity\u0026quot;, \u0026quot;Speed\u0026quot;), sep = \u0026quot;\\\\s{2,}\u0026quot;) %\u0026gt;%\rmutate_at(vars(Capacity), ~ paste(round(as.numeric(.) / 1e9, 2), \u0026quot;GB\u0026quot;)) %\u0026gt;%\rmutate(Speed = paste(Speed, \u0026quot;MHz\u0026quot;)) %\u0026gt;%\rrename_all(str_replace, \u0026quot;L\u0026quot;, \u0026quot; L\u0026quot;) %\u0026gt;%\rknitr::kable(format = \u0026quot;html\u0026quot;) %\u0026gt;%\rkableExtra::kable_styling(full_width = FALSE)\r\r\rBank Label\r\rCapacity\r\rSpeed\r\r\r\r\r\rDIMM A\r\r17.18 GB\r\r2400 MHz\r\r\r\rDIMM B\r\r17.18 GB\r\r2400 MHz\r\r\r\r\r\r\nCitation and \\(\\normalsize{\\textrm B} \\scriptsize{\\textrm{IB}} \\normalsize{\\TeX}\\)\nWhen using or referring to this post, please consider citing it.\nKnapp, B. (2018, Nov. 23). Variance and Standard Deviation. Retrieved from https://knapply.com/post/variance-and-standard-deviation/\r@misc{variance-and-standard-deviation,\rauthor = {Knapp, Brendan},\rtitle = {Variance and Standard Deviation},\rurl = {https://knapply.com/post/variance-and-standard-deviation/},\ryear = 2018,\rmonth = Nov,\rday = 23,\r}\r# n_row \u0026lt;- 1e4\r# n_col \u0026lt;- 1e4\r# # set.seed(831)\r# r_data \u0026lt;- seq(-1000, 1000, by = 0.1) %\u0026gt;%\r# sample(replace = TRUE, size = n_row * n_col) %\u0026gt;% # matrix(nrow = n_row, ncol = n_col)\r\r",
    "date": 1542931200,
    "expirydate": -62135596800,
    "kind": "page",
    "lang": "en",
    "lastmod": 1543807472,
    "objectID": "eec1693c54fc8191667374ae0487343e",
    "permalink": "/post/variance-and-standard-deviation/",
    "publishdate": "2018-11-23T00:00:00Z",
    "relpermalink": "/post/variance-and-standard-deviation/",
    "section": "post",
    "summary": "Finding the mode of a sequence, from scratch.",
    "tags": [
      "data-science-from-scratch",
      "statistics",
      "programming",
      "r",
      "python",
      "rcpp"
    ],
    "title": "Variance and Standard Deviation",
    "type": "post"
  },
  {
    "authors": null,
    "categories": [
      "data-science-from-scratch",
      "statistics",
      "tutorial",
      "programming"
    ],
    "content": "\r\rLength/Size\rMinimum and Maximum Values\rUnique Values\rSum\r\r\r\r\r\r$(function(){\rvar hash = document.location.hash;\rif (hash) {\r$('.navbar-nav a[href=\"' + hash + '\"]').tab('show');\r}\r$('a[data-toggle=\"tab\"]').on('click', function (e) {\rhistory.pushState(null, null, $(this).attr('href'));\r});\r});\r\rLength/Size\r\r--\rR\r\r--\r\r\r\r\r\r--\rRcpp\r\r--\r\r\r\r\r\r--\rC++\r\r--\r\r\r\r\r\r--\rPython\r\r--\r\r\r\r\r\r--\rNumPy\r\r--\r\r\r\r\ndescribing-data/r-length-size.R \r\rr_vector \u0026lt;- c(126, 793, 999, 525, 851, 798, 120, 714, 852, 151, 190, 41, 612, 826, 507, 105, 14, 237, 669, 7)\rr_vector\r#\u0026gt; [1] 126 793 999 525 851 798 120 714 852 151 190 41 612 826 507 105 14 237 669 7\rlength(r_vector)\r#\u0026gt; [1] 20\rdescribing-data/rcpp-length-size.cpp \r\r#include \u0026lt;Rcpp.h\u0026gt;\rusing namespace Rcpp;\r// [[Rcpp::export]]\rint cpp_length(NumericVector x) {\rreturn x.size();\r}\rr_vector \u0026lt;- c(126, 793, 999, 525, 851, 798, 120, 714, 852, 151,\r190, 41, 612, 826, 507, 105, 14, 237, 669, 7)\rcpp_length(r_vector)\r#\u0026gt; [1] 20\rcpp/cpp-length-size.cpp \r\r#include \u0026lt;iostream\u0026gt; // std::cout, std::endl\r#include \u0026lt;vector\u0026gt; // std::vector\rusing std::cout;\rusing std::endl;\rusing std::size;\rusing std::vector;\rint main() {\rint array_int[] = {126, 793, 999, 525, 851, 798, 120, 714, 852, 151, 190, 41, 612, 826, 507, 105, 14, 237, 669, 7};\r// manually calculate `array_int`\u0026#39;s length/size...\rauto n_bytes_of_array_int = sizeof(array_int); // how many bytes used by `array_int`?\rauto n_bytes_of_int = sizeof(int); // how many bytes used by single `int`?\rauto size_manual = n_bytes_of_array_int / n_bytes_of_int; // divide for result\rcout \u0026lt;\u0026lt; size_manual \u0026lt;\u0026lt; \u0026quot; ~ calculate `array_int`\u0026#39;s length/size manually\u0026quot; \u0026lt;\u0026lt; \u0026quot;\\n\u0026quot; \u0026lt;\u0026lt; endl;\r// built-in\rauto res1 = size(array_int);\rstd::cout \u0026lt;\u0026lt; res1 \u0026lt;\u0026lt; \u0026quot; ~ `array_int`\u0026#39;s length/size (built-in)\u0026quot; \u0026lt;\u0026lt; std::endl;\rvector\u0026lt;double\u0026gt; vec_dbl{126, 793, 999, 525, 851, 798, 120, 714, 852, 151, 190, 41, 612, 826, 507, 105, 14, 237, 669, 7};\rauto res2 = std::size(vec_dbl);\rstd::cout \u0026lt;\u0026lt; res2 \u0026lt;\u0026lt; \u0026quot; ~ `vec_dbl`\u0026#39;s length/size (built-in)\u0026quot; \u0026lt;\u0026lt; std::endl;\rreturn 0;\r}\rcd tutorial-gists/sections/describing-data/ \u0026amp;\u0026amp;\rg++ -std=c++17 cpp-length-size.cpp -o cpp-length-size \u0026amp;\u0026amp;\r./cpp-length-size\rcd /mnt/c/Users/Windows/Documents/tutorial-gists/sections/cpp \u0026amp;\u0026amp;\rg++ -std=c++17 cpp-length-size.cpp -o cpp-length-size \u0026amp;\u0026amp;\r./cpp-length-size\rdescribing-data/py-length-size.py \r\rpy_list = [126, 793, 999, 525, 851, 798, 120, 714, 852, 151, 190, 41, 612, 826, 507, 105, 14, 237, 669, 7]\rprint(py_list)\r#\u0026gt; [126, 793, 999, 525, 851, 798, 120, 714, 852, 151, 190, 41, 612, 826, 507, 105, 14, 237, 669, 7]\rres = len(py_list)\rprint(res)\r#\u0026gt; 20\rdescribing-data/numpy-length-size.py \r\rnumpy_array = np.array([126, 793, 999, 525, 851, 798, 120, 714, 852, 151, 190, 41, 612, 826, 507, 105, 14, 237, 669, 7])\rprint(numpy_array)\r#\u0026gt; [126 793 999 525 851 798 120 714 852 151 190 41 612 826 507 105 14 237 669 7]\rres = np.size(numpy_array)\rprint(res)\r#\u0026gt; 20\r\n\rMinimum and Maximum Values\r\r--\rR\r\r--\r\r\r\r\r\r--\rRcpp\r\r--\r\r\r\r\r\r--\rC++\r\r--\r\r\r\r\r\r--\rPython\r\r--\r\r\r\r\r\r--\rNumPy\r\r--\r\r\r\r\ndescribing-data/r-min-max.R \r\rr_vector \u0026lt;- c(126, 793, 999, 525, 851, 798, 120, 714, 852, 151, 190, 41, 612, 826, 507, 105, 14, 237, 669, 7)\rr_vector\r#\u0026gt; [1] 126 793 999 525 851 798 120 714 852 151 190 41 612 826 507 105 14 237 669 7\rmax(r_vector)\r#\u0026gt; [1] 999\rdescribing-data/rcpp-min-max.cpp \r\r#include \u0026lt;Rcpp.h\u0026gt;\rusing namespace Rcpp;\rusing std::min_element;\rusing std::max_element;\r// [[Rcpp::export]]\rdouble cpp_min(NumericVector x) {\rreturn *min_element(x.begin(), x.end()); }\r// [[Rcpp::export]]\rdouble cpp_max(NumericVector x) {\rreturn *max_element(x.begin(), x.end()); }\rr_vector \u0026lt;- c(126, 793, 999, 525, 851, 798, 120, 714, 852, 151,\r190, 41, 612, 826, 507, 105, 14, 237, 669, 7)\rcpp_min(r_vector)\r#\u0026gt; [1] 7\rcpp_max(r_vector)\r#\u0026gt; [1] 999\rcpp/cpp-min-max.cpp \r\r#include \u0026lt;algorithm\u0026gt; // std::min_element, std::max_element\r#include \u0026lt;iostream\u0026gt; // std::cout, std::endl\r#include \u0026lt;vector\u0026gt; // std::vector\rint main() {\r// example data\rstd::vector\u0026lt;double\u0026gt; cpp_vector {126, 793, 999, 525, 851, 798, 120, 714, 852, 151, 190, 41, 612, 826, 507, 105, 14, 237, 669, 7};\r// find minimum value\rauto min_res = std::min_element(std::begin(cpp_vector), std::end(cpp_vector));\r// print\rstd::cout \u0026lt;\u0026lt; \u0026quot;minimum: \u0026quot; \u0026lt;\u0026lt; *min_res \u0026lt;\u0026lt; std::endl;\r// find maximum value\rauto max_res = std::max_element(std::begin(cpp_vector), std::end(cpp_vector));\r// print\rstd::cout \u0026lt;\u0026lt; \u0026quot;maximum: \u0026quot; \u0026lt;\u0026lt; *max_res \u0026lt;\u0026lt; std::endl;\rreturn 0;\r}\rcd tutorial-gists/sections/describing-data/ \u0026amp;\u0026amp;\rg++ -std=c++17 cpp-min-max.cpp -o cpp-min-max \u0026amp;\u0026amp;\r./cpp-min-max\r#\u0026gt; minimum: 7\r#\u0026gt; maximum: 999\rdescribing-data/py-min-max.py \r\rpy_list = [126, 793, 999, 525, 851, 798, 120, 714, 852, 151, 190, 41, 612, 826, 507, 105, 14, 237, 669, 7]\rprint(py_list)\r#\u0026gt; [126, 793, 999, 525, 851, 798, 120, 714, 852, 151, 190, 41, 612, 826, 507, 105, 14, 237, 669, 7]\rmin_res = min(py_list)\rprint(min_res)\r#\u0026gt; 7\rmax_res = max(py_list)\rprint(max_res)\r#\u0026gt; 999\rdescribing-data/numpy-min-max.py \r\rimport numpy as np\rnumpy_array = np.array([126, 793, 999, 525, 851, 798, 120, 714, 852, 151, 190, 41, 612, 826, 507, 105, 14, 237, 669, 7])\rprint(numpy_array)\r#\u0026gt; [126 793 999 525 851 798 120 714 852 151 190 41 612 826 507 105 14 237 669 7]\rmin_res = np.min(numpy_array)\rprint(min_res)\r#\u0026gt; 7\rmax_res = np.max(numpy_array)\rprint(max_res)\r#\u0026gt; 999\r\n\rUnique Values\r\r--\rR\r\r--\r\r\r\r\r\r--\rC++\r\r--\r\r\r\r\r\r--\rPython\r\r--\r\r\r\r\r\r--\rNumPy\r\r--\r\r\r\r\ndescribing-data/r-unique.R \r\r\r# r_vector \u0026lt;- c(126, 793, 999, 525, 851, 798, 120, 714, 852, 151,\r# 190, 41, 612, 826, 507, 105, 14, 237, 669, 7)\r# # cpp_sum(r_vector)\rcpp/cpp-unique.cpp \r\r#include \u0026lt;iostream\u0026gt; // std::cout, std::endl\r#include \u0026lt;vector\u0026gt; // std::vector\r#include \u0026quot;cpp-unique-h.hpp\u0026quot;\rusing std::cout;\rusing std::endl;\rusing std::vector;\rint main() {\rvector\u0026lt;double\u0026gt; vec_dbl{8, 2, 1, 10, 3, 2, 8, 6, 1, 2,\r4, 9, 2, 3, 4, 2, 8, 9, 10, 1};\rauto res = get_unique(vec_dbl);\rfor (auto i: res) std::cout \u0026lt;\u0026lt; i \u0026lt;\u0026lt; \u0026quot; \u0026quot;;\rcout \u0026lt;\u0026lt; \u0026quot; ~ unique `vec_dbl` elements\u0026quot; \u0026lt;\u0026lt; endl;\rreturn 0;\r}\rcpp/cpp-unique-h.hpp \r\r# pragma once\r#include \u0026lt;algorithm\u0026gt; // std::remove_if\r#include \u0026lt;unordered_set\u0026gt; // std::unordered_set\r#include \u0026lt;vector\u0026gt; // std::vector\rtemplate \u0026lt;typename T\u0026gt;\rauto get_unique(std::vector\u0026lt;T\u0026gt; x) {\rstd::unordered_set\u0026lt;T\u0026gt; seen;\rauto find_unique = [\u0026amp;seen] (const T\u0026amp; val) {\rif (seen.find(val) == std::end(seen)) {\rseen.insert(val);\rreturn false;\r} else {\rreturn true;\r}\r};\rx.erase(std::remove_if(std::begin(x), std::end(x), find_unique),\rstd::end(x));\rreturn x;\r}\rcd tutorial-gists/sections/describing-data/ \u0026amp;\u0026amp;\rg++ -std=c++17 cpp-unique.cpp -o cpp-unique \u0026amp;\u0026amp; ./cpp-unique\r#\u0026gt; 8 2 1 10 3 6 4 9 ~ unique `vec_dbl` elements\rdescribing-data/py-unique.py \r\rpy_list = [8, 2, 1, 10, 3, 2, 8, 6, 1, 2, 4, 9, 2, 3, 4, 2, 8, 9, 10, 1]\rdef get_unique(x):\rseen = set()\rseen_add = seen.add\rreturn [i for i in x if not (i in seen or seen_add(i))]\rresult = get_unique(py_list)\rprint(result)\r#\u0026gt; [8, 2, 1, 10, 3, 6, 4, 9]\rdescribing-data/numpy-unique.py \r\r\n\rSum\r\r--\rR\r\r--\r\r\r\r\r\r--\rRcpp\r\r--\r\r\r\r\r\r--\rC++\r\r--\r\r\r\r\r\r--\rPython\r\r--\r\r\r\r\r\r--\rNumPy\r\r--\r\r\r\r\ndescribing-data/r-sum.R \r\rr_vector = c(126, 793, 999, 525, 851, 798, 120, 714, 852, 151, 190, 41, 612, 826, 507, 105, 14, 237, 669, 7)\rr_vector\r#\u0026gt; [1] 126 793 999 525 851 798 120 714 852 151 190 41 612 826 507 105 14 237 669 7\rsum(r_vector)\r#\u0026gt; [1] 9137\rdescribing-data/rcpp-sum.cpp \r\r#include \u0026lt;Rcpp.h\u0026gt;\rusing namespace Rcpp;\r// [[Rcpp::export]]\rdouble cpp_sum(NumericVector x) {\rreturn sum(x);\r}\rr_vector \u0026lt;- c(126, 793, 999, 525, 851, 798, 120, 714, 852, 151,\r190, 41, 612, 826, 507, 105, 14, 237, 669, 7)\rcpp_sum(r_vector)\r#\u0026gt; [1] 9137\rcpp/cpp-sum.cpp \r\r#include \u0026quot;cpp-sum-h.hpp\u0026quot;\r#include \u0026lt;iostream\u0026gt; // std::cout, std::endl\r#include \u0026lt;vector\u0026gt; // std::vector\rusing std::cout;\rusing std::endl;\rusing std::size;\rusing std::vector;\rint main() {\rvector\u0026lt;double\u0026gt; vec_dbl{126, 793, 999, 525, 851, 798, 120, 714, 852, 151, 190, 41, 612, 826, 507, 105, 14, 237, 669, 7};\r// manually calculate `vec_dbl`\u0026#39;s sum...\rint sum_manual = 0; // start at 0\rint n = size(vec_dbl); // how many elements are in `vec_dbl`?\rfor (int i = 0; i \u0026lt; n; i++) { // for each of those elements...\rsum_manual += vec_dbl[i]; // add them to `sum_manual`\r}\rcout \u0026lt;\u0026lt; sum_manual \u0026lt;\u0026lt; \u0026quot; ~ sum `vec_dbl` manually\u0026quot; \u0026lt;\u0026lt; \u0026quot;\\n\u0026quot; \u0026lt;\u0026lt; endl; // print the result\r// modularize it...\rauto res1 = calc_sum(vec_dbl);\rcout \u0026lt;\u0026lt; res1 \u0026lt;\u0026lt; \u0026quot; ~ sum `vec_dbl` with template\u0026quot; \u0026lt;\u0026lt; \u0026quot;\\n\u0026quot; \u0026lt;\u0026lt; endl;\rvector\u0026lt;int\u0026gt; vec_int{126, 793, 999, 525, 851, 798, 120, 714, 852, 151, 190, 41, 612, 826, 507, 105, 14, 237, 669, 7};\rauto res2 = calc_sum(vec_int);\rcout \u0026lt;\u0026lt; res2 \u0026lt;\u0026lt; \u0026quot; ~ sum `vec_int` with template\u0026quot; \u0026lt;\u0026lt; \u0026quot;\\n\u0026quot; \u0026lt;\u0026lt; endl;\rauto res3 = calc_sum(126, 793, 999, 525, 851, 798, 120, 714, 852, 151, 190, 41, 612, 826, 507, 105, 14, 237, 669, 7);\rcout \u0026lt;\u0026lt; res3 \u0026lt;\u0026lt; \u0026quot; ~ sum individual numbers passed to variadic template\u0026quot; \u0026lt;\u0026lt; \u0026quot;\\n\u0026quot; \u0026lt;\u0026lt; endl;\rreturn 0;\r}\rcpp/cpp-sum-h.hpp \r\r#pragma once\r#include \u0026lt;numeric\u0026gt; // std::accumulate\r#include \u0026lt;vector\u0026gt; // std::vector\rtemplate \u0026lt;typename T\u0026gt;\rauto calc_sum(const std::vector\u0026lt;T\u0026gt; \u0026amp;x) { // sum a vector of anything\rT zero = 0;\rreturn std::accumulate(std::begin(x), std::end(x), zero);\r}\rtemplate \u0026lt;typename... T\u0026gt; auto calc_sum(const T\u0026amp; ...dots) { // sum variable number of arguments\rreturn (dots + ...);\r}\rcd tutorial-gists/sections/describing-data/ \u0026amp;\u0026amp; g++ -std=c++17 cpp-sum.cpp -o cpp-sum \u0026amp;\u0026amp; ./cpp-sum\r#\u0026gt; 9137 ~ sum `vec_dbl` manually\r#\u0026gt; #\u0026gt; 9137 ~ sum `vec_dbl` with template\r#\u0026gt; #\u0026gt; 9137 ~ sum `vec_int` with template\r#\u0026gt; #\u0026gt; 9137 ~ sum individual numbers passed to variadic template\rdescribing-data/py-sum.py \r\rpy_list = [126, 793, 999, 525, 851, 798, 120, 714, 852, 151, 190, 41, 612, 826, 507, 105, 14, 237, 669, 7]\rprint(py_list)\r#\u0026gt; [126, 793, 999, 525, 851, 798, 120, 714, 852, 151, 190, 41, 612, 826, 507, 105, 14, 237, 669, 7]\rres = sum(py_list)\rprint(res)\r#\u0026gt; 9137\rdescribing-data/numpy-sum.py \r\rimport numpy as np\rnumpy_array = np.array([126, 793, 999, 525, 851, 798, 120, 714, 852, 151, 190, 41, 612, 826, 507, 105, 14, 237, 669, 7])\rprint(numpy_array)\r#\u0026gt; [126 793 999 525 851 798 120 714 852 151 190 41 612 826 507 105 14 237 669 7]\rres = np.sum(numpy_array)\rprint(res)\r#\u0026gt; 9137\r\n\r",
    "date": 1541980800,
    "expirydate": -62135596800,
    "kind": "page",
    "lang": "en",
    "lastmod": 1543265254,
    "objectID": "b6a40e7b8d1b7c02c5458ff2ec7dd5e6",
    "permalink": "/post/describing-data/",
    "publishdate": "2018-11-12T00:00:00Z",
    "relpermalink": "/post/describing-data/",
    "section": "post",
    "summary": "Essential mathematical and programming operations",
    "tags": [
      "data-science-from-scratch",
      "statistics",
      "programming",
      "r",
      "python",
      "cpp",
      "rcpp"
    ],
    "title": "Describing Data",
    "type": "post"
  },
  {
    "authors": null,
    "categories": [
      "data-science-notes"
    ],
    "content": "\r\r\rR\rBase R\r\rRcpp\rSugar\rCustom\rBlueprint\rTemplated\rRcppParallel\r\r\rPython\rPure Python\rNumPy\rNumba\rParallel\r\rCuPy\r\rShootout\rEnvironment\r\r\rR\rBase R\rr_vector \u0026lt;- c(126, 793, 999, 525, 851, 798, 120, 714, 852, 151,\r190, 41, 612, 826, 507, 105, 14, 237, 669, 7)\rmean(r_vector)\r#\u0026gt; [1] 456.85\r\r\rRcpp\rSugar\r#include \u0026lt;Rcpp.h\u0026gt;\r// [[Rcpp::export]]\rdouble rcpp_sugar_mean(Rcpp::NumericVector x) {\rreturn Rcpp::mean(x);\r}\rr_vector \u0026lt;- c(126, 793, 999, 525, 851, 798, 120, 714, 852, 151,\r190, 41, 612, 826, 507, 105, 14, 237, 669, 7)\rrcpp_sugar_mean(r_vector)\r#\u0026gt; [1] 456.85\r\rCustom\rBlueprint\r//[[Rcpp::plugins(cpp17)]]\r#include \u0026lt;Rcpp.h\u0026gt;\r// [[Rcpp::export]]\rdouble cpp_mean_blueprint(const Rcpp::NumericVector\u0026amp; x) {\rdouble n = std::size(x);\rreturn std::accumulate(std::begin(x), std::end(x), 0.0) / n;\r}\rcpp_mean_blueprint(r_vector)\r#\u0026gt; [1] 456.85\r\rTemplated\r//[[Rcpp::plugins(cpp17)]]\r#include \u0026lt;Rcpp.h\u0026gt;\rtemplate \u0026lt;int RTYPE\u0026gt;\rauto cpp_mean_(const Rcpp::Vector\u0026lt;RTYPE\u0026gt;\u0026amp; x) {\rconst auto out = std::accumulate(std::begin(x), std::end(x), 0.0) / std::size(x);\rreturn Rcpp::wrap(out);\r}\r// [[Rcpp::export]]\rSEXP cpp_mean(const SEXP\u0026amp; x) {\rswitch( TYPEOF(x) ) {\rcase INTSXP:\rreturn cpp_mean_\u0026lt;INTSXP\u0026gt;(x);\rcase REALSXP:\rreturn cpp_mean_\u0026lt;REALSXP\u0026gt;(x);\r}\rRcpp::warning(\u0026quot;Invalid SEXPTYPE %d (%s).\\n\u0026quot;, TYPEOF(x), Rcpp::type2name(x));\rreturn R_NilValue;\r}\rcpp_mean(r_vector)\r#\u0026gt; [1] 456.85\r\rRcppParallel\rNote: struct Sum comes from the “Rcpp Gallery”.\n//[[Rcpp::plugins(cpp14)]]\r#include \u0026lt;Rcpp.h\u0026gt;\r// [[Rcpp::depends(RcppParallel)]]\r#include \u0026lt;RcppParallel.h\u0026gt;\rstruct Sum : public RcppParallel::Worker {\rconst RcppParallel::RVector\u0026lt;double\u0026gt; input;\rdouble value;\rSum(const Rcpp::NumericVector input) : input(input), value(0) {}\rSum(const Sum\u0026amp; sum, RcppParallel::Split) : input(sum.input), value(0) {}\rvoid operator()(std::size_t begin, std::size_t end) {\rvalue += std::accumulate(input.begin() + begin, input.begin() + end, 0.0);\r}\rvoid join(const Sum\u0026amp; rhs) { value += rhs.value; }\r};\r// [[Rcpp::export]]\rdouble cpp_par_mean(Rcpp::NumericVector x) {\rSum sum(x);\rparallelReduce(0, x.length(), sum);\rreturn sum.value / x.size();\r}\rcpp_par_mean(r_vector)\r#\u0026gt; [1] 456.85\r\r\r\rPython\rPure Python\rimport statistics\rpy_list = [126, 793, 999, 525, 851, 798, 120, 714, 852, 151,\r190, 41, 612, 826, 507, 105, 14, 237, 669, 7]\rres = statistics.mean(py_list)\rprint(res)\r#\u0026gt; 456.85\r\rNumPy\rimport numpy as np\rnumpy_array = np.array(py_list)\rres = np.mean(numpy_array)\rprint(res)\r#\u0026gt; 456.85\r\rNumba\rimport numba\r@numba.jit()\rdef numba_mean(x):\rreturn np.mean(x)\rres = numba_mean(numpy_array)\rprint(res)\r#\u0026gt; 456.85\rParallel\r@numba.jit(parallel = True)\rdef numba_par_mean(x):\rreturn np.mean(x)\rres = numba_par_mean(numpy_array)\rprint(res)\r#\u0026gt; 456.85\r\r\rCuPy\rimport cupy as cp\rcupy_array = cp.array(numpy_array, copy = True)\rres = cp.mean(cupy_array)\rprint(res)\r#\u0026gt; 456.85\r\r\rShootout\r\r Test Setup \r\rlibrary(reticulate)\rlibrary(tidyverse)\rlibrary(bench)\rCreate R Data\nset.seed(831)\rr_data \u0026lt;- seq(-1e4, 1e4, by = 0.2) %\u0026gt;%\rsample(replace = TRUE, size = 1e7) %\u0026gt;%\rsample()\rvalidation_data \u0026lt;- r_data\rTransfer to Python\nfrom copy import deepcopy\rnumpy_data = np.array(deepcopy(r.r_data))\rcupy_data = cp.array(numpy_data, copy = True)\rDo all the data match?\nare_equal \u0026lt;- list(r_data, py$numpy_data,\rpy$cp$asnumpy(py$cupy_data)) %\u0026gt;% map_lgl(~ all.equal(validation_data, as.vector(.x)))\rstopifnot(\rall(are_equal)\r)\r(n \u0026lt;- scales::comma(length(r_data)))\r#\u0026gt; [1] \u0026quot;10,000,000\u0026quot;\r(mem \u0026lt;- capture.output(pryr::object_size(r_data)))\r#\u0026gt; [1] \u0026quot;80 MB\u0026quot;\r\r\r bench::mark() \r\rres \u0026lt;- mark(\rmean(r_data),\rrcpp_sugar_mean(r_data),\rcpp_mean(r_data),\rcpp_par_mean(r_data),\rpy_run_string(\u0026quot;np.mean(numpy_data)\u0026quot;, convert = FALSE),\rpy_run_string(\u0026quot;numba_mean(numpy_data)\u0026quot;, convert = FALSE),\rpy_run_string(\u0026quot;numba_par_mean(numpy_data)\u0026quot;, convert = FALSE),\rpy_run_string(\u0026quot;cp.mean(cupy_data)\u0026quot;, convert = FALSE),\rmin_iterations = 5,\rcheck = FALSE, filter_gc = FALSE\r)\r\r\r wrangle_plot_save() \r\rwrangle_plot_save \u0026lt;- function(bench_marks, .n, .mem, .title) {\rdepends \u0026lt;- c(\u0026quot;dplyr\u0026quot;, \u0026quot;tidyr\u0026quot;, \u0026quot;stringr\u0026quot;, \u0026quot;ggplot2\u0026quot;, \u0026quot;extrafont\u0026quot;)\rsuccess \u0026lt;- vector(mode = \u0026quot;logical\u0026quot;, length = length(depends))\rfor (i in seq_along(depends)) {\rsuccess[[i]] \u0026lt;- require(depends[[i]], quietly = TRUE, character.only = TRUE)\r}\rif (!all(success)) {\rstop(paste(depends[!success], \u0026quot;packages not found.\u0026quot;))\r}\rextrafont::loadfonts(\u0026quot;win\u0026quot;, quiet = TRUE)\rout \u0026lt;- bench_marks %\u0026gt;% mutate(expression = as.character(expression)) %\u0026gt;% mutate(expression = if_else(\rstr_detect(expression, \u0026quot;py_run_string\u0026quot;),\rstr_extract(expression, \u0026#39;(?\u0026lt;=\u0026quot;).*?(?=\u0026quot;)\u0026#39;),\rexpression)\r) %\u0026gt;%\rmutate(expression = str_remove(expression, \u0026quot;(?\u0026lt;=\\\\().*?(?=\\\\))\u0026quot;)) %\u0026gt;% mutate(framework = case_when(\rstr_detect(expression, \u0026quot;^(np\\\\.|numpy_)\u0026quot;) ~ \u0026quot;NumPy\u0026quot;,\rstr_detect(expression, \u0026quot;^numba_\u0026quot;) ~ \u0026quot;Numba\u0026quot;,\rstr_detect(expression, \u0026quot;^(cp\\\\.|cupy_)\u0026quot;) ~ \u0026quot;CuPy\u0026quot;,\rstr_detect(expression, \u0026quot;^r?cpp_\u0026quot;) ~ \u0026quot;Rcpp\u0026quot;,\rstr_detect(expression, \u0026quot;^r_\u0026quot;) ~ \u0026quot;Base R\u0026quot;,\rTRUE ~ \u0026quot;Base R\u0026quot;\r)\r) %\u0026gt;%\rmutate(framework = str_glue(\u0026quot; {framework} \u0026quot;)) %\u0026gt;% mutate(is_parallel = str_detect(expression, \u0026quot;_par_\u0026quot;)) %\u0026gt;% mutate(is_gpu = str_detect(expression, \u0026quot;cupy_\u0026quot;)) %\u0026gt;% unnest() %\u0026gt;%\rgroup_by(expression) %\u0026gt;%\rmutate(med = median(as.numeric(time))) %\u0026gt;%\rungroup() %\u0026gt;%\rarrange(desc(med)) %\u0026gt;%\rmutate(Expression = as_factor(expression)) %\u0026gt;%\rarrange(med) %\u0026gt;%\r# mutate(expression = as_factor(expression)) %\u0026gt;%\rmutate(framework = as_factor(framework)) %\u0026gt;%\rrename(Time = time) %\u0026gt;% ggplot(aes(x = Expression, y = Time)) +\rstat_ydensity(aes(fill = framework), color = \u0026quot;gray\u0026quot;, alpha = 0.85,\rsize = 0.1, scale = \u0026quot;width\u0026quot;, bw = 0.01, trim = FALSE) +\rscale_fill_viridis_d() +\rguides(color = FALSE) +\rcoord_flip() +\rtheme_minimal(base_size = 18, base_family = \u0026quot;Palatino Linotype\u0026quot;) +\rtheme(#axis.title.x = element_text(size = 10),\raxis.title = element_blank(),\raxis.text.y = element_text(family = \u0026quot;Fira Code Retina\u0026quot;, size = 15, colour = \u0026quot;black\u0026quot;,\rmargin = margin(0, 0, 0, 0, \u0026quot;lines\u0026quot;)),\raxis.text.x = element_text(size = 12, colour = \u0026quot;black\u0026quot;,\rmargin = margin(0, 0, 0, 0, \u0026quot;lines\u0026quot;)),\rlegend.position = \u0026quot;bottom\u0026quot;, legend.title = element_blank(),\r# legend.text = element_text(family = \u0026quot;sans\u0026quot;, size = 14),\r# legend.key.size = unit(2, \u0026quot;lines\u0026quot;), plot.title = element_text(face = \u0026quot;bold\u0026quot;),\rplot.subtitle = element_text(size = 12, face = \u0026quot;italic\u0026quot;),\rplot.caption = element_text(family = \u0026quot;Fira Code Retina\u0026quot;, size = 14, face = \u0026quot;bold\u0026quot;),\rpanel.spacing = unit(0, \u0026quot;lines\u0026quot;),\rpanel.border = element_rect(colour = NA, fill = NA, size = 0)) +\rlabs(title = .title, subtitle = str_glue(\u0026quot;n = {n} ({mem})\u0026quot;),\rcaption = \u0026quot;knapply.com\u0026quot;)\rwrite_gg(plot = out)\rout\r}\r\r\r write_gg() \r\rwrite_gg \u0026lt;- function(plot, path = here::here(glue::glue(\u0026quot;content/post/{rmarkdown::metadata$title}/\u0026quot;)),\rwidth = 580, height = 426, text_factor = 1) {\rif (!require(ggplot2, quietly = TRUE)) {\rstop(\u0026quot;`ggplot2` package not found.\u0026quot;)\r}\rout \u0026lt;- plot +\rggplot2::theme(axis.text = ggplot2::element_text(size = 7),\rlegend.position = \u0026quot;none\u0026quot;, plot.caption = ggplot2::element_blank(),\rplot.subtitle = ggplot2::element_blank(),\rplot.title = ggplot2::element_blank())\rdpi \u0026lt;- text_factor * 125\rwidth \u0026lt;- width * 1.5 / dpi\rheight \u0026lt;- height * 1.5 / dpi\rggplot2::ggsave(filename = \u0026quot;featured.png\u0026quot;, plot = out, path = path, width = width, height = height, dpi = dpi)\r}\r\r\r res_gg \r\rres_gg \u0026lt;- wrangle_plot_save(res, .n = n, .mem = mem, .title = \u0026quot;Benchmarks: Arithmetic Mean\u0026quot;)\rres_gg\r\r\r Post Test Checks \r\rDo all methods obtain the same results?\n(control_res \u0026lt;- mean(r_data))\r#\u0026gt; [1] 0.1116423\rc(\rrcpp_sugar_mean(r_data),\rcpp_mean(r_data),\rcpp_par_mean(r_data),\rpy$np$mean(py$numpy_data),\rpy$numba_mean(py$numpy_data),\rpy$numba_par_mean(py$numpy_data),\rpy$cp$asnumpy(py$cp$mean(py$cupy_data))\r)\r#\u0026gt; [1] 0.1116423 0.1116423 0.1116423 0.1116423 0.1116423 0.1116423 0.1116423\rare_equal \u0026lt;- c(\rrcpp_sugar_mean(r_data),\rcpp_mean(r_data),\rcpp_par_mean(r_data),\rpy$np$mean(py$numpy_data),\rpy$numba_mean(py$numpy_data),\rpy$numba_par_mean(py$numpy_data),\rpy$cp$asnumpy(py$cp$mean(py$cupy_data))\r) %\u0026gt;% map_lgl(all.equal, control_res)\rstopifnot(\rall(are_equal)\r)\rDid the input data remain unchanged?\nare_equal \u0026lt;- list(r_data, py$numpy_data,\rpy$cp$asnumpy(py$cupy_data)) %\u0026gt;% map_lgl(~ all.equal(validation_data, as.vector(.x)))\rstopifnot(\rall(are_equal)\r)\r\r\rEnvironment\r\r R \r\rsessionInfo()\r#\u0026gt; R version 3.6.0 Under development (Testing Rtools) (2018-09-22 r75352)\r#\u0026gt; Platform: x86_64-w64-mingw32/x64 (64-bit)\r#\u0026gt; Running under: Windows 10 x64 (build 17134)\r#\u0026gt; #\u0026gt; Matrix products: default\r#\u0026gt; #\u0026gt; locale:\r#\u0026gt; [1] LC_COLLATE=English_United States.1252 LC_CTYPE=English_United States.1252 #\u0026gt; [3] LC_MONETARY=English_United States.1252 LC_NUMERIC=C #\u0026gt; [5] LC_TIME=English_United States.1252 #\u0026gt; #\u0026gt; attached base packages:\r#\u0026gt; [1] stats graphics grDevices utils datasets methods base #\u0026gt; #\u0026gt; other attached packages:\r#\u0026gt; [1] extrafont_0.17 bench_1.0.1.9000 forcats_0.3.0 #\u0026gt; [4] stringr_1.3.1.9000 dplyr_0.7.99.9000 purrr_0.2.5 #\u0026gt; [7] readr_1.2.1 tidyr_0.8.2.9000 tibble_1.4.99.9005 #\u0026gt; [10] ggplot2_3.1.0.9000 tidyverse_1.2.1.9000 reticulate_1.10.0.9003\r#\u0026gt; #\u0026gt; loaded via a namespace (and not attached):\r#\u0026gt; [1] tidyselect_0.2.5 xfun_0.4 haven_2.0.0 lattice_0.20-35 #\u0026gt; [5] colorspace_1.3-2 viridisLite_0.3.0 htmltools_0.3.6 yaml_2.2.0 #\u0026gt; [9] rlang_0.3.0.1 pillar_1.3.0.9001 glue_1.3.0 withr_2.1.2 #\u0026gt; [13] pryr_0.1.4.9000 modelr_0.1.2 readxl_1.1.0 plyr_1.8.4 #\u0026gt; [17] munsell_0.5.0 blogdown_0.9.4 gtable_0.2.0 cellranger_1.1.0 #\u0026gt; [21] rvest_0.3.2 codetools_0.2-15 evaluate_0.12 knitr_1.20 #\u0026gt; [25] Rttf2pt1_1.3.7 profmem_0.5.0 broom_0.5.0 Rcpp_1.0.0 #\u0026gt; [29] backports_1.1.2 scales_1.0.0 RcppParallel_4.4.1-1 jsonlite_1.5 #\u0026gt; [33] hms_0.4.2 digest_0.6.18 stringi_1.2.4 bookdown_0.7 #\u0026gt; [37] grid_3.6.0 rprojroot_1.3-2 here_0.1-11 cli_1.0.1 #\u0026gt; [41] tools_3.6.0 magrittr_1.5 lazyeval_0.2.1 extrafontdb_1.0 #\u0026gt; [45] crayon_1.3.4 pkgconfig_2.0.2 Matrix_1.2-14 xml2_1.2.0 #\u0026gt; [49] lubridate_1.7.4 assertthat_0.2.0 rmarkdown_1.10 httr_1.3.1 #\u0026gt; [53] rstudioapi_0.8 R6_2.3.0 nlme_3.1-137 compiler_3.6.0\r\r\r C++ \r\rif (R.version[\u0026quot;minor\u0026quot;] == \u0026quot;6.0\u0026quot;) {\r\u0026quot;GCC 8.2.0\u0026quot;\r} else {\rsystem(\u0026quot;gcc --version\u0026quot;, intern = TRUE)[[1]]\r}\r#\u0026gt; [1] \u0026quot;GCC 8.2.0\u0026quot;\r\r\r Python \r\rimport sys\rprint(sys.version)\r#\u0026gt; 3.6.5 |Anaconda, Inc.| (default, Mar 29 2018, 13:32:41) [MSC v.1900 64 bit (AMD64)]\rprint(np.__version__)\r#\u0026gt; 1.15.4\rprint(numba.__version__)\r#\u0026gt; 0.40.0\rprint(cp.__version__)\r#\u0026gt; 5.0.0\r\r\r CPU \r\rcat(system(\u0026quot;wmic cpu get name\u0026quot;, intern = TRUE)[[2]])\r#\u0026gt; Intel(R) Core(TM) i7-6700HQ CPU @ 2.60GHz \r\r\r GPU \r\rsystem(\u0026quot;wmic path win32_VideoController get name\u0026quot;, intern = TRUE) %\u0026gt;% str_subset(\u0026quot;NVIDIA\u0026quot;) %\u0026gt;% str_trim()\r#\u0026gt; [1] \u0026quot;NVIDIA GeForce GTX 960M\u0026quot;\r\r\r Memory \r\rsystem(\u0026quot;wmic MEMORYCHIP get BankLabel, Capacity, Speed\u0026quot;, intern = TRUE) %\u0026gt;%\rstr_trim() %\u0026gt;%\ras_tibble() %\u0026gt;%\rslice(2:3) %\u0026gt;%\rseparate(value, into = c(\u0026quot;BankLabel\u0026quot;, \u0026quot;Capacity\u0026quot;, \u0026quot;Speed\u0026quot;), sep = \u0026quot;\\\\s{2,}\u0026quot;) %\u0026gt;%\rmutate_at(vars(Capacity), ~ paste(round(as.numeric(.) / 1e9, 2), \u0026quot;GB\u0026quot;)) %\u0026gt;%\rmutate(Speed = paste(Speed, \u0026quot;MHz\u0026quot;)) %\u0026gt;%\rrename_all(str_replace, \u0026quot;L\u0026quot;, \u0026quot; L\u0026quot;) %\u0026gt;%\rknitr::kable(format = \u0026quot;html\u0026quot;) %\u0026gt;%\rkableExtra::kable_styling(full_width = FALSE)\r\r\rBank Label\r\rCapacity\r\rSpeed\r\r\r\r\r\rDIMM A\r\r17.18 GB\r\r2400 MHz\r\r\r\rDIMM B\r\r17.18 GB\r\r2400 MHz\r\r\r\r\r\r\nCitation and \\(\\normalsize{\\textrm B} \\scriptsize{\\textrm{IB}} \\normalsize{\\TeX}\\)\nWhen using or referring to this post, please consider citing it.\nKnapp, B. (2018, Nov. 12). Mean. Retrieved from https://knapply.com/post/mean/\r@misc{mean,\rauthor = {Knapp, Brendan},\rtitle = {Mean},\rurl = {https://knapply.com/post/mean/},\ryear = 2018,\rmonth = Nov,\rday = 12,\r}\r\r",
    "date": 1541980800,
    "expirydate": -62135596800,
    "kind": "page",
    "lang": "en",
    "lastmod": 1543618459,
    "objectID": "7fb290c1beb597e34beb00f89975f717",
    "permalink": "/post/mean/",
    "publishdate": "2018-11-12T00:00:00Z",
    "relpermalink": "/post/mean/",
    "section": "post",
    "summary": "Calculating the arithmetic mean of a sequence.",
    "tags": [
      "data-science-notes",
      "statistics",
      "central-tendency",
      "r",
      "python",
      "rcpp"
    ],
    "title": "Mean",
    "type": "post"
  },
  {
    "authors": null,
    "categories": [
      "data-science-notes",
      "statistics",
      "central-tendency"
    ],
    "content": "\r\r\rWhat is it?\rR\rBase R\rCustom Base R\r\rRcpp\rSugar\rCustom\rBlueprint\rTemplated\r\r\rPython\rPure Python\rNumPy\rNumba\rParallel\r\rCuPy\r\rShootout\rEnvironment\r\r\rWhat is it?\rGiven a sequence, which is the middle-most value. Put another way, what value is equally likely to be greater than the first half of a sorted sequence and lesser than the second half of a sorted sequence.\n\rSteps\r\rsort the sequence\rif the length of the sequence is odd\r\rthe middle value is the median\r\rif length of the sequence is even\r\rthe mean of the 2 middle values is the median\r\r\r\r\rR\rBase R\rr_even_n \u0026lt;- c(126, 793, 999, 525, 851, 798, 120, 714, 852, 151,\r190, 41, 612, 826, 507, 105, 14, 237, 669, 7)\rr_odd_n \u0026lt;- c(126, 793, 999, 525, 851, 798, 120, 714, 852, 151,\r190, 41, 612, 826, 507, 105, 14, 237, 669, 7, 375)\rmedian(r_even_n)\r#\u0026gt; [1] 516\rmedian(r_odd_n)\r#\u0026gt; [1] 507\r\rCustom Base R\rNote: This is essentially a stripped-down version of median.default().\nr_median \u0026lt;- function(x) {\rn \u0026lt;- length(x)\rmid \u0026lt;- (n + 1L) %/% 2L\rpartially_sorted \u0026lt;- sort(x, partial = n %/% 2L + 1L)\rif (n %% 2L) {\rreturn(partially_sorted[mid])\r} ( partially_sorted[[mid]] + partially_sorted[[mid + 1L]] ) / 2L }\rr_median(r_even_n)\r#\u0026gt; [1] 516\rr_median(r_odd_n)\r#\u0026gt; [1] 507\r\r\rRcpp\rSugar\r#include \u0026lt;Rcpp.h\u0026gt;\r// [[Rcpp::export]]\rdouble rcpp_sugar_median(Rcpp::NumericVector x) {\rreturn Rcpp::median(x);\r}\rr_even_n \u0026lt;- c(126, 793, 999, 525, 851, 798, 120, 714, 852, 151,\r190, 41, 612, 826, 507, 105, 14, 237, 669, 7)\rr_odd_n \u0026lt;- c(126, 793, 999, 525, 851, 798, 120, 714, 852, 151,\r190, 41, 612, 826, 507, 105, 14, 237, 669, 7, 375)\rrcpp_sugar_median(r_even_n)\r#\u0026gt; [1] 516\rrcpp_sugar_median(r_odd_n)\r#\u0026gt; [1] 507\r\rCustom\rBlueprint\r//[[Rcpp::plugins(cpp17)]]\r#include \u0026lt;Rcpp.h\u0026gt;\r// [[Rcpp::export]]\rauto cpp_median_blueprint(const Rcpp::NumericVector\u0026amp; x) {\rauto temp = Rcpp::clone(x);\rconst auto n = std::size(x);\rauto mid = std::begin(temp) + n / 2;\rstd::nth_element( std::begin(temp), mid, std::end(temp) );\rif (n % 2) {\rreturn *mid;\r}\rconst auto mid1 = *mid;\rstd::nth_element( std::begin(temp), --mid, std::end(temp) );\rreturn ( mid1 + *mid ) / 2.0;\r}\rcpp_median_blueprint(r_even_n)\r#\u0026gt; [1] 516\rcpp_median_blueprint(r_odd_n)\r#\u0026gt; [1] 507\r\rTemplated\r//[[Rcpp::plugins(cpp17)]]\r#include \u0026lt;Rcpp.h\u0026gt;\rtemplate \u0026lt;int RTYPE\u0026gt;\rauto cpp_median_(const Rcpp::Vector\u0026lt;RTYPE\u0026gt;\u0026amp; x) {\rauto temp = Rcpp::clone(x);\rconst auto n = std::size(temp);\rauto mid = std::begin(temp) + n / 2;\rstd::nth_element( std::begin(temp), mid, std::end(temp) );\rif (n % 2) {\rreturn Rcpp::wrap( *mid );\r}\rconst auto mid1 = *mid;\rstd::nth_element( std::begin(temp), --mid, std::end(temp) );\rreturn Rcpp::wrap( (mid1 + *mid) / 2.0 );\r}\r// [[Rcpp::export]]\rSEXP cpp_median(const SEXP\u0026amp; x) {\rswitch( TYPEOF(x) ) {\rcase INTSXP:\rreturn cpp_median_\u0026lt;INTSXP\u0026gt;(x);\rcase REALSXP:\rreturn cpp_median_\u0026lt;REALSXP\u0026gt;(x);\r}\rRcpp::warning(\u0026quot;Invalid SEXPTYPE %d (%s).\\n\u0026quot;, TYPEOF(x), Rcpp::type2name(x));\rreturn R_NilValue;\r}\rcpp_median(r_even_n)\r#\u0026gt; [1] 516\rcpp_median(r_odd_n)\r#\u0026gt; [1] 507\r\r\r\rPython\rPure Python\rimport statistics\rpy_even_n = [126, 793, 999, 525, 851, 798, 120, 714, 852, 151,\r190, 41, 612, 826, 507, 105, 14, 237, 669, 7]\rpy_odd_n = [126, 793, 999, 525, 851, 798, 120, 714, 852, 151,\r190, 41, 612, 826, 507, 105, 14, 237, 669, 7, 375]\rres1 = statistics.median(py_even_n)\rres2 = statistics.median(py_odd_n)\rprint([res1, res2])\r#\u0026gt; [516.0, 507]\r\rNumPy\rimport numpy as np\rnumpy_even_n = np.array(py_even_n)\rnumpy_odd_n = np.array(py_odd_n)\rres1 = np.median(numpy_even_n)\rres2 = np.median(numpy_odd_n)\rprint(res1, res2)\r#\u0026gt; 516.0 507.0\r\rNumba\rimport numba\r@numba.jit()\rdef numba_median(x):\rreturn np.median(x)\rres1 = numba_median(numpy_even_n)\rres2 = numba_median(numpy_odd_n)\rprint(res1, res2)\r#\u0026gt; 516.0 507.0\rParallel\r@numba.jit(parallel=True)\rdef numba_par_median(x):\rreturn np.median(x)\rres1 = numba_par_median(numpy_even_n)\rres2 = numba_par_median(numpy_odd_n)\rprint(res1, res2)\r#\u0026gt; 516.0 507.0\r\r\rCuPy\rimport cupy as cp\rdef cupy_median(x):\rn = cp.size(x)\rsorted_x = cp.sort(x)\rif n % 2:\rreturn sorted_x[n // 2]\rreturn (sorted_x[n // 2 - 1] + sorted_x[n // 2]) / 2\rcupy_even_n = cp.array(numpy_even_n)\rcupy_odd_n = cp.array(numpy_odd_n)\rres1 = cupy_median(cupy_even_n)\rres2 = cupy_median(cupy_odd_n)\rprint(res1, res2)\r#\u0026gt; 516.0 507\r\r\rShootout\r\r Test Setup \r\rlibrary(reticulate)\rlibrary(tidyverse)\rlibrary(bench)\rCreate R Data\nset.seed(831)\rr_data \u0026lt;- seq(-1e4, 1e4, by = 0.2) %\u0026gt;%\rsample(replace = TRUE, size = 1e7) %\u0026gt;%\rsample()\rvalidation_data \u0026lt;- r_data\rTransfer to Python\nfrom copy import deepcopy\rnumpy_data = np.array(deepcopy(r.r_data))\rcupy_data = cp.array(numpy_data, copy = True)\rDo all the data match?\nare_equal \u0026lt;- list(r_data, py$numpy_data,\rpy$cp$asnumpy(py$cupy_data)) %\u0026gt;% map_lgl(~ all.equal(validation_data, as.vector(.x)))\rstopifnot(\rall(are_equal)\r)\r(n \u0026lt;- scales::comma(length(r_data)))\r#\u0026gt; [1] \u0026quot;10,000,000\u0026quot;\r(mem \u0026lt;- capture.output(pryr::object_size(r_data)))\r#\u0026gt; [1] \u0026quot;80 MB\u0026quot;\r\r\r bench::mark() \r\rres \u0026lt;- mark(\rmedian(r_data),\rrcpp_sugar_median(r_data),\rcpp_median(r_data),\rpy_run_string(\u0026quot;np.median(numpy_data)\u0026quot;, convert = FALSE),\rpy_run_string(\u0026quot;numba_median(numpy_data)\u0026quot;, convert = FALSE),\rpy_run_string(\u0026quot;numba_par_median(numpy_data)\u0026quot;, convert = FALSE),\rpy_run_string(\u0026quot;cupy_median(cupy_data)\u0026quot;, convert = FALSE),\rmin_iterations = 5,\rcheck = FALSE, filter_gc = FALSE\r)\r\r\r wrangle_plot_save() \r\rwrangle_plot_save \u0026lt;- function(bench_marks, .n, .mem, .title) {\rdepends \u0026lt;- c(\u0026quot;dplyr\u0026quot;, \u0026quot;tidyr\u0026quot;, \u0026quot;stringr\u0026quot;, \u0026quot;ggplot2\u0026quot;, \u0026quot;extrafont\u0026quot;)\rsuccess \u0026lt;- vector(mode = \u0026quot;logical\u0026quot;, length = length(depends))\rfor (i in seq_along(depends)) {\rsuccess[[i]] \u0026lt;- require(depends[[i]], quietly = TRUE, character.only = TRUE)\r}\rif (!all(success)) {\rstop(paste(depends[!success], \u0026quot;packages not found.\u0026quot;))\r}\rextrafont::loadfonts(\u0026quot;win\u0026quot;, quiet = TRUE)\rout \u0026lt;- bench_marks %\u0026gt;% mutate(expression = as.character(expression)) %\u0026gt;% mutate(expression = if_else(\rstr_detect(expression, \u0026quot;py_run_string\u0026quot;),\rstr_extract(expression, \u0026#39;(?\u0026lt;=\u0026quot;).*?(?=\u0026quot;)\u0026#39;),\rexpression)\r) %\u0026gt;%\rmutate(expression = str_remove(expression, \u0026quot;(?\u0026lt;=\\\\().*?(?=\\\\))\u0026quot;)) %\u0026gt;% mutate(framework = case_when(\rstr_detect(expression, \u0026quot;^(np\\\\.|numpy_)\u0026quot;) ~ \u0026quot;NumPy\u0026quot;,\rstr_detect(expression, \u0026quot;^numba_\u0026quot;) ~ \u0026quot;Numba\u0026quot;,\rstr_detect(expression, \u0026quot;^(cp\\\\.|cupy_)\u0026quot;) ~ \u0026quot;CuPy\u0026quot;,\rstr_detect(expression, \u0026quot;^r?cpp_\u0026quot;) ~ \u0026quot;Rcpp\u0026quot;,\rstr_detect(expression, \u0026quot;^r_\u0026quot;) ~ \u0026quot;Base R\u0026quot;,\rTRUE ~ \u0026quot;Base R\u0026quot;\r)\r) %\u0026gt;%\rmutate(framework = str_glue(\u0026quot; {framework} \u0026quot;)) %\u0026gt;% mutate(is_parallel = str_detect(expression, \u0026quot;_par_\u0026quot;)) %\u0026gt;% mutate(is_gpu = str_detect(expression, \u0026quot;cupy_\u0026quot;)) %\u0026gt;% unnest() %\u0026gt;%\rgroup_by(expression) %\u0026gt;%\rmutate(med = median(as.numeric(time))) %\u0026gt;%\rungroup() %\u0026gt;%\rarrange(desc(med)) %\u0026gt;%\rmutate(Expression = as_factor(expression)) %\u0026gt;%\rarrange(med) %\u0026gt;%\r# mutate(expression = as_factor(expression)) %\u0026gt;%\rmutate(framework = as_factor(framework)) %\u0026gt;%\rrename(Time = time) %\u0026gt;% ggplot(aes(x = Expression, y = Time)) +\rstat_ydensity(aes(fill = framework), color = \u0026quot;gray\u0026quot;, alpha = 0.85,\rsize = 0.1, scale = \u0026quot;width\u0026quot;, bw = 0.01, trim = FALSE) +\rscale_fill_viridis_d() +\rguides(color = FALSE) +\rcoord_flip() +\rtheme_minimal(base_size = 18, base_family = \u0026quot;Palatino Linotype\u0026quot;) +\rtheme(#axis.title.x = element_text(size = 10),\raxis.title = element_blank(),\raxis.text.y = element_text(family = \u0026quot;Fira Code Retina\u0026quot;, size = 15, colour = \u0026quot;black\u0026quot;,\rmargin = margin(0, 0, 0, 0, \u0026quot;lines\u0026quot;)),\raxis.text.x = element_text(size = 12, colour = \u0026quot;black\u0026quot;,\rmargin = margin(0, 0, 0, 0, \u0026quot;lines\u0026quot;)),\rlegend.position = \u0026quot;bottom\u0026quot;, legend.title = element_blank(),\r# legend.text = element_text(family = \u0026quot;sans\u0026quot;, size = 14),\r# legend.key.size = unit(2, \u0026quot;lines\u0026quot;), plot.title = element_text(face = \u0026quot;bold\u0026quot;),\rplot.subtitle = element_text(size = 12, face = \u0026quot;italic\u0026quot;),\rplot.caption = element_text(family = \u0026quot;Fira Code Retina\u0026quot;, size = 14, face = \u0026quot;bold\u0026quot;),\rpanel.spacing = unit(0, \u0026quot;lines\u0026quot;),\rpanel.border = element_rect(colour = NA, fill = NA, size = 0)) +\rlabs(title = .title, subtitle = str_glue(\u0026quot;n = {n} ({mem})\u0026quot;),\rcaption = \u0026quot;knapply.com\u0026quot;)\rwrite_gg(plot = out)\rout\r}\r\r\r write_gg() \r\rwrite_gg \u0026lt;- function(plot, path = here::here(glue::glue(\u0026quot;content/post/{rmarkdown::metadata$title}/\u0026quot;)),\rwidth = 580, height = 426, text_factor = 1) {\rif (!require(ggplot2, quietly = TRUE)) {\rstop(\u0026quot;`ggplot2` package not found.\u0026quot;)\r}\rout \u0026lt;- plot +\rggplot2::theme(axis.text = ggplot2::element_text(size = 7),\rlegend.position = \u0026quot;none\u0026quot;, plot.caption = ggplot2::element_blank(),\rplot.subtitle = ggplot2::element_blank(),\rplot.title = ggplot2::element_blank())\rdpi \u0026lt;- text_factor * 125\rwidth \u0026lt;- width * 1.5 / dpi\rheight \u0026lt;- height * 1.5 / dpi\rggplot2::ggsave(filename = \u0026quot;featured.png\u0026quot;, plot = out, path = path, width = width, height = height, dpi = dpi)\r}\r\r\r res_gg \r\rres_gg \u0026lt;- wrangle_plot_save(res, .n = n, .mem = mem, .title = \u0026quot;Benchmarks: Median\u0026quot;)\rres_gg\r\r\r Post Test Checks \r\rDo all methods obtain the same results?\n(control_res \u0026lt;- median(r_data))\r#\u0026gt; [1] -2.4\rc(rcpp_sugar_median(r_data),\rcpp_median(r_data),\rpy$np$median(py$numpy_data),\rpy$numba_median(py$numpy_data),\rpy$numba_par_median(py$numpy_data),\rpy$cp$asnumpy(py$cupy_median(py$cupy_data)))\r#\u0026gt; [1] -2.4 -2.4 -2.4 -2.4 -2.4 -2.4\rare_equal \u0026lt;- c(\rrcpp_sugar_median(r_data),\rcpp_median(r_data),\rpy$np$median(py$numpy_data),\rpy$numba_median(py$numpy_data),\rpy$numba_par_median(py$numpy_data),\rpy$cp$asnumpy(py$cupy_median(py$cupy_data))\r) %\u0026gt;% map_lgl(~ control_res == .x)\rstopifnot(\rall(are_equal)\r)\rDid the input data remain unchanged?\nare_equal \u0026lt;- list(r_data, py$numpy_data,\rpy$cp$asnumpy(py$cupy_data)) %\u0026gt;% map_lgl(~ all.equal(validation_data, as.vector(.x)))\rstopifnot(\rall(are_equal)\r)\r\r\rEnvironment\r\r R \r\rsessionInfo()\r#\u0026gt; R version 3.6.0 Under development (Testing Rtools) (2018-09-22 r75352)\r#\u0026gt; Platform: x86_64-w64-mingw32/x64 (64-bit)\r#\u0026gt; Running under: Windows 10 x64 (build 17134)\r#\u0026gt; #\u0026gt; Matrix products: default\r#\u0026gt; #\u0026gt; locale:\r#\u0026gt; [1] LC_COLLATE=English_United States.1252 LC_CTYPE=English_United States.1252 #\u0026gt; [3] LC_MONETARY=English_United States.1252 LC_NUMERIC=C #\u0026gt; [5] LC_TIME=English_United States.1252 #\u0026gt; #\u0026gt; attached base packages:\r#\u0026gt; [1] stats graphics grDevices utils datasets methods base #\u0026gt; #\u0026gt; other attached packages:\r#\u0026gt; [1] extrafont_0.17 bench_1.0.1.9000 forcats_0.3.0 #\u0026gt; [4] stringr_1.3.1.9000 dplyr_0.7.99.9000 purrr_0.2.5 #\u0026gt; [7] readr_1.2.1 tidyr_0.8.2.9000 tibble_1.4.99.9005 #\u0026gt; [10] ggplot2_3.1.0.9000 tidyverse_1.2.1.9000 reticulate_1.10.0.9003\r#\u0026gt; #\u0026gt; loaded via a namespace (and not attached):\r#\u0026gt; [1] tidyselect_0.2.5 xfun_0.4 haven_2.0.0 lattice_0.20-35 #\u0026gt; [5] colorspace_1.3-2 viridisLite_0.3.0 htmltools_0.3.6 yaml_2.2.0 #\u0026gt; [9] rlang_0.3.0.1 pillar_1.3.0.9001 glue_1.3.0 withr_2.1.2 #\u0026gt; [13] pryr_0.1.4.9000 modelr_0.1.2 readxl_1.1.0 plyr_1.8.4 #\u0026gt; [17] munsell_0.5.0 blogdown_0.9.4 gtable_0.2.0 cellranger_1.1.0 #\u0026gt; [21] rvest_0.3.2 codetools_0.2-15 evaluate_0.12 knitr_1.20 #\u0026gt; [25] Rttf2pt1_1.3.7 profmem_0.5.0 broom_0.5.0 Rcpp_1.0.0 #\u0026gt; [29] backports_1.1.2 scales_1.0.0 jsonlite_1.5 hms_0.4.2 #\u0026gt; [33] digest_0.6.18 stringi_1.2.4 bookdown_0.7 grid_3.6.0 #\u0026gt; [37] rprojroot_1.3-2 here_0.1-11 cli_1.0.1 tools_3.6.0 #\u0026gt; [41] magrittr_1.5 lazyeval_0.2.1 extrafontdb_1.0 crayon_1.3.4 #\u0026gt; [45] pkgconfig_2.0.2 Matrix_1.2-14 xml2_1.2.0 lubridate_1.7.4 #\u0026gt; [49] assertthat_0.2.0 rmarkdown_1.10 httr_1.3.1 rstudioapi_0.8 #\u0026gt; [53] R6_2.3.0 nlme_3.1-137 compiler_3.6.0\r\r\r C++ \r\rif (R.version[\u0026quot;minor\u0026quot;] == \u0026quot;6.0\u0026quot;) {\r\u0026quot;GCC 8.2.0\u0026quot;\r} else {\rsystem(\u0026quot;gcc --version\u0026quot;, intern = TRUE)[[1]]\r}\r#\u0026gt; [1] \u0026quot;GCC 8.2.0\u0026quot;\r\r\r Python \r\rimport sys\rprint(sys.version)\r#\u0026gt; 3.6.5 |Anaconda, Inc.| (default, Mar 29 2018, 13:32:41) [MSC v.1900 64 bit (AMD64)]\rprint(np.__version__)\r#\u0026gt; 1.15.4\rprint(numba.__version__)\r#\u0026gt; 0.40.0\rprint(cp.__version__)\r#\u0026gt; 5.0.0\r\r\r CPU \r\rcat(system(\u0026quot;wmic cpu get name\u0026quot;, intern = TRUE)[[2]])\r#\u0026gt; Intel(R) Core(TM) i7-6700HQ CPU @ 2.60GHz \r\r\r GPU \r\rsystem(\u0026quot;wmic path win32_VideoController get name\u0026quot;, intern = TRUE) %\u0026gt;% str_subset(\u0026quot;NVIDIA\u0026quot;) %\u0026gt;% str_trim()\r#\u0026gt; [1] \u0026quot;NVIDIA GeForce GTX 960M\u0026quot;\r\r\r Memory \r\rsystem(\u0026quot;wmic MEMORYCHIP get BankLabel, Capacity, Speed\u0026quot;, intern = TRUE) %\u0026gt;%\rstr_trim() %\u0026gt;%\ras_tibble() %\u0026gt;%\rslice(2:3) %\u0026gt;%\rseparate(value, into = c(\u0026quot;BankLabel\u0026quot;, \u0026quot;Capacity\u0026quot;, \u0026quot;Speed\u0026quot;), sep = \u0026quot;\\\\s{2,}\u0026quot;) %\u0026gt;%\rmutate_at(vars(Capacity), ~ paste(round(as.numeric(.) / 1e9, 2), \u0026quot;GB\u0026quot;)) %\u0026gt;%\rmutate(Speed = paste(Speed, \u0026quot;MHz\u0026quot;)) %\u0026gt;%\rrename_all(str_replace, \u0026quot;L\u0026quot;, \u0026quot; L\u0026quot;) %\u0026gt;%\rknitr::kable(format = \u0026quot;html\u0026quot;) %\u0026gt;%\rkableExtra::kable_styling(full_width = FALSE)\r\r\rBank Label\r\rCapacity\r\rSpeed\r\r\r\r\r\rDIMM A\r\r17.18 GB\r\r2400 MHz\r\r\r\rDIMM B\r\r17.18 GB\r\r2400 MHz\r\r\r\r\r\r\nCitation and \\(\\normalsize{\\textrm B} \\scriptsize{\\textrm{IB}} \\normalsize{\\TeX}\\)\nWhen using or referring to this post, please consider citing it.\nKnapp, B. (2018, Nov. 12). Median. Retrieved from https://knapply.com/post/median/\r@misc{median,\rauthor = {Knapp, Brendan},\rtitle = {Median},\rurl = {https://knapply.com/post/median/},\ryear = 2018,\rmonth = Nov,\rday = 12,\r}\r\r",
    "date": 1541980800,
    "expirydate": -62135596800,
    "kind": "page",
    "lang": "en",
    "lastmod": 1543618459,
    "objectID": "08f71c2eb56bf1a64472357bfe7d0973",
    "permalink": "/post/median/",
    "publishdate": "2018-11-12T00:00:00Z",
    "relpermalink": "/post/median/",
    "section": "post",
    "summary": "Finding median of a sequence.",
    "tags": [
      "data-science-notes",
      "statistics",
      "central-tendency",
      "r",
      "python",
      "rcpp"
    ],
    "title": "Median",
    "type": "post"
  },
  {
    "authors": null,
    "categories": [
      "programming",
      "tutorial"
    ],
    "content": "\r\rFrom Scratch\rBuilt-in\r\r\r\r\rFrom Scratch\r\r--\rR\r\r--\r\r\r\r\r\r--\rRcpp\r\r--\r\r\r\r\r\r--\rC++\r\r--\r\r\r\r\r\r--\rPython\r\r--\r\r\r\r\nfoundational-programming/r-length1.R \r\rr_length \u0026lt;- function(x) {\rout \u0026lt;- 0L\rfor (i in x) {\rout \u0026lt;- out + 1L\r}\rout\r}\rr_vector \u0026lt;- 1:20\rr_vector\r#\u0026gt; [1] 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20\rr_length(r_vector)\r#\u0026gt; [1] 20\rfoundational-programming/rcpp-length1.cpp \r\r#include \u0026lt;Rcpp.h\u0026gt;\rusing namespace Rcpp;\r// [[Rcpp::export]]\rint cpp_length(NumericVector x) {\rint out = 0;\rfor (NumericVector::iterator iter = x.begin(); iter != x.end(); iter++) {\rout++;\r}\rreturn out;\r}\rcpp_length(1:20)\r#\u0026gt; [1] 20\rfoundational-programming/cpp-length1.cpp \r\r#include \u0026lt;iostream\u0026gt; // std::cout, std::endl\r#include \u0026lt;vector\u0026gt; // std::vector\rusing std::cout;\rusing std::endl;\rusing std::vector;\rint length(vector\u0026lt;double\u0026gt; \u0026amp;x) {\rint out = 0;\rfor (auto i = begin(x); i != end(x); ++i) {\rout++;\r}\rreturn out;\r}\rint main() {\rvector\u0026lt;double\u0026gt; v{ 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20 };\rint result = length(v);\rcout \u0026lt;\u0026lt; \u0026quot;length: \u0026quot; \u0026lt;\u0026lt; result \u0026lt;\u0026lt; endl;\rreturn 0;\r}\rg++ -std=c++17 cpp-length1.cpp -o cpp-length1 \u0026amp;\u0026amp; ./cpp-length1\r#\u0026gt; length: 20\rfoundational-programming/py-length1.py \r\rdef py_length(x):\rout = 0 for i in x:\rout += 1\rreturn out\rpy_generator = range(1, 21)\rprint(list(py_generator))\r#\u0026gt; [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20]\rresult = py_length(py_generator)\rprint(result)\r#\u0026gt; 20\r\n\rBuilt-in\r\r--\rR\r\r--\r\r\r\r\r\r--\rRcpp\r\r--\r\r\r\r\r\r--\rC++\r\r--\r\r\r\r\r\r--\rPython\r\r--\r\r\r\r\r\r--\rNumPy\r\r--\r\r\r\r\nfoundational-programming/r-length2.R \r\rr_vector \u0026lt;- 1:20\rr_vector\r#\u0026gt; [1] 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20\rlength(r_vector)\r#\u0026gt; [1] 20\rfoundational-programming/rcpp-length2.cpp \r\r#include \u0026lt;Rcpp.h\u0026gt;\rusing namespace Rcpp;\r// [[Rcpp::export]]\rint cpp_size(NumericVector x) {\rreturn x.size();\r}\rcpp_length(1:20)\r#\u0026gt; [1] 20\rfoundational-programming/cpp-length2.cpp \r\r#include \u0026lt;iostream\u0026gt; // std::cout, std::endl\r#include \u0026lt;iterator\u0026gt; // std::size\r#include \u0026lt;vector\u0026gt; // std::vector\rusing std::cout;\rusing std::endl;\rusing std::size;\rusing std::vector;\rint main() {\rvector\u0026lt;double\u0026gt; v{ 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20 };\rint result = size(v);\rcout \u0026lt;\u0026lt; \u0026quot;length: \u0026quot; \u0026lt;\u0026lt; result \u0026lt;\u0026lt; endl;\rreturn 0;\r}\r g++ -std=c++17 cpp-length2.cpp -o cpp-length2 \u0026amp;\u0026amp; ./cpp-length2\r#\u0026gt; length: 20\rfoundational-programming/py-length2.py \r\rpy_generator = range(1, 21)\rprint(list(py_generator))\r#\u0026gt; [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20]\rresult = len(py_generator)\rprint(result)\r#\u0026gt; 20\rfoundational-programming/numpy-length2.py \r\rimport numpy as np\rnumpy_array = np.array(range(1, 21))\rprint(numpy_array)\r#\u0026gt; [ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20]\rresult = np.size(numpy_array)\rprint(result)\r#\u0026gt; 20\r\n--\r--\r--\r--\r--\r --\r --\r--\r --\r --\r--\r --\r --\r--\r--\r--\rfoundational-programming/r-length1.R \r\r--\r--\r--\rfoundational-programming/py-length1.py \r\r--\r--\r--\rfoundational-programming/rcpp-length1.cpp \r\r--\r--\r --\r\nCitation and \\(\\normalsize{\\textrm B} \\scriptsize{\\textrm{IB}} \\normalsize{\\TeX}\\)\nWhen using or referring to this post, please consider citing it.\nKnapp, B. (2018, Nov. 3). Foundational Programming. Retrieved from https://knapply.com/post/foundational-programming/\r@misc{foundational-programming,\rauthor = {Knapp, Brendan},\rtitle = {Foundational Programming},\rurl = {https://knapply.com/post/foundational-programming/},\ryear = 2018,\rmonth = Nov,\rday = 3,\r}\r\r",
    "date": 1541203200,
    "expirydate": -62135596800,
    "kind": "page",
    "lang": "en",
    "lastmod": 1543265254,
    "objectID": "eed2d9a72e938b433c2e4b6592dd8266",
    "permalink": "/post/foundational-programming/",
    "publishdate": "2018-11-03T00:00:00Z",
    "relpermalink": "/post/foundational-programming/",
    "section": "post",
    "summary": "Foundational programming examples, such as finding lengths, minimums, maximums, and unique sets.",
    "tags": [
      "programming",
      "r",
      "python",
      "cpp",
      "rcpp",
      "numpy"
    ],
    "title": "Foundational Programming",
    "type": "post"
  },
  {
    "authors": null,
    "categories": [
      "tutorial",
      "programming"
    ],
    "content": "\r\rDefine doubler_*() Function\rRun doubler_*() Function\rCitation and \\(\\normalsize{\\textrm B} \\scriptsize{\\textrm{IB}} \\normalsize{\\TeX}\\)\r\r\rDefine doubler_*() Function\r\rr_doubler \u0026lt;- function(x) {\rx * 2\r}\r\rdef py_doubler(x):\rreturn x * 2\r\r\r#include \u0026lt;Rcpp.h\u0026gt;\r// [[Rcpp::export]]\rint cpp_doubler(int x) {\rreturn x * 2;\r}\r\r\r\r\rRun doubler_*() Function\r\rr_doubler(x = 4)\r## [1] 8\r\rprint(py_doubler(x = 4))\r## 8\r\r\rcpp_doubler(x = 4)\r## [1] 8\r\r\r\r\rCitation and \\(\\normalsize{\\textrm B} \\scriptsize{\\textrm{IB}} \\normalsize{\\TeX}\\)\rKnapp, B. (2018, Nov. 1). Functions. Retrieved from https://knapply.com/post/functions/\r@misc{functions,\rauthor = {Knapp, Brendan},\rtitle = {Functions},\rurl = {https://knapply.com/post/functions/},\ryear = 2018,\rmonth = Nov,\rday = 1,\r}\r\r",
    "date": 1541030400,
    "expirydate": -62135596800,
    "kind": "page",
    "lang": "en",
    "lastmod": 1541630964,
    "objectID": "9a8dc953cedc3c6d3389666dd0d1022d",
    "permalink": "/post/functions/",
    "publishdate": "2018-11-01T00:00:00Z",
    "relpermalink": "/post/functions/",
    "section": "post",
    "summary": "Defining functions in R, Python, and C++/Rcpp.",
    "tags": [
      "r",
      "python",
      "cpp",
      "tutorial",
      "programming"
    ],
    "title": "Functions",
    "type": "post"
  },
  {
    "authors": null,
    "categories": [
      "data-carpentry",
      "Python",
      "R",
      "tutorial"
    ],
    "content": "\r\rSet Up\rData\rSubset Columns\rBasic Example: Select Columns by Name\rDrop Columns by Name\rSelect Columns by Name Range\rDrop Columns by Name Range\rSelect Columns by Index Range\rDrop Columns by Index Range\r\rSubset Rows\rFilter Rows, Single Logical Comparison\rFilter Rows, Multiple Logical Comparisons\r\rTransform Column Values\rBasic Example: Calculate Population in Thousands\rCalculate Total GDP\rCalculate Z Scores of 1977 GDP per Capita\r\rEnvironment\r\r\r--\r\u0026lt;!-- \u0026lt;link rel=\u0026quot;stylesheet\u0026quot; href=\u0026quot;{{ .Site.BaseURL }}/css/style.css\u0026quot; /\u0026gt; --\u0026gt;\r--\rSet Up\rData Frame Packages\rlibrary(tidyverse) # includes {dplyr}\rimport pandas as pd\r\r\rData\rlibrary(gapminder)\r(df \u0026lt;- gapminder %\u0026gt;% rename(population = pop)) # pandas uses pop() as a method\r## # A tibble: 1,704 x 6\r## country continent year lifeExp population gdpPercap\r## \u0026lt;fct\u0026gt; \u0026lt;fct\u0026gt; \u0026lt;int\u0026gt; \u0026lt;dbl\u0026gt; \u0026lt;int\u0026gt; \u0026lt;dbl\u0026gt;\r## 1 Afghanistan Asia 1952 28.8 8425333 779.\r## 2 Afghanistan Asia 1957 30.3 9240934 821.\r## 3 Afghanistan Asia 1962 32.0 10267083 853.\r## 4 Afghanistan Asia 1967 34.0 11537966 836.\r## 5 Afghanistan Asia 1972 36.1 13079460 740.\r## 6 Afghanistan Asia 1977 38.4 14880372 786.\r## 7 Afghanistan Asia 1982 39.9 12881816 978.\r## 8 Afghanistan Asia 1987 40.8 13867957 852.\r## 9 Afghanistan Asia 1992 41.7 16317921 649.\r## 10 Afghanistan Asia 1997 41.8 22227415 635.\r## # ... with 1,694 more rows\rdf = r.df #.round(4)\r#\rprint(df.head(10))\r## country continent year lifeExp population gdpPercap\r## 0 Afghanistan Asia 1952 28.801 8425333 779.445314\r## 1 Afghanistan Asia 1957 30.332 9240934 820.853030\r## 2 Afghanistan Asia 1962 31.997 10267083 853.100710\r## 3 Afghanistan Asia 1967 34.020 11537966 836.197138\r## 4 Afghanistan Asia 1972 36.088 13079460 739.981106\r## 5 Afghanistan Asia 1977 38.438 14880372 786.113360\r## 6 Afghanistan Asia 1982 39.854 12881816 978.011439\r## 7 Afghanistan Asia 1987 40.822 13867957 852.395945\r## 8 Afghanistan Asia 1992 41.674 16317921 649.341395\r## 9 Afghanistan Asia 1997 41.763 22227415 635.341351\r\rSubset Columns\rBasic Example: Select Columns by Name\rdf %\u0026gt;% select(country, population)\r## # A tibble: 1,704 x 2\r## country population\r## \u0026lt;fct\u0026gt; \u0026lt;int\u0026gt;\r## 1 Afghanistan 8425333\r## 2 Afghanistan 9240934\r## 3 Afghanistan 10267083\r## 4 Afghanistan 11537966\r## 5 Afghanistan 13079460\r## 6 Afghanistan 14880372\r## 7 Afghanistan 12881816\r## 8 Afghanistan 13867957\r## 9 Afghanistan 16317921\r## 10 Afghanistan 22227415\r## # ... with 1,694 more rows\rres = df[[\u0026#39;country\u0026#39;, \u0026#39;population\u0026#39;]]\r#\rprint(res.head(10))\r## country population\r## 0 Afghanistan 8425333\r## 1 Afghanistan 9240934\r## 2 Afghanistan 10267083\r## 3 Afghanistan 11537966\r## 4 Afghanistan 13079460\r## 5 Afghanistan 14880372\r## 6 Afghanistan 12881816\r## 7 Afghanistan 13867957\r## 8 Afghanistan 16317921\r## 9 Afghanistan 22227415\r\rDrop Columns by Name\rdf %\u0026gt;% select(-country, -population)\r## # A tibble: 1,704 x 4\r## continent year lifeExp gdpPercap\r## \u0026lt;fct\u0026gt; \u0026lt;int\u0026gt; \u0026lt;dbl\u0026gt; \u0026lt;dbl\u0026gt;\r## 1 Asia 1952 28.8 779.\r## 2 Asia 1957 30.3 821.\r## 3 Asia 1962 32.0 853.\r## 4 Asia 1967 34.0 836.\r## 5 Asia 1972 36.1 740.\r## 6 Asia 1977 38.4 786.\r## 7 Asia 1982 39.9 978.\r## 8 Asia 1987 40.8 852.\r## 9 Asia 1992 41.7 649.\r## 10 Asia 1997 41.8 635.\r## # ... with 1,694 more rows\rres = df.drop([\u0026#39;country\u0026#39;, \u0026#39;population\u0026#39;], axis=1)\r#\rprint(res.head(10))\r## continent year lifeExp gdpPercap\r## 0 Asia 1952 28.801 779.445314\r## 1 Asia 1957 30.332 820.853030\r## 2 Asia 1962 31.997 853.100710\r## 3 Asia 1967 34.020 836.197138\r## 4 Asia 1972 36.088 739.981106\r## 5 Asia 1977 38.438 786.113360\r## 6 Asia 1982 39.854 978.011439\r## 7 Asia 1987 40.822 852.395945\r## 8 Asia 1992 41.674 649.341395\r## 9 Asia 1997 41.763 635.341351\r\rSelect Columns by Name Range\rdf %\u0026gt;% select(lifeExp:gdpPercap)\r## # A tibble: 1,704 x 3\r## lifeExp population gdpPercap\r## \u0026lt;dbl\u0026gt; \u0026lt;int\u0026gt; \u0026lt;dbl\u0026gt;\r## 1 28.8 8425333 779.\r## 2 30.3 9240934 821.\r## 3 32.0 10267083 853.\r## 4 34.0 11537966 836.\r## 5 36.1 13079460 740.\r## 6 38.4 14880372 786.\r## 7 39.9 12881816 978.\r## 8 40.8 13867957 852.\r## 9 41.7 16317921 649.\r## 10 41.8 22227415 635.\r## # ... with 1,694 more rows\rres = df.loc[:, \u0026#39;lifeExp\u0026#39;:\u0026#39;gdpPercap\u0026#39;]\r#\rprint(res.head(10))\r## lifeExp population gdpPercap\r## 0 28.801 8425333 779.445314\r## 1 30.332 9240934 820.853030\r## 2 31.997 10267083 853.100710\r## 3 34.020 11537966 836.197138\r## 4 36.088 13079460 739.981106\r## 5 38.438 14880372 786.113360\r## 6 39.854 12881816 978.011439\r## 7 40.822 13867957 852.395945\r## 8 41.674 16317921 649.341395\r## 9 41.763 22227415 635.341351\r\rDrop Columns by Name Range\rdf %\u0026gt;% select(-(lifeExp:gdpPercap))\r## # A tibble: 1,704 x 3\r## country continent year\r## \u0026lt;fct\u0026gt; \u0026lt;fct\u0026gt; \u0026lt;int\u0026gt;\r## 1 Afghanistan Asia 1952\r## 2 Afghanistan Asia 1957\r## 3 Afghanistan Asia 1962\r## 4 Afghanistan Asia 1967\r## 5 Afghanistan Asia 1972\r## 6 Afghanistan Asia 1977\r## 7 Afghanistan Asia 1982\r## 8 Afghanistan Asia 1987\r## 9 Afghanistan Asia 1992\r## 10 Afghanistan Asia 1997\r## # ... with 1,694 more rows\r# there has to be a better way...\rres = df.drop(df.loc[:, \u0026#39;lifeExp\u0026#39;:\u0026#39;gdpPercap\u0026#39;].head(0).columns, axis=1)\r#\rprint(res.head(10))\r## country continent year\r## 0 Afghanistan Asia 1952\r## 1 Afghanistan Asia 1957\r## 2 Afghanistan Asia 1962\r## 3 Afghanistan Asia 1967\r## 4 Afghanistan Asia 1972\r## 5 Afghanistan Asia 1977\r## 6 Afghanistan Asia 1982\r## 7 Afghanistan Asia 1987\r## 8 Afghanistan Asia 1992\r## 9 Afghanistan Asia 1997\r\rSelect Columns by Index Range\rdf %\u0026gt;% select(2:4)\r## # A tibble: 1,704 x 3\r## continent year lifeExp\r## \u0026lt;fct\u0026gt; \u0026lt;int\u0026gt; \u0026lt;dbl\u0026gt;\r## 1 Asia 1952 28.8\r## 2 Asia 1957 30.3\r## 3 Asia 1962 32.0\r## 4 Asia 1967 34.0\r## 5 Asia 1972 36.1\r## 6 Asia 1977 38.4\r## 7 Asia 1982 39.9\r## 8 Asia 1987 40.8\r## 9 Asia 1992 41.7\r## 10 Asia 1997 41.8\r## # ... with 1,694 more rows\rres = df[df.columns[1:4]]\r#\rprint(res.head(10))\r## continent year lifeExp\r## 0 Asia 1952 28.801\r## 1 Asia 1957 30.332\r## 2 Asia 1962 31.997\r## 3 Asia 1967 34.020\r## 4 Asia 1972 36.088\r## 5 Asia 1977 38.438\r## 6 Asia 1982 39.854\r## 7 Asia 1987 40.822\r## 8 Asia 1992 41.674\r## 9 Asia 1997 41.763\r\rDrop Columns by Index Range\rdf %\u0026gt;% select(-(2:4))\r## # A tibble: 1,704 x 3\r## country population gdpPercap\r## \u0026lt;fct\u0026gt; \u0026lt;int\u0026gt; \u0026lt;dbl\u0026gt;\r## 1 Afghanistan 8425333 779.\r## 2 Afghanistan 9240934 821.\r## 3 Afghanistan 10267083 853.\r## 4 Afghanistan 11537966 836.\r## 5 Afghanistan 13079460 740.\r## 6 Afghanistan 14880372 786.\r## 7 Afghanistan 12881816 978.\r## 8 Afghanistan 13867957 852.\r## 9 Afghanistan 16317921 649.\r## 10 Afghanistan 22227415 635.\r## # ... with 1,694 more rows\rres = df.drop(df.columns[1:4], axis = 1)\r#\rprint(res.head(10))\r## country population gdpPercap\r## 0 Afghanistan 8425333 779.445314\r## 1 Afghanistan 9240934 820.853030\r## 2 Afghanistan 10267083 853.100710\r## 3 Afghanistan 11537966 836.197138\r## 4 Afghanistan 13079460 739.981106\r## 5 Afghanistan 14880372 786.113360\r## 6 Afghanistan 12881816 978.011439\r## 7 Afghanistan 13867957 852.395945\r## 8 Afghanistan 16317921 649.341395\r## 9 Afghanistan 22227415 635.341351\r\r\rSubset Rows\rFilter Rows, Single Logical Comparison\rdf %\u0026gt;% filter(gdpPercap \u0026lt; 500)\r## # A tibble: 63 x 6\r## country continent year lifeExp population gdpPercap\r## \u0026lt;fct\u0026gt; \u0026lt;fct\u0026gt; \u0026lt;int\u0026gt; \u0026lt;dbl\u0026gt; \u0026lt;int\u0026gt; \u0026lt;dbl\u0026gt;\r## 1 Burundi Africa 1952 39.0 2445618 339.\r## 2 Burundi Africa 1957 40.5 2667518 380.\r## 3 Burundi Africa 1962 42.0 2961915 355.\r## 4 Burundi Africa 1967 43.5 3330989 413.\r## 5 Burundi Africa 1972 44.1 3529983 464.\r## 6 Burundi Africa 1997 45.3 6121610 463.\r## 7 Burundi Africa 2002 47.4 7021078 446.\r## 8 Burundi Africa 2007 49.6 8390505 430.\r## 9 Cambodia Asia 1952 39.4 4693836 368.\r## 10 Cambodia Asia 1957 41.4 5322536 434.\r## # ... with 53 more rows\rres = df[df.gdpPercap \u0026lt; 500]\r#\rprint(res.head(10))\r## country continent year lifeExp population gdpPercap\r## 204 Burundi Africa 1952 39.031 2445618 339.296459\r## 205 Burundi Africa 1957 40.533 2667518 379.564628\r## 206 Burundi Africa 1962 42.045 2961915 355.203227\r## 207 Burundi Africa 1967 43.548 3330989 412.977514\r## 208 Burundi Africa 1972 44.057 3529983 464.099504\r## 213 Burundi Africa 1997 45.326 6121610 463.115148\r## 214 Burundi Africa 2002 47.360 7021078 446.403513\r## 215 Burundi Africa 2007 49.580 8390505 430.070692\r## 216 Cambodia Asia 1952 39.417 4693836 368.469286\r## 217 Cambodia Asia 1957 41.366 5322536 434.038336\r\rFilter Rows, Multiple Logical Comparisons\rdf %\u0026gt;% filter(year \u0026gt; 1990, lifeExp \u0026lt; 40)\r## # A tibble: 8 x 6\r## country continent year lifeExp population gdpPercap\r## \u0026lt;fct\u0026gt; \u0026lt;fct\u0026gt; \u0026lt;int\u0026gt; \u0026lt;dbl\u0026gt; \u0026lt;int\u0026gt; \u0026lt;dbl\u0026gt;\r## 1 Rwanda Africa 1992 23.6 7290203 737.\r## 2 Rwanda Africa 1997 36.1 7212583 590.\r## 3 Sierra Leone Africa 1992 38.3 4260884 1069.\r## 4 Sierra Leone Africa 1997 39.9 4578212 575.\r## 5 Somalia Africa 1992 39.7 6099799 927.\r## 6 Swaziland Africa 2007 39.6 1133066 4513.\r## 7 Zambia Africa 2002 39.2 10595811 1072.\r## 8 Zimbabwe Africa 2002 40.0 11926563 672.\rres = df[(df.year \u0026gt; 1990) \u0026amp; (df.lifeExp \u0026lt; 40)]\r#\rprint(res.head(10))\r## country continent ... population gdpPercap\r## 1292 Rwanda Africa ... 7290203 737.068595\r## 1293 Rwanda Africa ... 7212583 589.944505\r## 1352 Sierra Leone Africa ... 4260884 1068.696278\r## 1353 Sierra Leone Africa ... 4578212 574.648158\r## 1400 Somalia Africa ... 6099799 926.960296\r## 1463 Swaziland Africa ... 1133066 4513.480643\r## 1690 Zambia Africa ... 10595811 1071.613938\r## 1702 Zimbabwe Africa ... 11926563 672.038623\r## ## [8 rows x 6 columns]\rdf %\u0026gt;% filter(population \u0026lt; 10000 | gdpPercap \u0026gt; 100000)\r## # A tibble: 3 x 6\r## country continent year lifeExp population gdpPercap\r## \u0026lt;fct\u0026gt; \u0026lt;fct\u0026gt; \u0026lt;int\u0026gt; \u0026lt;dbl\u0026gt; \u0026lt;int\u0026gt; \u0026lt;dbl\u0026gt;\r## 1 Kuwait Asia 1952 55.6 160000 108382.\r## 2 Kuwait Asia 1957 58.0 212846 113523.\r## 3 Kuwait Asia 1972 67.7 841934 109348.\rres = df[(df.population \u0026lt; 10000) | (df.gdpPercap \u0026gt; 100000)]\r#\rprint(res.head(10))\r## country continent year lifeExp population gdpPercap\r## 852 Kuwait Asia 1952 55.565 160000 108382.3529\r## 853 Kuwait Asia 1957 58.033 212846 113523.1329\r## 856 Kuwait Asia 1972 67.712 841934 109347.8670\rdf %\u0026gt;% filter(year == 1997 \u0026amp; continent == \u0026quot;Europe\u0026quot;) # dplyr can use either `,` or `\u0026amp;` for \u0026quot;and\u0026quot;\r## # A tibble: 30 x 6\r## country continent year lifeExp population gdpPercap\r## \u0026lt;fct\u0026gt; \u0026lt;fct\u0026gt; \u0026lt;int\u0026gt; \u0026lt;dbl\u0026gt; \u0026lt;int\u0026gt; \u0026lt;dbl\u0026gt;\r## 1 Albania Europe 1997 73.0 3428038 3193.\r## 2 Austria Europe 1997 77.5 8069876 29096.\r## 3 Belgium Europe 1997 77.5 10199787 27561.\r## 4 Bosnia and Herzegovina Europe 1997 73.2 3607000 4766.\r## 5 Bulgaria Europe 1997 70.3 8066057 5970.\r## 6 Croatia Europe 1997 73.7 4444595 9876.\r## 7 Czech Republic Europe 1997 74.0 10300707 16049.\r## 8 Denmark Europe 1997 76.1 5283663 29804.\r## 9 Finland Europe 1997 77.1 5134406 23724.\r## 10 France Europe 1997 78.6 58623428 25890.\r## # ... with 20 more rows\rres = df[(df.year == 1997) \u0026amp; (df.continent == \u0026quot;Europe\u0026quot;)]\r#\rprint(res.head(10))\r## country continent ... population gdpPercap\r## 21 Albania Europe ... 3428038 3193.054604\r## 81 Austria Europe ... 8069876 29095.920660\r## 117 Belgium Europe ... 10199787 27561.196630\r## 153 Bosnia and Herzegovina Europe ... 3607000 4766.355904\r## 189 Bulgaria Europe ... 8066057 5970.388760\r## 381 Croatia Europe ... 4444595 9875.604515\r## 405 Czech Republic Europe ... 10300707 16048.514240\r## 417 Denmark Europe ... 5283663 29804.345670\r## 525 Finland Europe ... 5134406 23723.950200\r## 537 France Europe ... 58623428 25889.784870\r## ## [10 rows x 6 columns]\r\r\rTransform Column Values\rBasic Example: Calculate Population in Thousands\rdf %\u0026gt;% select(population) %\u0026gt;% mutate(pop_in_thousands = population / 1000) \r## # A tibble: 1,704 x 2\r## population pop_in_thousands\r## \u0026lt;int\u0026gt; \u0026lt;dbl\u0026gt;\r## 1 8425333 8425.\r## 2 9240934 9241.\r## 3 10267083 10267.\r## 4 11537966 11538.\r## 5 13079460 13079.\r## 6 14880372 14880.\r## 7 12881816 12882.\r## 8 13867957 13868.\r## 9 16317921 16318.\r## 10 22227415 22227.\r## # ... with 1,694 more rows\rres = df[[\u0026#39;population\u0026#39;]].assign(pop_in_thousands = df.population / 1000)\r#\rprint(res.head(10))\r## population pop_in_thousands\r## 0 8425333 8425.333\r## 1 9240934 9240.934\r## 2 10267083 10267.083\r## 3 11537966 11537.966\r## 4 13079460 13079.460\r## 5 14880372 14880.372\r## 6 12881816 12881.816\r## 7 13867957 13867.957\r## 8 16317921 16317.921\r## 9 22227415 22227.415\r\rCalculate Total GDP\rdf %\u0026gt;%\rselect(population, gdpPercap) %\u0026gt;% mutate(total_GDP = population * gdpPercap)\r## # A tibble: 1,704 x 3\r## population gdpPercap total_GDP\r## \u0026lt;int\u0026gt; \u0026lt;dbl\u0026gt; \u0026lt;dbl\u0026gt;\r## 1 8425333 779. 6567086330.\r## 2 9240934 821. 7585448670.\r## 3 10267083 853. 8758855797.\r## 4 11537966 836. 9648014150.\r## 5 13079460 740. 9678553274.\r## 6 14880372 786. 11697659231.\r## 7 12881816 978. 12598563401.\r## 8 13867957 852. 11820990309.\r## 9 16317921 649. 10595901589.\r## 10 22227415 635. 14121995875.\r## # ... with 1,694 more rows\rres = df[[\u0026#39;population\u0026#39;, \u0026#39;gdpPercap\u0026#39;]].assign(total_GDP = df.population * df.gdpPercap)\r#\rprint(res.head(10))\r## population gdpPercap total_GDP\r## 0 8425333 779.445314 6.567086e+09\r## 1 9240934 820.853030 7.585449e+09\r## 2 10267083 853.100710 8.758856e+09\r## 3 11537966 836.197138 9.648014e+09\r## 4 13079460 739.981106 9.678553e+09\r## 5 14880372 786.113360 1.169766e+10\r## 6 12881816 978.011439 1.259856e+10\r## 7 13867957 852.395945 1.182099e+10\r## 8 16317921 649.341395 1.059590e+10\r## 9 22227415 635.341351 1.412200e+10\r\rCalculate Z Scores of 1977 GDP per Capita\r\\[ z = \\frac {x_i -\\mu_x} {\\sigma_x}\\]\n\r\\(x\\) = gdpPercap\r\\(\\mu_x\\) = the mean of \\(x\\) = mean(gdpPercap) or gdpPercap.mean()\r\\(\\sigma_x\\) = the standard deviation of x = sd(gdpPercap) or gdpPercap.std()\r\rdf %\u0026gt;% filter(year == 1977) %\u0026gt;%\rselect(gdpPercap) %\u0026gt;% mutate(gdp_per_cap_z_score = (gdpPercap - mean(gdpPercap)) / sd(gdpPercap))\r## # A tibble: 142 x 2\r## gdpPercap gdp_per_cap_z_score\r## \u0026lt;dbl\u0026gt; \u0026lt;dbl\u0026gt;\r## 1 786. -0.781\r## 2 3533. -0.452\r## 3 4910. -0.287\r## 4 3009. -0.515\r## 5 10079. 0.331\r## 6 18334. 1.32 ## 7 19749. 1.49 ## 8 19340. 1.44 ## 9 660. -0.796\r## 10 19118. 1.41 ## # ... with 132 more rows\rdf_1977 = df[df.year == 1977][[\u0026#39;gdpPercap\u0026#39;]] # intermediate assignment\r#\rres = df_1977.assign(gdp_per_cap_z_score = (df_1977.gdpPercap - df_1977.gdpPercap.mean()) / df_1977.gdpPercap.std())\r#\rprint(res.head(10))\r## gdpPercap gdp_per_cap_z_score\r## 5 786.113360 -0.780516\r## 17 3533.003910 -0.452038\r## 29 4910.416756 -0.287325\r## 41 3008.647355 -0.514741\r## 53 10079.026740 0.330746\r## 65 18334.197510 1.317913\r## 77 19749.422300 1.487148\r## 89 19340.101960 1.438200\r## 101 659.877232 -0.795611\r## 113 19117.974480 1.411638\r\rالنهاية\n\r\r\rEnvironment\rprint(sys.version)\r## 3.6.5 |Anaconda, Inc.| (default, Mar 29 2018, 13:32:41) [MSC v.1900 64 bit (AMD64)]\rprint(pd.__version__)\r## 0.23.4\rsessionInfo()\r## R version 3.5.1 (2018-07-02)\r## Platform: x86_64-w64-mingw32/x64 (64-bit)\r## Running under: Windows 10 x64 (build 17134)\r## ## Matrix products: default\r## ## locale:\r## [1] LC_COLLATE=English_United States.1252 ## [2] LC_CTYPE=English_United States.1252 ## [3] LC_MONETARY=English_United States.1252\r## [4] LC_NUMERIC=C ## [5] LC_TIME=English_United States.1252 ## ## attached base packages:\r## [1] stats graphics grDevices utils datasets methods base ## ## other attached packages:\r## [1] gapminder_0.3.0 kableExtra_0.9.0 forcats_0.3.0 ## [4] stringr_1.3.1.9000 dplyr_0.7.99.9000 purrr_0.2.4.9000 ## [7] readr_1.1.1 tidyr_0.8.1.9000 tibble_1.4.2 ## [10] ggplot2_3.1.0.9000 tidyverse_1.2.1.9000 reticulate_1.10.0.9002\r## ## loaded via a namespace (and not attached):\r## [1] tidyselect_0.2.5 xfun_0.4 haven_1.1.2.9000 ## [4] lattice_0.20-35 colorspace_1.3-2 generics_0.0.1.9000 ## [7] viridisLite_0.3.0 htmltools_0.3.6 yaml_2.2.0 ## [10] utf8_1.1.4 rlang_0.3.0.9000 pillar_1.3.0.9000 ## [13] glue_1.3.0 withr_2.1.2.9000 modelr_0.1.2 ## [16] readxl_1.1.0 plyr_1.8.4 munsell_0.5.0 ## [19] blogdown_0.9.1 gtable_0.2.0 cellranger_1.1.0 ## [22] rvest_0.3.2 evaluate_0.12 knitr_1.20.21 ## [25] fansi_0.3.0 broom_0.5.0.9001 Rcpp_1.0.0 ## [28] backports_1.1.2 scales_1.0.0.9000 jsonlite_1.5 ## [31] hms_0.4.2 digest_0.6.18 stringi_1.2.4 ## [34] bookdown_0.7.21 grid_3.5.1 cli_1.0.1 ## [37] tools_3.5.1 magrittr_1.5 lazyeval_0.2.1 ## [40] crayon_1.3.4 pkgconfig_2.0.2 Matrix_1.2-14 ## [43] xml2_1.2.0 lubridate_1.7.4 assertthat_0.2.0 ## [46] rmarkdown_1.10.14 httr_1.3.1 rstudioapi_0.8.0.9000\r## [49] htmldeps_0.1.1 R6_2.3.0 compiler_3.5.1\r\r",
    "date": 1532390400,
    "expirydate": -62135596800,
    "kind": "page",
    "lang": "en",
    "lastmod": 1543265254,
    "objectID": "332ad974cc310c3aa12846ba5f71bd6e",
    "permalink": "/post/data-frame-operations/",
    "publishdate": "2018-07-24T00:00:00Z",
    "relpermalink": "/post/data-frame-operations/",
    "section": "post",
    "summary": "Essential Data Frame Operations in Python (w/ pandas) and R (with dplyr).",
    "tags": [
      "dplyr",
      "pandas"
    ],
    "title": "Data Frame Operations Thesaurus",
    "type": "post"
  },
  {
    "authors": null,
    "categories": [
      "R",
      "data-carpentry",
      "tutorial"
    ],
    "content": "\r\r\rContext\rReflection\rResources Up Front\rtibble\r%\u0026gt;%\r“Tidy” Data\rselect() columns\rfilter() Rows\rmutate() Columns\rarrange() Rows\rgroup_by() for Grouped Data\rsummarize()\r\r\r\nConsidering this is a blog post, I’m going to get all bloggy here before jumping into the code.\nContext\rI recently had the opportunity to teach some R coding to colleagues and classmates in a series of workshops. Some had already dabbled in R or other programming languages, but it was the first time that the majority of participants had written a single line of code.\nA few things happened in the week following the last session that I didn’t expect.\nFirst, I saw a bit of R code written on a campus whiteboard that had nothing to do with me, but was straight out of the workshop. It may have come from some of my data-centric colleagues who use R, so I didn’t think too much of it.\nThen, I overheard a conversation involving R from those in a program that doesn’t require any data-related coursework. Many folks are familiar with the name as the school’s primary data analysis course uses the {Rcmdr} GUI for statistical analysis, but these students would not have necessarily taken the course. I wondered if there was a connection.\nFinally, a student who didn’t even attend came to my office hours asking for resources. Why exactly? Some of his work colleagues attended. It turns out that they are now trying to incorporate some R-powered analysis in their work and he doesn’t want to miss out.\nThe workshop consisted of 3 consecutive Fridays lasting 90 minutes each. That’s only a total of 4.5 hours.\nThat’s relatively tiny amount of time.\nWait. Scratch that.\nThat’s a negligible amount of time.\n… but it was enough to convince some participants and non-participants that they should take advantage of the power that a bit of data-centric coding can offer.\n\rReflection\rI taught a similar 90 minute workshop last spring using R, but focused on base R and a few data types. 10 minutes in, I’m trying to explain the difference between a data.frame and a matrix and the person asking the question says something along the lines of “I guess I’m kinda dumb. Don’t worry about it.”\nFor context, these were international policy graduate students. While some have completed a bit of quantitative coursework, most don’t have a hardcore math or science background and programming is seen as something akin to wizardry. However, they hold domain expertise in some rather important subjects. These include WMD nonproliferation, international development, economic diplomacy, conflict studies, and environmental policy. Nearly half of the participants were international students and everyone is proficient in at least a second natural language. Most have already tackled big, complicated problems in their careers and the others are on their way to doing so following graduation. In a nutshell, they’re not dumb. The way I was teaching was dumb. They knew that they’re supposed to want to learn new skills, but they didn’t know why. Focusing on the “basics” didn’t show them anything immediately useful. It didn’t show them the why.\nAfter the workshop, I never heard anyone mention R outside my circle of fellow data folks.\nSince that time, I started using R more. Like, a lot more. I have found a way to use R in nearly everything I’ve done since May 2017. As a policy student myself, that has not always been very straightforward and I was still avoiding the strange “tidy” code I’d encounter on Stack Overflow and elsewhere. I realized the error of my ways when I came across Julia Silge and David Robinson’s Text Mining with R. It was like discovering that you’re still in the stone age while most people are off partying on spaceships.\nIn preparation for this workshop series, I found a lot of inspiration in Michael Levy’s presentation on teaching R, which itself echoes principles preached by other tidyverse advocates.\nA huge takeaway: live coding works.\nWriting code in real time shows every single step we make from opening the IDE, to reshaping the data, to debugging inevitable errors, to rendering a final report.\nWithin a few short weeks of learning to code, it might be surprising how many tiny steps become automatic and taken for granted. Tack on a couple more months and newcomers will think you’re speaking in an entirely different language because you’re explaining something requiring context they simply haven’t yet encountered. Add a few years and… yeesh.\nSomething that frustrated me when I first started is that code explanations often seem to be written in such a way that dismisses how difficult establishing the basics can be. I’m half-convinced that, for some folks, the trauma was so great that they have simply blocked it from memory. Code is intimidating enough, but if an instructor doesn’t make a conscious effort to empathize, students will question their ability to learn. The goal is empowerment, not intimidation.\nLive coding enforces a maximum speed in moving through exercises, which not only gives students more time to digest what you’re doing. It also provides more opportunities for them to ask questions on details you might find trivial, but only because you already suffered through them.\nI also think that the benefits of live coding extend to the instructor as well. I found myself answering questions that framed things in ways that I had not even considered, but were exactly how multiple participants saw the task. Additionally, I have a better sense of which concepts need to be covered in more detail, as they weren’t necessarily as intuitive for others as they were for me. On the flip-side, concepts with which I remember struggling may not be difficult at all for others to understand.\n\n… and now that we got the bloggyness of a blog post out of the way…\nHere is the workflow I used for the first session. The goal was to introduce the primary {dplyr} verbs, functions that accomplish tasks necessary in nearly every project. Between each section is an exercise using {ggplot}.\n\n# install.packages(\u0026quot;tidyverse\u0026quot;)\rlibrary(tidyverse)\r# install.packages(\u0026quot;gapminder\u0026quot;)\rlibrary(gapminder)\r# loads the gapminder data set\r## just to prettify printed tables when knitting\r# install.packages(\u0026quot;kableExtra\u0026quot;)\rlibrary(knitr)\rlibrary(kableExtra)\rWorkflow\r\n\r\rResources Up Front\rData Carpentry\r \n\n\rCheat Sheet\r\r\n\n\rPlotting\r\n\rCheat Sheet\r\r\n\rR Graph Catalog\r\r\n\rOur Data\rIn the following exercises, gm.data.frame will be used to demonstrate actions that use {base} R methods for data.frame operations while gm_df will be used to to demonstrate {tidyverse} methods for tibble operations.\ngm.data.frame \u0026lt;- as.data.frame(gapminder)\rgm_df \u0026lt;- gapminder\r\r\rtibble\rclass(gm.data.frame)\r## [1] \u0026quot;data.frame\u0026quot;\rclass(gm_df)\r## [1] \u0026quot;tbl_df\u0026quot; \u0026quot;tbl\u0026quot; \u0026quot;data.frame\u0026quot;\rtibbles are opinionated data.frames that keep everything that is helpful about data.frames, changes some of their quirks, and adds methods that makes them even more useful.\nPrinting gm.data.frame dumps the whole data set to the console, typically requiring head() to limit the output.\nPrinting\rhead(gm.data.frame)\r## country continent year lifeExp pop gdpPercap\r## 1 Afghanistan Asia 1952 28.801 8425333 779.4453\r## 2 Afghanistan Asia 1957 30.332 9240934 820.8530\r## 3 Afghanistan Asia 1962 31.997 10267083 853.1007\r## 4 Afghanistan Asia 1967 34.020 11537966 836.1971\r## 5 Afghanistan Asia 1972 36.088 13079460 739.9811\r## 6 Afghanistan Asia 1977 38.438 14880372 786.1134\rPrinting gm_df provides the dimensions, data type of each column, and only prints the first 10 rows.\ngm_df\r## # A tibble: 1,704 x 6\r## country continent year lifeExp pop gdpPercap\r## \u0026lt;fct\u0026gt; \u0026lt;fct\u0026gt; \u0026lt;int\u0026gt; \u0026lt;dbl\u0026gt; \u0026lt;int\u0026gt; \u0026lt;dbl\u0026gt;\r## 1 Afghanistan Asia 1952 28.8 8425333 779.\r## 2 Afghanistan Asia 1957 30.3 9240934 821.\r## 3 Afghanistan Asia 1962 32.0 10267083 853.\r## 4 Afghanistan Asia 1967 34.0 11537966 836.\r## 5 Afghanistan Asia 1972 36.1 13079460 740.\r## 6 Afghanistan Asia 1977 38.4 14880372 786.\r## 7 Afghanistan Asia 1982 39.9 12881816 978.\r## 8 Afghanistan Asia 1987 40.8 13867957 852.\r## 9 Afghanistan Asia 1992 41.7 16317921 649.\r## 10 Afghanistan Asia 1997 41.8 22227415 635.\r## # ... with 1,694 more rows\r\r\r%\u0026gt;%\r\nThe pipe (%\u0026gt;%) is used to chain operations together. Underneath the hood, it’s taking the value on the left-hand side of %\u0026gt;% and using it as the first argument of the function on the right-hand side of %\u0026gt;%.\nFor example, these 2 lines are doing the exact same thing.\nhead(gm_df)\r## # A tibble: 6 x 6\r## country continent year lifeExp pop gdpPercap\r## \u0026lt;fct\u0026gt; \u0026lt;fct\u0026gt; \u0026lt;int\u0026gt; \u0026lt;dbl\u0026gt; \u0026lt;int\u0026gt; \u0026lt;dbl\u0026gt;\r## 1 Afghanistan Asia 1952 28.8 8425333 779.\r## 2 Afghanistan Asia 1957 30.3 9240934 821.\r## 3 Afghanistan Asia 1962 32.0 10267083 853.\r## 4 Afghanistan Asia 1967 34.0 11537966 836.\r## 5 Afghanistan Asia 1972 36.1 13079460 740.\r## 6 Afghanistan Asia 1977 38.4 14880372 786.\rgm_df %\u0026gt;% head()\r## # A tibble: 6 x 6\r## country continent year lifeExp pop gdpPercap\r## \u0026lt;fct\u0026gt; \u0026lt;fct\u0026gt; \u0026lt;int\u0026gt; \u0026lt;dbl\u0026gt; \u0026lt;int\u0026gt; \u0026lt;dbl\u0026gt;\r## 1 Afghanistan Asia 1952 28.8 8425333 779.\r## 2 Afghanistan Asia 1957 30.3 9240934 821.\r## 3 Afghanistan Asia 1962 32.0 10267083 853.\r## 4 Afghanistan Asia 1967 34.0 11537966 836.\r## 5 Afghanistan Asia 1972 36.1 13079460 740.\r## 6 Afghanistan Asia 1977 38.4 14880372 786.\rFor simple operations involving 1 function, %\u0026gt;% is only (arguably) beneficial in that it improves readability as the flow of operations go from left to right.\n%\u0026gt;% become truly useful when you need to perform multiple operations in succession, which is the vast majority of data carpentry.\nAs an arbitrary example, let’s say that we want to select the head() (first 6 rows) of gm.data.frame and convert it to a tibble.\nWithout %\u0026gt;%, we can do this in a few ways.\nUse intermediate variables.\r\rget gm.data.frame’s head() and assign it to no_pipe_1\rconvert no_pipe_1 to a tibble with as_tibble() and assign it to no_pipe_2\r\r\rno_pipe_1 \u0026lt;- head(gm.data.frame)\rno_pipe_2 \u0026lt;- as_tibble(no_pipe_1)\rno_pipe_2\r## # A tibble: 6 x 6\r## country continent year lifeExp pop gdpPercap\r## * \u0026lt;fct\u0026gt; \u0026lt;fct\u0026gt; \u0026lt;int\u0026gt; \u0026lt;dbl\u0026gt; \u0026lt;int\u0026gt; \u0026lt;dbl\u0026gt;\r## 1 Afghanistan Asia 1952 28.8 8425333 779.\r## 2 Afghanistan Asia 1957 30.3 9240934 821.\r## 3 Afghanistan Asia 1962 32.0 10267083 853.\r## 4 Afghanistan Asia 1967 34.0 11537966 836.\r## 5 Afghanistan Asia 1972 36.1 13079460 740.\r## 6 Afghanistan Asia 1977 38.4 14880372 786.\rNest gm.data.frame inside of head(), which is itself nested inside of as_tibble().\r\ras_tibble(head(gm.data.frame))\r## # A tibble: 6 x 6\r## country continent year lifeExp pop gdpPercap\r## * \u0026lt;fct\u0026gt; \u0026lt;fct\u0026gt; \u0026lt;int\u0026gt; \u0026lt;dbl\u0026gt; \u0026lt;int\u0026gt; \u0026lt;dbl\u0026gt;\r## 1 Afghanistan Asia 1952 28.8 8425333 779.\r## 2 Afghanistan Asia 1957 30.3 9240934 821.\r## 3 Afghanistan Asia 1962 32.0 10267083 853.\r## 4 Afghanistan Asia 1967 34.0 11537966 836.\r## 5 Afghanistan Asia 1972 36.1 13079460 740.\r## 6 Afghanistan Asia 1977 38.4 14880372 786.\rWith %\u0026gt;%, we can chain these actions together in the order in which they occur, which is also the way we read English.\n\rHere, we do the same thing by:\r\rtaking gm_df\rpiping it to head() (keeping the top 6 rows)\rpiping it to as_tibble() (converting it to a tibble data frame)\r\r\rgm_df %\u0026gt;% head() %\u0026gt;% as_tibble()\r## # A tibble: 6 x 6\r## country continent year lifeExp pop gdpPercap\r## \u0026lt;fct\u0026gt; \u0026lt;fct\u0026gt; \u0026lt;int\u0026gt; \u0026lt;dbl\u0026gt; \u0026lt;int\u0026gt; \u0026lt;dbl\u0026gt;\r## 1 Afghanistan Asia 1952 28.8 8425333 779.\r## 2 Afghanistan Asia 1957 30.3 9240934 821.\r## 3 Afghanistan Asia 1962 32.0 10267083 853.\r## 4 Afghanistan Asia 1967 34.0 11537966 836.\r## 5 Afghanistan Asia 1972 36.1 13079460 740.\r## 6 Afghanistan Asia 1977 38.4 14880372 786.\rIn practice, it’s usually best to place each of the functions on a separate line as it facilitates debugging and further improves readability.\ngm_df %\u0026gt;%\ras_tibble() %\u0026gt;%\rhead()\r## # A tibble: 6 x 6\r## country continent year lifeExp pop gdpPercap\r## \u0026lt;fct\u0026gt; \u0026lt;fct\u0026gt; \u0026lt;int\u0026gt; \u0026lt;dbl\u0026gt; \u0026lt;int\u0026gt; \u0026lt;dbl\u0026gt;\r## 1 Afghanistan Asia 1952 28.8 8425333 779.\r## 2 Afghanistan Asia 1957 30.3 9240934 821.\r## 3 Afghanistan Asia 1962 32.0 10267083 853.\r## 4 Afghanistan Asia 1967 34.0 11537966 836.\r## 5 Afghanistan Asia 1972 36.1 13079460 740.\r## 6 Afghanistan Asia 1977 38.4 14880372 786.\rFrom here on, you’ll notice prettify(). This is only being used to print tables in a clean format when the document is knit()ted.\nI’m choosing to include it here as I often find myself reading similar pages where I come across a really effective way to format some output. I understand why the author chooses to set echo=FALSE, but it can be nice to see the underlying code without having to hunt through their GitHub.\ndata.frames will print a default maximum of 3 rows while tibbles will print a default maximum of 10 rows.\nprettify \u0026lt;- function(df, n = NULL, cols_changed = NULL, rows_changed = NULL){\rif(is.null(n)) n \u0026lt;- ifelse(is.tibble(df), 10, 3)\rpretty_df \u0026lt;- df %\u0026gt;%\rhead(n) %\u0026gt;%\rkable(format = \u0026quot;html\u0026quot;) %\u0026gt;%\rkable_styling(bootstrap_options = c(\u0026quot;striped\u0026quot;, \u0026quot;bordered\u0026quot;, \u0026quot;condensed\u0026quot;,\r\u0026quot;hover\u0026quot;, \u0026quot;responsive\u0026quot;),\rfull_width = FALSE)\rif(!is.null(cols_changed)){\rpretty_df \u0026lt;- pretty_df %\u0026gt;%\rcolumn_spec(cols_changed, bold = T, color = \u0026quot;black\u0026quot;, background = \u0026quot;#C8FAE3\u0026quot;)\r}\rif(!is.null(rows_changed)){\rpretty_df \u0026lt;- pretty_df %\u0026gt;%\rrow_spec(rows_changed, bold = T, color = \u0026quot;black\u0026quot;, background = \u0026quot;#C8FAE3\u0026quot;)\r}\rreturn(pretty_df)\r}\rgm.data.frame %\u0026gt;%\rprettify()\r\r\rcountry\r\rcontinent\r\ryear\r\rlifeExp\r\rpop\r\rgdpPercap\r\r\r\r\r\rAfghanistan\r\rAsia\r\r1952\r\r28.801\r\r8425333\r\r779.4453\r\r\r\rAfghanistan\r\rAsia\r\r1957\r\r30.332\r\r9240934\r\r820.8530\r\r\r\rAfghanistan\r\rAsia\r\r1962\r\r31.997\r\r10267083\r\r853.1007\r\r\r\r\rgm_df %\u0026gt;%\rprettify()\r\r\rcountry\r\rcontinent\r\ryear\r\rlifeExp\r\rpop\r\rgdpPercap\r\r\r\r\r\rAfghanistan\r\rAsia\r\r1952\r\r28.801\r\r8425333\r\r779.4453\r\r\r\rAfghanistan\r\rAsia\r\r1957\r\r30.332\r\r9240934\r\r820.8530\r\r\r\rAfghanistan\r\rAsia\r\r1962\r\r31.997\r\r10267083\r\r853.1007\r\r\r\rAfghanistan\r\rAsia\r\r1967\r\r34.020\r\r11537966\r\r836.1971\r\r\r\rAfghanistan\r\rAsia\r\r1972\r\r36.088\r\r13079460\r\r739.9811\r\r\r\rAfghanistan\r\rAsia\r\r1977\r\r38.438\r\r14880372\r\r786.1134\r\r\r\rAfghanistan\r\rAsia\r\r1982\r\r39.854\r\r12881816\r\r978.0114\r\r\r\rAfghanistan\r\rAsia\r\r1987\r\r40.822\r\r13867957\r\r852.3959\r\r\r\rAfghanistan\r\rAsia\r\r1992\r\r41.674\r\r16317921\r\r649.3414\r\r\r\rAfghanistan\r\rAsia\r\r1997\r\r41.763\r\r22227415\r\r635.3414\r\r\r\r\rSample Data\rYou’ll also see a toy data set for the introductory examples that start each section.\nsample_countries \u0026lt;- c(\u0026quot;Tunisia\u0026quot;, \u0026quot;Nicaragua\u0026quot;, \u0026quot;Singapore\u0026quot;, \u0026quot;Hungary\u0026quot;,\r\u0026quot;New Zealand\u0026quot;, \u0026quot;Nigeria\u0026quot;, \u0026quot;Brazil\u0026quot;, \u0026quot;Sri Lanka\u0026quot;,\r\u0026quot;Ireland\u0026quot;, \u0026quot;Australia\u0026quot;)\rsample_df \u0026lt;- gm_df %\u0026gt;%\rfilter(year == 2007,\rcountry %in% sample_countries)\rsample_df %\u0026gt;% prettify()\r\r\rcountry\r\rcontinent\r\ryear\r\rlifeExp\r\rpop\r\rgdpPercap\r\r\r\r\r\rAustralia\r\rOceania\r\r2007\r\r81.235\r\r20434176\r\r34435.367\r\r\r\rBrazil\r\rAmericas\r\r2007\r\r72.390\r\r190010647\r\r9065.801\r\r\r\rHungary\r\rEurope\r\r2007\r\r73.338\r\r9956108\r\r18008.944\r\r\r\rIreland\r\rEurope\r\r2007\r\r78.885\r\r4109086\r\r40675.996\r\r\r\rNew Zealand\r\rOceania\r\r2007\r\r80.204\r\r4115771\r\r25185.009\r\r\r\rNicaragua\r\rAmericas\r\r2007\r\r72.899\r\r5675356\r\r2749.321\r\r\r\rNigeria\r\rAfrica\r\r2007\r\r46.859\r\r135031164\r\r2013.977\r\r\r\rSingapore\r\rAsia\r\r2007\r\r79.972\r\r4553009\r\r47143.180\r\r\r\rSri Lanka\r\rAsia\r\r2007\r\r72.396\r\r20378239\r\r3970.095\r\r\r\rTunisia\r\rAfrica\r\r2007\r\r73.923\r\r10276158\r\r7092.923\r\r\r\r\r\r\r“Tidy” Data\rIf you’re unsure of what “Tidy” data is actually describing and want to learn more, you can read Hadley Wickham’s article here. Otherwise, these graphics are likely the most concise explanation you’ll find.\nWith tibbles, %\u0026gt;%, and the concept of tidy data covered, let’s take a dive.\n{dplyr}\r{dplyr} provides a grammar of data manipulation and a set of verb functions that solve most common data carpentry challenges in a consistent fashion.\n\rglimpse()\rselect()\rfilter()\rarrange()\rmutate()\rsummarize()\rgroup_by()\r\r\rTaking a glimpse()\rIn addition to the summary(), dim()ensions, and str()ucture functions that can be used to inspect data, you can now use {dplyr}’s glimpse().\nsummary(gm.data.frame)\r## country continent year lifeExp ## Afghanistan: 12 Africa :624 Min. :1952 Min. :23.60 ## Albania : 12 Americas:300 1st Qu.:1966 1st Qu.:48.20 ## Algeria : 12 Asia :396 Median :1980 Median :60.71 ## Angola : 12 Europe :360 Mean :1980 Mean :59.47 ## Argentina : 12 Oceania : 24 3rd Qu.:1993 3rd Qu.:70.85 ## Australia : 12 Max. :2007 Max. :82.60 ## (Other) :1632 ## pop gdpPercap ## Min. :6.001e+04 Min. : 241.2 ## 1st Qu.:2.794e+06 1st Qu.: 1202.1 ## Median :7.024e+06 Median : 3531.8 ## Mean :2.960e+07 Mean : 7215.3 ## 3rd Qu.:1.959e+07 3rd Qu.: 9325.5 ## Max. :1.319e+09 Max. :113523.1 ## \rdim(gm.data.frame)\r## [1] 1704 6\rstr(gm.data.frame)\r## \u0026#39;data.frame\u0026#39;: 1704 obs. of 6 variables:\r## $ country : Factor w/ 142 levels \u0026quot;Afghanistan\u0026quot;,..: 1 1 1 1 1 1 1 1 1 1 ...\r## $ continent: Factor w/ 5 levels \u0026quot;Africa\u0026quot;,\u0026quot;Americas\u0026quot;,..: 3 3 3 3 3 3 3 3 3 3 ...\r## $ year : int 1952 1957 1962 1967 1972 1977 1982 1987 1992 1997 ...\r## $ lifeExp : num 28.8 30.3 32 34 36.1 ...\r## $ pop : int 8425333 9240934 10267083 11537966 13079460 14880372 12881816 13867957 16317921 22227415 ...\r## $ gdpPercap: num 779 821 853 836 740 ...\rglimpse(gm_df)\r## Observations: 1,704\r## Variables: 6\r## $ country \u0026lt;fct\u0026gt; Afghanistan, Afghanistan, Afghanistan, Afghanistan, ...\r## $ continent \u0026lt;fct\u0026gt; Asia, Asia, Asia, Asia, Asia, Asia, Asia, Asia, Asia...\r## $ year \u0026lt;int\u0026gt; 1952, 1957, 1962, 1967, 1972, 1977, 1982, 1987, 1992...\r## $ lifeExp \u0026lt;dbl\u0026gt; 28.801, 30.332, 31.997, 34.020, 36.088, 38.438, 39.8...\r## $ pop \u0026lt;int\u0026gt; 8425333, 9240934, 10267083, 11537966, 13079460, 1488...\r## $ gdpPercap \u0026lt;dbl\u0026gt; 779.4453, 820.8530, 853.1007, 836.1971, 739.9811, 78...\r\r\rselect() columns\rQuick Example\rInitial Data\rsample_df %\u0026gt;%\rprettify()\r\r\rcountry\r\rcontinent\r\ryear\r\rlifeExp\r\rpop\r\rgdpPercap\r\r\r\r\r\rAustralia\r\rOceania\r\r2007\r\r81.235\r\r20434176\r\r34435.367\r\r\r\rBrazil\r\rAmericas\r\r2007\r\r72.390\r\r190010647\r\r9065.801\r\r\r\rHungary\r\rEurope\r\r2007\r\r73.338\r\r9956108\r\r18008.944\r\r\r\rIreland\r\rEurope\r\r2007\r\r78.885\r\r4109086\r\r40675.996\r\r\r\rNew Zealand\r\rOceania\r\r2007\r\r80.204\r\r4115771\r\r25185.009\r\r\r\rNicaragua\r\rAmericas\r\r2007\r\r72.899\r\r5675356\r\r2749.321\r\r\r\rNigeria\r\rAfrica\r\r2007\r\r46.859\r\r135031164\r\r2013.977\r\r\r\rSingapore\r\rAsia\r\r2007\r\r79.972\r\r4553009\r\r47143.180\r\r\r\rSri Lanka\r\rAsia\r\r2007\r\r72.396\r\r20378239\r\r3970.095\r\r\r\rTunisia\r\rAfrica\r\r2007\r\r73.923\r\r10276158\r\r7092.923\r\r\r\r\r\rEnd Data\rsample_df %\u0026gt;%\rselect(country, pop) %\u0026gt;%\rprettify()\r\r\rcountry\r\rpop\r\r\r\r\r\rAustralia\r\r20434176\r\r\r\rBrazil\r\r190010647\r\r\r\rHungary\r\r9956108\r\r\r\rIreland\r\r4109086\r\r\r\rNew Zealand\r\r4115771\r\r\r\rNicaragua\r\r5675356\r\r\r\rNigeria\r\r135031164\r\r\r\rSingapore\r\r4553009\r\r\r\rSri Lanka\r\r20378239\r\r\r\rTunisia\r\r10276158\r\r\r\r\rThe select() family is used to choose columns to keep. You can use bare (unquoted) names.\n\rselect() columns by specific names.\r\rselect only gm_df’s country and pop columns\r\r\rgm_df %\u0026gt;%\rselect(country, year, pop) %\u0026gt;% # select columns by specific names\rprettify()\r\r\rcountry\r\ryear\r\rpop\r\r\r\r\r\rAfghanistan\r\r1952\r\r8425333\r\r\r\rAfghanistan\r\r1957\r\r9240934\r\r\r\rAfghanistan\r\r1962\r\r10267083\r\r\r\rAfghanistan\r\r1967\r\r11537966\r\r\r\rAfghanistan\r\r1972\r\r13079460\r\r\r\rAfghanistan\r\r1977\r\r14880372\r\r\r\rAfghanistan\r\r1982\r\r12881816\r\r\r\rAfghanistan\r\r1987\r\r13867957\r\r\r\rAfghanistan\r\r1992\r\r16317921\r\r\r\rAfghanistan\r\r1997\r\r22227415\r\r\r\r\r\rselect() a range of columns by name\r\rselect gm_df’s continent column and all columns from lifeExp to gdpPercap\r\r\rgm_df %\u0026gt;%\rselect(continent, lifeExp:gdpPercap) %\u0026gt;% # select columns name range\rprettify()\r\r\rcontinent\r\rlifeExp\r\rpop\r\rgdpPercap\r\r\r\r\r\rAsia\r\r28.801\r\r8425333\r\r779.4453\r\r\r\rAsia\r\r30.332\r\r9240934\r\r820.8530\r\r\r\rAsia\r\r31.997\r\r10267083\r\r853.1007\r\r\r\rAsia\r\r34.020\r\r11537966\r\r836.1971\r\r\r\rAsia\r\r36.088\r\r13079460\r\r739.9811\r\r\r\rAsia\r\r38.438\r\r14880372\r\r786.1134\r\r\r\rAsia\r\r39.854\r\r12881816\r\r978.0114\r\r\r\rAsia\r\r40.822\r\r13867957\r\r852.3959\r\r\r\rAsia\r\r41.674\r\r16317921\r\r649.3414\r\r\r\rAsia\r\r41.763\r\r22227415\r\r635.3414\r\r\r\r\r\rdeselect() a column with -\r\rselect() all of gm_df’s columns except lifeExp\r\r\rgm_df %\u0026gt;%\rselect(-lifeExp) %\u0026gt;% # deselect column by name\rprettify()\r\r\rcountry\r\rcontinent\r\ryear\r\rpop\r\rgdpPercap\r\r\r\r\r\rAfghanistan\r\rAsia\r\r1952\r\r8425333\r\r779.4453\r\r\r\rAfghanistan\r\rAsia\r\r1957\r\r9240934\r\r820.8530\r\r\r\rAfghanistan\r\rAsia\r\r1962\r\r10267083\r\r853.1007\r\r\r\rAfghanistan\r\rAsia\r\r1967\r\r11537966\r\r836.1971\r\r\r\rAfghanistan\r\rAsia\r\r1972\r\r13079460\r\r739.9811\r\r\r\rAfghanistan\r\rAsia\r\r1977\r\r14880372\r\r786.1134\r\r\r\rAfghanistan\r\rAsia\r\r1982\r\r12881816\r\r978.0114\r\r\r\rAfghanistan\r\rAsia\r\r1987\r\r13867957\r\r852.3959\r\r\r\rAfghanistan\r\rAsia\r\r1992\r\r16317921\r\r649.3414\r\r\r\rAfghanistan\r\rAsia\r\r1997\r\r22227415\r\r635.3414\r\r\r\r\r\rdeselect() a range of columns by name\r\rselect() all of gm_df’s columns except those between lifeExp and gdpPercap\r\r\rgm_df %\u0026gt;%\rselect(-c(lifeExp:gdpPercap)) %\u0026gt;% # deselect column by name range\rprettify()\r\r\rcountry\r\rcontinent\r\ryear\r\r\r\r\r\rAfghanistan\r\rAsia\r\r1952\r\r\r\rAfghanistan\r\rAsia\r\r1957\r\r\r\rAfghanistan\r\rAsia\r\r1962\r\r\r\rAfghanistan\r\rAsia\r\r1967\r\r\r\rAfghanistan\r\rAsia\r\r1972\r\r\r\rAfghanistan\r\rAsia\r\r1977\r\r\r\rAfghanistan\r\rAsia\r\r1982\r\r\r\rAfghanistan\r\rAsia\r\r1987\r\r\r\rAfghanistan\r\rAsia\r\r1992\r\r\r\rAfghanistan\r\rAsia\r\r1997\r\r\r\r\r\rselect() column by index\r\rselect() gm_df’s 4th column\r\r\rgm_df %\u0026gt;%\rselect(4) %\u0026gt;% # select column by index\rprettify()\r\r\rlifeExp\r\r\r\r\r\r28.801\r\r\r\r30.332\r\r\r\r31.997\r\r\r\r34.020\r\r\r\r36.088\r\r\r\r38.438\r\r\r\r39.854\r\r\r\r40.822\r\r\r\r41.674\r\r\r\r41.763\r\r\r\r\r\rdeselect() a column by index\r\rselect() all of gm_df’s columns except for the 4th column\r\r\rgm_df %\u0026gt;%\rselect(-4) %\u0026gt;% # deselect column by index\rprettify()\r\r\rcountry\r\rcontinent\r\ryear\r\rpop\r\rgdpPercap\r\r\r\r\r\rAfghanistan\r\rAsia\r\r1952\r\r8425333\r\r779.4453\r\r\r\rAfghanistan\r\rAsia\r\r1957\r\r9240934\r\r820.8530\r\r\r\rAfghanistan\r\rAsia\r\r1962\r\r10267083\r\r853.1007\r\r\r\rAfghanistan\r\rAsia\r\r1967\r\r11537966\r\r836.1971\r\r\r\rAfghanistan\r\rAsia\r\r1972\r\r13079460\r\r739.9811\r\r\r\rAfghanistan\r\rAsia\r\r1977\r\r14880372\r\r786.1134\r\r\r\rAfghanistan\r\rAsia\r\r1982\r\r12881816\r\r978.0114\r\r\r\rAfghanistan\r\rAsia\r\r1987\r\r13867957\r\r852.3959\r\r\r\rAfghanistan\r\rAsia\r\r1992\r\r16317921\r\r649.3414\r\r\r\rAfghanistan\r\rAsia\r\r1997\r\r22227415\r\r635.3414\r\r\r\r\r\rdeselect() a range of columns by index\r\rselect() all of gm_df’s columns except those between the 3rd and 5th columns\r\r\rgm_df %\u0026gt;%\rselect(-c(3:5)) %\u0026gt;% # deselect columns by index range\rprettify()\r\r\rcountry\r\rcontinent\r\rgdpPercap\r\r\r\r\r\rAfghanistan\r\rAsia\r\r779.4453\r\r\r\rAfghanistan\r\rAsia\r\r820.8530\r\r\r\rAfghanistan\r\rAsia\r\r853.1007\r\r\r\rAfghanistan\r\rAsia\r\r836.1971\r\r\r\rAfghanistan\r\rAsia\r\r739.9811\r\r\r\rAfghanistan\r\rAsia\r\r786.1134\r\r\r\rAfghanistan\r\rAsia\r\r978.0114\r\r\r\rAfghanistan\r\rAsia\r\r852.3959\r\r\r\rAfghanistan\r\rAsia\r\r649.3414\r\r\r\rAfghanistan\r\rAsia\r\r635.3414\r\r\r\r\r\r\rggplot() Exercise 1\r{ggplot2} is monster of a package used for data visualization that follows The Grammar of Graphics.\n{ggplot2} takes R’s powerful graphics capabilities and makes them more accessible by taking care of many plotting tasks that are often tedious, while still allowing for lower-level customization.\n\rBasic Setup\r\rggplot(your data, aes(x =x values, y =y values)) + geom_boxplot() the type of plot geometry desired\nSteps\nUsing gm_df, select the lifeExp column\rPipe (%\u0026gt;%) the result to ggplot()\rSelect the plot’s aes()thetic values\r\rlifeExp for the x values\r\ra histogram’s y are counts of its x values, so we don’t provide them here\r\r\rAdd geom_histogram() as the geometry of the plot\r\rgm_df %\u0026gt;% # data frame: Data\rselect(lifeExp) %\u0026gt;% # columns to keep: Data\rggplot(aes(x = lifeExp)) + # x values: Aesthetics\rgeom_histogram() # histogram: Geometries\r\rFigure 1: Figure 1\r\r\r\rfilter() Rows\rQuick Example\rInitial Data\rsample_df %\u0026gt;%\rselect(country, lifeExp) %\u0026gt;%\rprettify()\r\r\rcountry\r\rlifeExp\r\r\r\r\r\rAustralia\r\r81.235\r\r\r\rBrazil\r\r72.390\r\r\r\rHungary\r\r73.338\r\r\r\rIreland\r\r78.885\r\r\r\rNew Zealand\r\r80.204\r\r\r\rNicaragua\r\r72.899\r\r\r\rNigeria\r\r46.859\r\r\r\rSingapore\r\r79.972\r\r\r\rSri Lanka\r\r72.396\r\r\r\rTunisia\r\r73.923\r\r\r\r\r\rEnd Data\rsample_df %\u0026gt;%\rselect(country, lifeExp) %\u0026gt;%\rfilter(lifeExp \u0026gt; 75) %\u0026gt;%\rprettify(cols_changed = 2)\r\r\rcountry\r\rlifeExp\r\r\r\r\r\rAustralia\r\r81.235\r\r\r\rIreland\r\r78.885\r\r\r\rNew Zealand\r\r80.204\r\r\r\rSingapore\r\r79.972\r\r\r\r\rUse filter() to select rows using logic. Rows where a logical expression returns TRUE are kept and others are dropped.\n\rfilter() rows where numeric() values are greater or lesser than another value\r\rfilter() gm_df to only keep rows where gdpPercap \u0026lt; 500\r\r\rgm_df %\u0026gt;%\rfilter(gdpPercap \u0026lt; 500) %\u0026gt;%\rprettify(cols_changed = 6)\r\r\rcountry\r\rcontinent\r\ryear\r\rlifeExp\r\rpop\r\rgdpPercap\r\r\r\r\r\rBurundi\r\rAfrica\r\r1952\r\r39.031\r\r2445618\r\r339.2965\r\r\r\rBurundi\r\rAfrica\r\r1957\r\r40.533\r\r2667518\r\r379.5646\r\r\r\rBurundi\r\rAfrica\r\r1962\r\r42.045\r\r2961915\r\r355.2032\r\r\r\rBurundi\r\rAfrica\r\r1967\r\r43.548\r\r3330989\r\r412.9775\r\r\r\rBurundi\r\rAfrica\r\r1972\r\r44.057\r\r3529983\r\r464.0995\r\r\r\rBurundi\r\rAfrica\r\r1997\r\r45.326\r\r6121610\r\r463.1151\r\r\r\rBurundi\r\rAfrica\r\r2002\r\r47.360\r\r7021078\r\r446.4035\r\r\r\rBurundi\r\rAfrica\r\r2007\r\r49.580\r\r8390505\r\r430.0707\r\r\r\rCambodia\r\rAsia\r\r1952\r\r39.417\r\r4693836\r\r368.4693\r\r\r\rCambodia\r\rAsia\r\r1957\r\r41.366\r\r5322536\r\r434.0383\r\r\r\r\r\rfilter() rows using multiple logical expressions where all must be TRUE\r\rfilter() gm_df to only keep rows where year \u0026gt; 1990 and lifeExp \u0026lt; 40\r, and \u0026amp; are evaluated identically in filter()\r\r\rgm_df %\u0026gt;%\rfilter(year \u0026gt; 1990, lifeExp \u0026lt; 40) %\u0026gt;%\rprettify(cols_changed = 3:4)\r\r\rcountry\r\rcontinent\r\ryear\r\rlifeExp\r\rpop\r\rgdpPercap\r\r\r\r\r\rRwanda\r\rAfrica\r\r1992\r\r23.599\r\r7290203\r\r737.0686\r\r\r\rRwanda\r\rAfrica\r\r1997\r\r36.087\r\r7212583\r\r589.9445\r\r\r\rSierra Leone\r\rAfrica\r\r1992\r\r38.333\r\r4260884\r\r1068.6963\r\r\r\rSierra Leone\r\rAfrica\r\r1997\r\r39.897\r\r4578212\r\r574.6482\r\r\r\rSomalia\r\rAfrica\r\r1992\r\r39.658\r\r6099799\r\r926.9603\r\r\r\rSwaziland\r\rAfrica\r\r2007\r\r39.613\r\r1133066\r\r4513.4806\r\r\r\rZambia\r\rAfrica\r\r2002\r\r39.193\r\r10595811\r\r1071.6139\r\r\r\rZimbabwe\r\rAfrica\r\r2002\r\r39.989\r\r11926563\r\r672.0386\r\r\r\r\r\rfilter() rows using multiple logical expressions where one must be TRUE\r\rfilter() gm_df to only keep rows where pop \u0026lt; 10000 or gdpPercap \u0026gt; 100000\r| means or\r\r\rgm_df %\u0026gt;%\rfilter(pop \u0026lt; 10000 | gdpPercap \u0026gt; 100000) %\u0026gt;%\rprettify(cols_changed = 5:6)\r\r\rcountry\r\rcontinent\r\ryear\r\rlifeExp\r\rpop\r\rgdpPercap\r\r\r\r\r\rKuwait\r\rAsia\r\r1952\r\r55.565\r\r160000\r\r108382.4\r\r\r\rKuwait\r\rAsia\r\r1957\r\r58.033\r\r212846\r\r113523.1\r\r\r\rKuwait\r\rAsia\r\r1972\r\r67.712\r\r841934\r\r109347.9\r\r\r\r\r\rfilter() rows using a string\r\rfilter() gm_df to only keep rows where year is 1999 and continent is \u0026quot;Europe\u0026quot;\r== means is equal to\r\r\rgm_df %\u0026gt;%\rfilter(year == 1997 \u0026amp; continent == \u0026quot;Europe\u0026quot;) %\u0026gt;%\rprettify(cols_changed = 2:3)\r\r\rcountry\r\rcontinent\r\ryear\r\rlifeExp\r\rpop\r\rgdpPercap\r\r\r\r\r\rAlbania\r\rEurope\r\r1997\r\r72.950\r\r3428038\r\r3193.055\r\r\r\rAustria\r\rEurope\r\r1997\r\r77.510\r\r8069876\r\r29095.921\r\r\r\rBelgium\r\rEurope\r\r1997\r\r77.530\r\r10199787\r\r27561.197\r\r\r\rBosnia and Herzegovina\r\rEurope\r\r1997\r\r73.244\r\r3607000\r\r4766.356\r\r\r\rBulgaria\r\rEurope\r\r1997\r\r70.320\r\r8066057\r\r5970.389\r\r\r\rCroatia\r\rEurope\r\r1997\r\r73.680\r\r4444595\r\r9875.605\r\r\r\rCzech Republic\r\rEurope\r\r1997\r\r74.010\r\r10300707\r\r16048.514\r\r\r\rDenmark\r\rEurope\r\r1997\r\r76.110\r\r5283663\r\r29804.346\r\r\r\rFinland\r\rEurope\r\r1997\r\r77.130\r\r5134406\r\r23723.950\r\r\r\rFrance\r\rEurope\r\r1997\r\r78.640\r\r58623428\r\r25889.785\r\r\r\r\r\r\rggplot() Exercise 2\rSteps\nUsing gm_df, select the continent, country, and gdpPercap columns\rfilter() the rows to only keep those where continent == \u0026quot;Oceania\u0026quot;\rPipe (%\u0026gt;%) the result to ggplot()\rSelect the plot’s aes()thetic values\r\rcountry for the x values\rgdpPercap for the y values\r\rAdd geom_boxplot() as the geometry of the plot\r\rgm_df %\u0026gt;% # data frame: Data\rselect(continent, country, gdpPercap) %\u0026gt;% # columns to keep: Data\rfilter(continent == \u0026quot;Oceania\u0026quot;) %\u0026gt;% # rows to keep: Data\rggplot(aes(x = country, y = gdpPercap)) + # x and y values: Aesthetics\rgeom_boxplot() # box plot: Geometries\r\r\rmutate() Columns\rQuick Example\rInitial Data\rsample_df %\u0026gt;%\rselect(country, pop) %\u0026gt;%\rprettify()\r\r\rcountry\r\rpop\r\r\r\r\r\rAustralia\r\r20434176\r\r\r\rBrazil\r\r190010647\r\r\r\rHungary\r\r9956108\r\r\r\rIreland\r\r4109086\r\r\r\rNew Zealand\r\r4115771\r\r\r\rNicaragua\r\r5675356\r\r\r\rNigeria\r\r135031164\r\r\r\rSingapore\r\r4553009\r\r\r\rSri Lanka\r\r20378239\r\r\r\rTunisia\r\r10276158\r\r\r\r\r\rEnd Data\rsample_df %\u0026gt;%\rselect(country, pop) %\u0026gt;%\rmutate(pop_in_thousands = pop / 1000) %\u0026gt;%\rprettify(cols_changed = 3)\r\r\rcountry\r\rpop\r\rpop_in_thousands\r\r\r\r\r\rAustralia\r\r20434176\r\r20434.176\r\r\r\rBrazil\r\r190010647\r\r190010.647\r\r\r\rHungary\r\r9956108\r\r9956.108\r\r\r\rIreland\r\r4109086\r\r4109.086\r\r\r\rNew Zealand\r\r4115771\r\r4115.771\r\r\r\rNicaragua\r\r5675356\r\r5675.356\r\r\r\rNigeria\r\r135031164\r\r135031.164\r\r\r\rSingapore\r\r4553009\r\r4553.009\r\r\r\rSri Lanka\r\r20378239\r\r20378.239\r\r\r\rTunisia\r\r10276158\r\r10276.158\r\r\r\r\rUse mutate() to manipulate column values and create new columns.\nIn order to mutate() a column, use the name of the column you are manipulating and set its value using =.\nHere’s a silly example:\n\rAdd a new column to gm_df\r\rmutate() gm_df to create a column named planet and set its value to \u0026quot;Earth\u0026quot;\r\r\rgm_df %\u0026gt;%\rmutate(planet = \u0026quot;Earth\u0026quot;) %\u0026gt;%\rprettify(cols_changed = 7)\r\r\rcountry\r\rcontinent\r\ryear\r\rlifeExp\r\rpop\r\rgdpPercap\r\rplanet\r\r\r\r\r\rAfghanistan\r\rAsia\r\r1952\r\r28.801\r\r8425333\r\r779.4453\r\rEarth\r\r\r\rAfghanistan\r\rAsia\r\r1957\r\r30.332\r\r9240934\r\r820.8530\r\rEarth\r\r\r\rAfghanistan\r\rAsia\r\r1962\r\r31.997\r\r10267083\r\r853.1007\r\rEarth\r\r\r\rAfghanistan\r\rAsia\r\r1967\r\r34.020\r\r11537966\r\r836.1971\r\rEarth\r\r\r\rAfghanistan\r\rAsia\r\r1972\r\r36.088\r\r13079460\r\r739.9811\r\rEarth\r\r\r\rAfghanistan\r\rAsia\r\r1977\r\r38.438\r\r14880372\r\r786.1134\r\rEarth\r\r\r\rAfghanistan\r\rAsia\r\r1982\r\r39.854\r\r12881816\r\r978.0114\r\rEarth\r\r\r\rAfghanistan\r\rAsia\r\r1987\r\r40.822\r\r13867957\r\r852.3959\r\rEarth\r\r\r\rAfghanistan\r\rAsia\r\r1992\r\r41.674\r\r16317921\r\r649.3414\r\rEarth\r\r\r\rAfghanistan\r\rAsia\r\r1997\r\r41.763\r\r22227415\r\r635.3414\r\rEarth\r\r\r\r\rSince we have gdpPercap and pop, we can calculate the values for a total_GDP column.\n\rmutate() gm_df to set the results of a calculation on each row to a new column\r\rmultiply pop * gdpPercap and assign the result to total_GDP inside mutate()\r\r\rgm_df %\u0026gt;%\rmutate(total_GDP = pop * gdpPercap) %\u0026gt;%\rprettify(cols_changed = 7)\r\r\rcountry\r\rcontinent\r\ryear\r\rlifeExp\r\rpop\r\rgdpPercap\r\rtotal_GDP\r\r\r\r\r\rAfghanistan\r\rAsia\r\r1952\r\r28.801\r\r8425333\r\r779.4453\r\r6567086330\r\r\r\rAfghanistan\r\rAsia\r\r1957\r\r30.332\r\r9240934\r\r820.8530\r\r7585448670\r\r\r\rAfghanistan\r\rAsia\r\r1962\r\r31.997\r\r10267083\r\r853.1007\r\r8758855797\r\r\r\rAfghanistan\r\rAsia\r\r1967\r\r34.020\r\r11537966\r\r836.1971\r\r9648014150\r\r\r\rAfghanistan\r\rAsia\r\r1972\r\r36.088\r\r13079460\r\r739.9811\r\r9678553274\r\r\r\rAfghanistan\r\rAsia\r\r1977\r\r38.438\r\r14880372\r\r786.1134\r\r11697659231\r\r\r\rAfghanistan\r\rAsia\r\r1982\r\r39.854\r\r12881816\r\r978.0114\r\r12598563401\r\r\r\rAfghanistan\r\rAsia\r\r1987\r\r40.822\r\r13867957\r\r852.3959\r\r11820990309\r\r\r\rAfghanistan\r\rAsia\r\r1992\r\r41.674\r\r16317921\r\r649.3414\r\r10595901589\r\r\r\rAfghanistan\r\rAsia\r\r1997\r\r41.763\r\r22227415\r\r635.3414\r\r14121995875\r\r\r\r\rTypically, mutate() is used to perform operations across columns in each individual row. You can also use summary functions to perform operations on individual columns (acting as vectors) that result in a vector that can be assigned to a column.\nMakes sense, right??\nLet’s calculate the z-score of each gdpPercap value for a specific year.\n\\[ z = \\frac {x_i -\\mu_x} {\\sigma_x}\\]\n\r\\(x\\) = gdpPercap\r\\(\\mu_x\\) = the mean of \\(x\\) = mean(gdpPercap)\r\\(\\sigma_x\\) = the standard deviation of x = sd(gdpPercap)\n\rUse a summary function to perform a a calculation involving summary statistics of a column\r\rsubtract mean(gdpPercap) from gdpPercap\rdivide the result by sd(gdpPercap)\rset the results as the values of a new column called gdp_per_cap_z_score\r\r\rgm_df %\u0026gt;%\rfilter(year == 1977) %\u0026gt;%\rmutate(gdp_per_cap_z_score = (gdpPercap - mean(gdpPercap)) / sd(gdpPercap)) %\u0026gt;%\rprettify(cols_changed = 7)\r\r\rcountry\r\rcontinent\r\ryear\r\rlifeExp\r\rpop\r\rgdpPercap\r\rgdp_per_cap_z_score\r\r\r\r\r\rAfghanistan\r\rAsia\r\r1977\r\r38.438\r\r14880372\r\r786.1134\r\r-0.7805156\r\r\r\rAlbania\r\rEurope\r\r1977\r\r68.930\r\r2509048\r\r3533.0039\r\r-0.4520380\r\r\r\rAlgeria\r\rAfrica\r\r1977\r\r58.014\r\r17152804\r\r4910.4168\r\r-0.2873247\r\r\r\rAngola\r\rAfrica\r\r1977\r\r39.483\r\r6162675\r\r3008.6474\r\r-0.5147414\r\r\r\rArgentina\r\rAmericas\r\r1977\r\r68.481\r\r26983828\r\r10079.0267\r\r0.3307461\r\r\r\rAustralia\r\rOceania\r\r1977\r\r73.490\r\r14074100\r\r18334.1975\r\r1.3179128\r\r\r\rAustria\r\rEurope\r\r1977\r\r72.170\r\r7568430\r\r19749.4223\r\r1.4871476\r\r\r\rBahrain\r\rAsia\r\r1977\r\r65.593\r\r297410\r\r19340.1020\r\r1.4382004\r\r\r\rBangladesh\r\rAsia\r\r1977\r\r46.923\r\r80428306\r\r659.8772\r\r-0.7956111\r\r\r\rBelgium\r\rEurope\r\r1977\r\r72.800\r\r9821800\r\r19117.9745\r\r1.4116381\r\r\r\r\rHere are other functions that can be used similarly:\n\r\rSummary Functions\r\r\r\r\rfirst()\rmin()\r\rlast()\rmax()\r\rnth()\rmean()\r\rn()\rmedian()\r\rn_distinct()\rvar()\r\rIQR()\rsd()\r\r\r\r\r\rggplot() Exercise 3\rSteps\nUsing gm_df, select() country, year, and gdpPercap\rfilter() the rows to keep only those where country is \u0026quot;Korea, Rep.\u0026quot;, \u0026quot;Korea, Dem. Rep.\u0026quot;, \u0026quot;Japan\u0026quot;, or \u0026quot;China\u0026quot;\rPipe the result to ggplot()\rSelect the plot’s aes()thetic values\r\ryear for the x values\rgdpPercap for the y values\rcountry for the color values\r\r\r\rAdd geom_line() as the geometry of the plot\rAdd a title to the plot with labs()\r\rgm_df %\u0026gt;%\rfilter(country %in% c(\u0026quot;Korea, Rep.\u0026quot;, \u0026quot;Korea, Dem. Rep.\u0026quot;, \u0026quot;Japan\u0026quot;, \u0026quot;China\u0026quot;)) %\u0026gt;%\rmutate(total_GDP = pop * gdpPercap) %\u0026gt;%\rggplot(aes(x = year, y = gdpPercap, color = country)) +\rgeom_line() +\rlabs(title = \u0026quot;GDP Over Time\u0026quot;)\r\r\rarrange() Rows\rQuick Example\rInitial Data\rsample_df %\u0026gt;%\rselect(country, gdpPercap) %\u0026gt;%\rprettify()\r\r\rcountry\r\rgdpPercap\r\r\r\r\r\rAustralia\r\r34435.367\r\r\r\rBrazil\r\r9065.801\r\r\r\rHungary\r\r18008.944\r\r\r\rIreland\r\r40675.996\r\r\r\rNew Zealand\r\r25185.009\r\r\r\rNicaragua\r\r2749.321\r\r\r\rNigeria\r\r2013.977\r\r\r\rSingapore\r\r47143.180\r\r\r\rSri Lanka\r\r3970.095\r\r\r\rTunisia\r\r7092.923\r\r\r\r\r\rEnd Data\rsample_df %\u0026gt;%\rselect(country, gdpPercap)%\u0026gt;%\rarrange(gdpPercap) %\u0026gt;%\rprettify(cols_changed = 2)\r\r\rcountry\r\rgdpPercap\r\r\r\r\r\rNigeria\r\r2013.977\r\r\r\rNicaragua\r\r2749.321\r\r\r\rSri Lanka\r\r3970.095\r\r\r\rTunisia\r\r7092.923\r\r\r\rBrazil\r\r9065.801\r\r\r\rHungary\r\r18008.944\r\r\r\rNew Zealand\r\r25185.009\r\r\r\rAustralia\r\r34435.367\r\r\r\rIreland\r\r40675.996\r\r\r\rSingapore\r\r47143.180\r\r\r\r\rUse arrange() to sort rows.\n\rarrange() by ascending number (smallest to largest)\r\rarrange() gm_df’s pop column so that smallest populations are on top\r\r\rgm_df %\u0026gt;%\rarrange(pop) %\u0026gt;%\rprettify(cols_changed = 5)\r\r\rcountry\r\rcontinent\r\ryear\r\rlifeExp\r\rpop\r\rgdpPercap\r\r\r\r\r\rSao Tome and Principe\r\rAfrica\r\r1952\r\r46.471\r\r60011\r\r879.5836\r\r\r\rSao Tome and Principe\r\rAfrica\r\r1957\r\r48.945\r\r61325\r\r860.7369\r\r\r\rDjibouti\r\rAfrica\r\r1952\r\r34.812\r\r63149\r\r2669.5295\r\r\r\rSao Tome and Principe\r\rAfrica\r\r1962\r\r51.893\r\r65345\r\r1071.5511\r\r\r\rSao Tome and Principe\r\rAfrica\r\r1967\r\r54.425\r\r70787\r\r1384.8406\r\r\r\rDjibouti\r\rAfrica\r\r1957\r\r37.328\r\r71851\r\r2864.9691\r\r\r\rSao Tome and Principe\r\rAfrica\r\r1972\r\r56.480\r\r76595\r\r1532.9853\r\r\r\rSao Tome and Principe\r\rAfrica\r\r1977\r\r58.550\r\r86796\r\r1737.5617\r\r\r\rDjibouti\r\rAfrica\r\r1962\r\r39.693\r\r89898\r\r3020.9893\r\r\r\rSao Tome and Principe\r\rAfrica\r\r1982\r\r60.351\r\r98593\r\r1890.2181\r\r\r\r\r\rarrange() by desc() number (largest to smallest)\r\rarrange() the lifeExp column so that largest values are on top\r\r\rgm_df %\u0026gt;%\rarrange(desc(lifeExp)) %\u0026gt;%\rprettify(cols_changed = 4)\r\r\rcountry\r\rcontinent\r\ryear\r\rlifeExp\r\rpop\r\rgdpPercap\r\r\r\r\r\rJapan\r\rAsia\r\r2007\r\r82.603\r\r127467972\r\r31656.07\r\r\r\rHong Kong, China\r\rAsia\r\r2007\r\r82.208\r\r6980412\r\r39724.98\r\r\r\rJapan\r\rAsia\r\r2002\r\r82.000\r\r127065841\r\r28604.59\r\r\r\rIceland\r\rEurope\r\r2007\r\r81.757\r\r301931\r\r36180.79\r\r\r\rSwitzerland\r\rEurope\r\r2007\r\r81.701\r\r7554661\r\r37506.42\r\r\r\rHong Kong, China\r\rAsia\r\r2002\r\r81.495\r\r6762476\r\r30209.02\r\r\r\rAustralia\r\rOceania\r\r2007\r\r81.235\r\r20434176\r\r34435.37\r\r\r\rSpain\r\rEurope\r\r2007\r\r80.941\r\r40448191\r\r28821.06\r\r\r\rSweden\r\rEurope\r\r2007\r\r80.884\r\r9031088\r\r33859.75\r\r\r\rIsrael\r\rAsia\r\r2007\r\r80.745\r\r6426679\r\r25523.28\r\r\r\r\r\rarrange() alphabetically\r\rfilter() gm_df to keep only those rows where year == 2007 and continent == \u0026quot;Americas\u0026quot;\rarrange() the country column alphabetically\r\r\rgm_df %\u0026gt;%\rfilter(year == 2007, continent == \u0026quot;Americas\u0026quot;) %\u0026gt;%\rarrange(country) %\u0026gt;%\rprettify(cols_changed = 2:3)\r\r\rcountry\r\rcontinent\r\ryear\r\rlifeExp\r\rpop\r\rgdpPercap\r\r\r\r\r\rArgentina\r\rAmericas\r\r2007\r\r75.320\r\r40301927\r\r12779.380\r\r\r\rBolivia\r\rAmericas\r\r2007\r\r65.554\r\r9119152\r\r3822.137\r\r\r\rBrazil\r\rAmericas\r\r2007\r\r72.390\r\r190010647\r\r9065.801\r\r\r\rCanada\r\rAmericas\r\r2007\r\r80.653\r\r33390141\r\r36319.235\r\r\r\rChile\r\rAmericas\r\r2007\r\r78.553\r\r16284741\r\r13171.639\r\r\r\rColombia\r\rAmericas\r\r2007\r\r72.889\r\r44227550\r\r7006.580\r\r\r\rCosta Rica\r\rAmericas\r\r2007\r\r78.782\r\r4133884\r\r9645.061\r\r\r\rCuba\r\rAmericas\r\r2007\r\r78.273\r\r11416987\r\r8948.103\r\r\r\rDominican Republic\r\rAmericas\r\r2007\r\r72.235\r\r9319622\r\r6025.375\r\r\r\rEcuador\r\rAmericas\r\r2007\r\r74.994\r\r13755680\r\r6873.262\r\r\r\r\r\r\r\rgroup_by() for Grouped Data\rQuick Example\rInitial Data\rsample_df %\u0026gt;%\rselect(country, continent, pop) %\u0026gt;%\rprettify()\r\r\rcountry\r\rcontinent\r\rpop\r\r\r\r\r\rAustralia\r\rOceania\r\r20434176\r\r\r\rBrazil\r\rAmericas\r\r190010647\r\r\r\rHungary\r\rEurope\r\r9956108\r\r\r\rIreland\r\rEurope\r\r4109086\r\r\r\rNew Zealand\r\rOceania\r\r4115771\r\r\r\rNicaragua\r\rAmericas\r\r5675356\r\r\r\rNigeria\r\rAfrica\r\r135031164\r\r\r\rSingapore\r\rAsia\r\r4553009\r\r\r\rSri Lanka\r\rAsia\r\r20378239\r\r\r\rTunisia\r\rAfrica\r\r10276158\r\r\r\r\r\rEnd Data\rsample_df %\u0026gt;%\rselect(country, continent, pop) %\u0026gt;%\rgroup_by(continent) %\u0026gt;%\rmutate(pop_by_continent = sum(pop)) %\u0026gt;%\rungroup() %\u0026gt;%\rarrange(pop_by_continent) %\u0026gt;%\rprettify(cols_changed = 4)\r\r\rcountry\r\rcontinent\r\rpop\r\rpop_by_continent\r\r\r\r\r\rHungary\r\rEurope\r\r9956108\r\r14065194\r\r\r\rIreland\r\rEurope\r\r4109086\r\r14065194\r\r\r\rAustralia\r\rOceania\r\r20434176\r\r24549947\r\r\r\rNew Zealand\r\rOceania\r\r4115771\r\r24549947\r\r\r\rSingapore\r\rAsia\r\r4553009\r\r24931248\r\r\r\rSri Lanka\r\rAsia\r\r20378239\r\r24931248\r\r\r\rNigeria\r\rAfrica\r\r135031164\r\r145307322\r\r\r\rTunisia\r\rAfrica\r\r10276158\r\r145307322\r\r\r\rBrazil\r\rAmericas\r\r190010647\r\r195686003\r\r\r\rNicaragua\r\rAmericas\r\r5675356\r\r195686003\r\r\r\r\rgroup_by() allows us to group rows together based on column values.\nLet’s say we wanted to compute summary values for each country for all years.\n\rCalculate the mean_gdp_per_cap of each country with group_by()\r\rtake gm_df and group_by() country to group rows of the same country together\ruse mean() to calculate the mean_gdp_per_cap\rungroup() the rows\r\ra habit you want\r\rkeep only those rows with distinct() combinations of country and mean_gdp_per_cap\r\rdistinct()’s default is to only keep columns used as arguments\r\r\r\rgm_df %\u0026gt;%\rgroup_by(country) %\u0026gt;%\rmutate(mean_gdp_per_cap = median(gdpPercap)) %\u0026gt;% ungroup() %\u0026gt;%\rdistinct(country, mean_gdp_per_cap) %\u0026gt;% prettify(cols_changed = 2)\r\r\rcountry\r\rmean_gdp_per_cap\r\r\r\r\r\rAfghanistan\r\r803.4832\r\r\r\rAlbania\r\r3253.2384\r\r\r\rAlgeria\r\r4853.8559\r\r\r\rAngola\r\r3264.6288\r\r\r\rArgentina\r\r9068.7844\r\r\r\rAustralia\r\r18905.6034\r\r\r\rAustria\r\r20673.2530\r\r\r\rBahrain\r\r18779.8016\r\r\r\rBangladesh\r\r703.7638\r\r\r\rBelgium\r\r20048.9102\r\r\r\r\r\r\rggplot() Exercise 4\rSteps\nUsing gm_df, group_by() the continent and year\rmutate() to add a column called mean_gdp for the average GDP of each continent\rungroup() the data, because this is a habit that will save you headaches later\rKeep only distinct() combinations of continent, year, and mean_gdp\rPipe the result to ggplot()\rSelect the plot’s aes()thetic values\r\ryear for the x values\rmean_gdp for the y values\rcontinent for the color values\r\rAdd geom_line() as the geometry of the plot\rAdd a title and a caption (for the source of the data) to the plot with labs()\r\rgm_df %\u0026gt;%\rgroup_by(year, continent) %\u0026gt;%\rmutate(mean_gdp = mean(gdpPercap)) %\u0026gt;%\rungroup() %\u0026gt;%\rdistinct(continent, year, mean_gdp) %\u0026gt;%\rggplot(aes(x = year, y = mean_gdp, color = continent)) +\rgeom_line() +\rlabs(title = \u0026quot;Mean GDPs by Continent Over Time\u0026quot;,\rcaption = \u0026quot;Source: Free material from www.gapminder.org\u0026quot;)\r\r\rsummarize()\rQuick Example\rInitial Data\rsample_df %\u0026gt;%\rselect(country, continent, lifeExp, pop) %\u0026gt;%\rprettify()\r\r\rcountry\r\rcontinent\r\rlifeExp\r\rpop\r\r\r\r\r\rAustralia\r\rOceania\r\r81.235\r\r20434176\r\r\r\rBrazil\r\rAmericas\r\r72.390\r\r190010647\r\r\r\rHungary\r\rEurope\r\r73.338\r\r9956108\r\r\r\rIreland\r\rEurope\r\r78.885\r\r4109086\r\r\r\rNew Zealand\r\rOceania\r\r80.204\r\r4115771\r\r\r\rNicaragua\r\rAmericas\r\r72.899\r\r5675356\r\r\r\rNigeria\r\rAfrica\r\r46.859\r\r135031164\r\r\r\rSingapore\r\rAsia\r\r79.972\r\r4553009\r\r\r\rSri Lanka\r\rAsia\r\r72.396\r\r20378239\r\r\r\rTunisia\r\rAfrica\r\r73.923\r\r10276158\r\r\r\r\rsample_df %\u0026gt;%\rselect(country, continent, lifeExp, pop) %\u0026gt;%\rgroup_by(continent) %\u0026gt;%\rsummarise(max_pop = max(pop),\rmean_life_exp = mean(lifeExp)) %\u0026gt;%\rprettify(cols_changed = 2:3)\r\r\rcontinent\r\rmax_pop\r\rmean_life_exp\r\r\r\r\r\rAfrica\r\r135031164\r\r60.3910\r\r\r\rAmericas\r\r190010647\r\r72.6445\r\r\r\rAsia\r\r20378239\r\r76.1840\r\r\r\rEurope\r\r9956108\r\r76.1115\r\r\r\rOceania\r\r20434176\r\r80.7195\r\r\r\r\rNow that we know how to use group_by(), we can summarize() data by group. This can be done using all of the summary functions seen earlier.\n\r\rSummary Functions\r\r\r\r\rfirst()\rmin()\r\rlast()\rmax()\r\rnth()\rmean()\r\rn()\rmedian()\r\rn_distinct()\rvar()\r\rIQR()\rsd()\r\r\r\r\rCalculate some summary statistics for each continent.\r\rtake gm_df and group_by() continent\rusing summarize() or summarise(), calculate:\r\rcount with n()\rmean_pop with mean()\rmax_gdp_per_cap with max()\r\r\r\rgm_df %\u0026gt;%\rgroup_by(continent) %\u0026gt;%\rsummarise(count = n(),\rmean_pop = mean(pop),\rmax_gdp_per_cap = max(gdpPercap)) %\u0026gt;%\rprettify(cols_changed = 2:4)\r\r\rcontinent\r\rcount\r\rmean_pop\r\rmax_gdp_per_cap\r\r\r\r\r\rAfrica\r\r624\r\r9916003\r\r21951.21\r\r\r\rAmericas\r\r300\r\r24504795\r\r42951.65\r\r\r\rAsia\r\r396\r\r77038722\r\r113523.13\r\r\r\rEurope\r\r360\r\r17169765\r\r49357.19\r\r\r\rOceania\r\r24\r\r8874672\r\r34435.37\r\r\r\r\r\r\rggplot() Exercise 5\rSteps\nUsing gm_df, filter() the data to remove rows where continent is not \u0026quot;Oceania\u0026quot;\rgroup_by() continent and year\rsummarize() the groups by calculating them mean() of pop\rungroup() the data, because this is a habit that will save you headaches later\rPipe the results to ggplot()\rSelect the plot’s aes()thetics\r\ryear for the x values\rmean_pop for the y values\rcontinent for the color values\r\rAdd geom_line() for the first geometry\rAdd geom_point() for the second geometry\rChange the theme by adding theme_minimal()\rUsing facet_wrap(), split the plot into panels for each continent\r\r~ is used as a formula to select the facet variable\r\rAdd a title and a caption with labs()\r\rgm_df %\u0026gt;%\rfilter(continent != \u0026quot;Oceania\u0026quot;) %\u0026gt;%\rgroup_by(continent, year) %\u0026gt;%\rsummarise(mean_pop = mean(pop)) %\u0026gt;%\rungroup() %\u0026gt;%\rggplot(aes(x = year, y = mean_pop,\rcolor = continent)) +\rgeom_line() +\rgeom_point() +\rtheme_minimal() +\rfacet_wrap(~ continent) +\rlabs(title = \u0026quot;Mean Continent Populations over Time\u0026quot;,\rcaption = \u0026quot;Source: Free material from www.gapminder.org\u0026quot;)\r## Warning: Removed 1 rows containing missing values (geom_path).\r## Warning: Removed 1 rows containing missing values (geom_point).\rالنهاية\nsessionInfo()\r## R version 3.5.1 (2018-07-02)\r## Platform: x86_64-w64-mingw32/x64 (64-bit)\r## Running under: Windows 10 x64 (build 17134)\r## ## Matrix products: default\r## ## locale:\r## [1] LC_COLLATE=English_United States.1252 ## [2] LC_CTYPE=English_United States.1252 ## [3] LC_MONETARY=English_United States.1252\r## [4] LC_NUMERIC=C ## [5] LC_TIME=English_United States.1252 ## ## attached base packages:\r## [1] stats graphics grDevices utils datasets methods base ## ## other attached packages:\r## [1] kableExtra_0.9.0 knitr_1.20.21 gapminder_0.3.0 ## [4] forcats_0.3.0 stringr_1.3.1.9000 dplyr_0.7.99.9000 ## [7] purrr_0.2.4.9000 readr_1.1.1 tidyr_0.8.1.9000 ## [10] tibble_1.4.2 ggplot2_3.1.0.9000 tidyverse_1.2.1.9000\r## ## loaded via a namespace (and not attached):\r## [1] tidyselect_0.2.5 xfun_0.4 haven_1.1.2.9000 ## [4] colorspace_1.3-2 generics_0.0.1.9000 htmltools_0.3.6 ## [7] viridisLite_0.3.0 yaml_2.2.0 utf8_1.1.4 ## [10] rlang_0.3.0.9000 pillar_1.3.0.9000 glue_1.3.0 ## [13] withr_2.1.2.9000 modelr_0.1.2 readxl_1.1.0 ## [16] plyr_1.8.4 munsell_0.5.0 blogdown_0.9.1 ## [19] gtable_0.2.0 cellranger_1.1.0 rvest_0.3.2 ## [22] codetools_0.2-15 evaluate_0.12 labeling_0.3 ## [25] fansi_0.3.0 highr_0.7 broom_0.5.0.9001 ## [28] Rcpp_1.0.0 scales_1.0.0.9000 backports_1.1.2 ## [31] jsonlite_1.5 hms_0.4.2 digest_0.6.18 ## [34] stringi_1.2.4 bookdown_0.7.21 grid_3.5.1 ## [37] cli_1.0.1 tools_3.5.1 magrittr_1.5 ## [40] lazyeval_0.2.1 crayon_1.3.4 pkgconfig_2.0.2 ## [43] xml2_1.2.0 lubridate_1.7.4 assertthat_0.2.0 ## [46] rmarkdown_1.10.14 httr_1.3.1 rstudioapi_0.8.0.9000\r## [49] htmldeps_0.1.1 R6_2.3.0 compiler_3.5.1\r\r\r",
    "date": 1521244800,
    "expirydate": -62135596800,
    "kind": "page",
    "lang": "en",
    "lastmod": 1543265254,
    "objectID": "356d974fbbdb1e58c66f2f280f965789",
    "permalink": "/post/yet-another-tidyverse-intro/",
    "publishdate": "2018-03-17T00:00:00Z",
    "relpermalink": "/post/yet-another-tidyverse-intro/",
    "section": "post",
    "summary": "A (hopefully) gentle introduction to R's tidyverse that I used as a primer for a short workshop series I taught.",
    "tags": [
      "R",
      "data-carpentry",
      "tutorial",
      "tidyverse",
      "ggplot",
      "dplyr"
    ],
    "title": "Thoughts on Teaching R and Yet Another Tidyverse Intro",
    "type": "post"
  },
  {
    "authors": [
      "Brendan Knapp"
    ],
    "categories": null,
    "content": "",
    "date": 1519372800,
    "expirydate": -62135596800,
    "kind": "page",
    "lang": "en",
    "lastmod": 1541209018,
    "objectID": "e13fb265d04922b7d1d0d89ec5551aac",
    "permalink": "/talk/r-for-data-carpentry/",
    "publishdate": "2018-02-23T00:00:00-08:00",
    "relpermalink": "/talk/r-for-data-carpentry/",
    "section": "talk",
    "summary": "A three-part workshop series teaching graduate students at the [Middlebury Institute](https://www.middlebury.edu/institute/) the fundamentals of programmatic data carpentry, visualization, and reproducible research.",
    "tags": [
      "R"
    ],
    "title": "R for Data Carpentry and Analysis",
    "type": "talk"
  },
  {
    "authors": [
      "Brendan Knapp"
    ],
    "categories": null,
    "content": "",
    "date": 1506063600,
    "expirydate": -62135596800,
    "kind": "page",
    "lang": "en",
    "lastmod": 1541196093,
    "objectID": "13561d01a9e5342e90cc9b00c3118fc2",
    "permalink": "/talk/intro-to-r/",
    "publishdate": "2017-09-22T00:00:00-07:00",
    "relpermalink": "/talk/intro-to-r/",
    "section": "talk",
    "summary": "Have you always been curious about programming, but haven’t had the opportunity for a simple introduction?\nDo you wish you knew how to access the data available on Twitter or other data-rich websites in your research?\nDo you want to expand your toolkit of hard skills while complementing your knowledge in international policy?\nHave you concluded that technical skills are major career assets and are incredibly attractive to employers?\nIf you answered “Yes” to any of these, please join the META Lab for our R and RStudio Geek Out and learn what’s possible with some some data programming knowledge!\nWe’re going to get our feet wet with a simple Introduction to R Programming which assumes ZERO knowledge.",
    "tags": [
      "R"
    ],
    "title": "Programming in R with RStudio",
    "type": "talk"
  },
  {
    "authors": [
      "Brendan Knapp"
    ],
    "categories": null,
    "content": "Click on the Slides or Code buttons above to view content.\n\r",
    "date": 1490943600,
    "expirydate": -62135596800,
    "kind": "page",
    "lang": "en",
    "lastmod": 1541196093,
    "objectID": "69525aa2ee38933c74b7ba3577f043f9",
    "permalink": "/talk/intro-to-python/",
    "publishdate": "2017-03-31T00:00:00-07:00",
    "relpermalink": "/talk/intro-to-python/",
    "section": "talk",
    "summary": "A workshop for graduate students at the [Middlebury Institute](https://www.middlebury.edu/institute/) to introduce them to programming with Python.",
    "tags": [
      "R"
    ],
    "title": "Introduction to Python",
    "type": "talk"
  },
  {
    "authors": [
      "Melissa Hanham",
      "Jeffrey Lewis",
      "Catherine Dill",
      "Grace Liu",
      "Joseph Rodgers",
      "Octave Lepinard",
      "Brendan Knapp",
      "Olivia Hallam",
      "Ben McIntosh"
    ],
    "categories": null,
    "content": "",
    "date": 1372662000,
    "expirydate": -62135596800,
    "kind": "page",
    "lang": "en",
    "lastmod": 1540947664,
    "objectID": "f706c5e7a03814a938c5b41990814e82",
    "permalink": "/publication/geo4nonpro/",
    "publishdate": "2013-07-01T00:00:00-07:00",
    "relpermalink": "/publication/geo4nonpro/",
    "section": "publication",
    "summary": "On June 16, 2018, the James Martin Center for Nonproliferation Studies (CNS) launched Geo4Nonpro 2.0. With a mission to engage a “curated” crowd of satellite imagery analysis experts, Geo4Nonpro (G4N) is a tool for sharing open-source geographic information of known or suspected weapons of mass destruction (WMD) sites.",
    "tags": [
      "Geospatial",
      "Remote Sensing"
    ],
    "title": "Geo4Nonpro 2.0",
    "type": "publication"
  },
  {
    "authors": null,
    "categories": null,
    "content": " Welcome to Slides Academic\nFeatures  Efficiently write slides in Markdown 3-in-1: Create, Present, and Publish your slides Supports speaker notes Mobile friendly slides  Controls  Next: Right Arrow or Space Previous: Left Arrow Start: Home Finish: End Overview: Esc Speaker notes: S Fullscreen: F Zoom: Alt + Click PDF Export: E  Code Highlighting Inline code: variable\nCode block:\nporridge = \u0026quot;blueberry\u0026quot; if porridge == \u0026quot;blueberry\u0026quot;: print(\u0026quot;Eating...\u0026quot;)  Math In-line math: $x + y = z$\nBlock math:\n$$ f\\left( x \\right) = \\;\\frac{{2\\left( {x + 4} \\right)\\left( {x - 4} \\right)}}{{\\left( {x + 4} \\right)\\left( {x + 1} \\right)}} $$\nFragments Make content appear incrementally\n{{% fragment %}} One {{% /fragment %}} {{% fragment %}} **Two** {{% /fragment %}} {{% fragment %}} Three {{% /fragment %}}  Press Space to play!\nOne\r Two\r Three\r\nA fragment can accept two optional parameters:\n class: use a custom style (requires definition in custom CSS) weight: sets the order in which a fragment appears  Speaker Notes Add speaker notes to your presentation\n{{% speaker_note %}} - Only the speaker can read these notes - Press `S` key to view {{% /speaker_note %}}  Press the S key to view the speaker notes!\n Only the speaker can read these notes Press S key to view   Themes  black: Black background, white text, blue links (default) white: White background, black text, blue links league: Gray background, white text, blue links beige: Beige background, dark text, brown links sky: Blue background, thin dark text, blue links   night: Black background, thick white text, orange links serif: Cappuccino background, gray text, brown links simple: White background, black text, blue links solarized: Cream-colored background, dark green text, blue links  Custom Slide Customize the slide style and background\n{{\u0026lt; slide background-image=\u0026quot;/img/boards.jpg\u0026quot; \u0026gt;}} {{\u0026lt; slide background-color=\u0026quot;#0000FF\u0026quot; \u0026gt;}} {{\u0026lt; slide class=\u0026quot;my-style\u0026quot; \u0026gt;}}  Custom CSS Example Let\u0026rsquo;s make headers navy colored.\nCreate assets/css/reveal_custom.css with:\n.reveal section h1, .reveal section h2, .reveal section h3 { color: navy; }  Questions? Ask\nDocumentation\n",
    "date": -62135596800,
    "expirydate": -62135596800,
    "kind": "page",
    "lang": "en",
    "lastmod": 1540947664,
    "objectID": "c2915ec5da95791851caafdcba9664af",
    "permalink": "/slides/example-slides/",
    "publishdate": "0001-01-01T00:00:00Z",
    "relpermalink": "/slides/example-slides/",
    "section": "slides",
    "summary": "Welcome to Slides Academic\nFeatures  Efficiently write slides in Markdown 3-in-1: Create, Present, and Publish your slides Supports speaker notes Mobile friendly slides  Controls  Next: Right Arrow or Space Previous: Left Arrow Start: Home Finish: End Overview: Esc Speaker notes: S Fullscreen: F Zoom: Alt + Click PDF Export: E  Code Highlighting Inline code: variable\nCode block:\nporridge = \u0026quot;blueberry\u0026quot; if porridge == \u0026quot;blueberry\u0026quot;: print(\u0026quot;Eating...\u0026quot;)  Math In-line math: $x + y = z$",
    "tags": null,
    "title": "Slides",
    "type": "slides"
  },
  {
    "authors": null,
    "categories": null,
    "content": "",
    "date": -62135596800,
    "expirydate": -62135596800,
    "kind": "page",
    "lang": "en",
    "lastmod": 1540947664,
    "objectID": "d82877ac5e447c72fb4d8d30579d2f8b",
    "permalink": "/project/snatools/",
    "publishdate": "0001-01-01T00:00:00Z",
    "relpermalink": "/project/snatools/",
    "section": "project",
    "summary": "An R toolkit to bridge graph classes and streamline network analytic workflows.",
    "tags": [
      "Network Analysis"
    ],
    "title": "snatools",
    "type": "project"
  }
]